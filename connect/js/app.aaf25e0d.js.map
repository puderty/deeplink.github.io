{"version":3,"file":"js/app.aaf25e0d.js","mappings":"qDAAaA,EAAA,MAAAA,EAAA,MAAAA,EAAA,MACb,IAAIC,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACIW,EAAsBhB,MAAQA,KAAKgB,qBAAwBf,OAAOC,OAAU,SAASC,EAAGc,GACxFhB,OAAOc,eAAeZ,EAAG,UAAW,CAAEU,YAAY,EAAMK,MAAOD,GACnE,EAAK,SAASd,EAAGc,GACbd,EAAE,WAAac,CACnB,GACIE,EAAgBnB,MAAQA,KAAKmB,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,CAAC,EACd,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBJ,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKf,IAAIN,EAAgBsB,EAAQD,EAAKf,GAEtI,OADAW,EAAmBK,EAAQD,GACpBC,CACX,EACII,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQC,wBAAqB,EAC7B,MAAMC,EAAc9C,EAAQ,MACtB+C,EAAa/C,EAAQ,MACrBgD,EAAUhD,EAAQ,MAClBiD,EAAWjD,EAAQ,MACnBkD,EAAM7B,EAAarB,EAAQ,OAC3BmD,GAAK,EAAIH,EAAQI,kCACvB,MAAMP,EACFQ,WAAAA,CAAYC,GAGR,GAFApD,KAAKqD,OAAS,IAAIN,EAASO,aAC3BtD,KAAKuD,MAAQX,EAAYY,eAAeC,YACnC,EAAIX,EAAQY,YAAYN,GACzB,MAAM,IAAIO,MAAM,0BAA0BP,KAE9CpD,KAAKoD,IAAMA,CACf,CACA,aAAIQ,GACA,MAA8B,qBAAhB5D,KAAK6D,MACvB,CACA,cAAIC,GACA,OAAO9D,KAAKuD,OAASX,EAAYY,eAAeO,UACpD,CAGAC,SAAAA,CAAU3B,GACN,GAAsB,qBAAXA,EAAE4B,KAAb,CAIA,GAFAjB,EAAIkB,SAAS,qBACblB,EAAIkB,SAAS7B,GACS,kBAAXA,EAAE4B,KAAmB,CAC5B,IAAIE,EAAM9B,EAAE4B,KACZ,GAAY,SAARE,EAEA,YADAnB,EAAIkB,SAAS,yBAAyBE,KAAKC,MAAMC,aAGzD,CACAtE,KAAKqD,OAAOkB,KAAK,UAAWlC,EAAE4B,KAVpB,CAWd,CACAO,OAAAA,CAAQC,GACJzE,KAAK6D,YAAStD,EACdP,KAAKqD,OAAOkB,KAAK,QAASE,EAC9B,CACAC,OAAAA,CAAQC,EAAItC,GACR,MAAMuC,EAAU,CAAED,GAAIA,EAAIE,IAAKxC,EAAEiC,YACjCtE,KAAKqD,OAAOkB,KAAK,UAAWK,EAChC,CACAE,MAAAA,CAAOjB,GACHA,EAAOkB,UAAaN,GAAUzE,KAAKgE,UAAUS,GAC7CZ,EAAOmB,QAAWP,GAAUzE,KAAKwE,QAAQC,GACzCzE,KAAK6D,OAASA,EACd7D,KAAKuD,MAAQX,EAAYY,eAAeyB,UACxCjF,KAAKqD,OAAOkB,KAAK,OACrB,CAEAW,SAAAA,CAAUC,GACNnF,KAAKqD,OAAOkB,KAAK,OAAQY,EAC7B,CAEAC,SAAAA,GACSpF,KAAK6D,OAIN7D,KAAK6D,OAAOwB,aAAeC,UAAUC,MAIzCvC,EAAIkB,SAAS,yBAAyBE,KAAKC,MAAMC,cACjDtE,KAAK6D,OAAO2B,KAAK,QACjBC,WAAWzF,KAAKoF,UAAUM,KAAK1F,MAAO,OALlCgD,EAAIkB,SAAS,oBAJblB,EAAIkB,SAAS,mBAUrB,CACAyB,UAAAA,CAAWvC,EAAMpD,KAAKoD,KAClB,KAAK,EAAIN,EAAQY,YAAYN,GACzB,MAAM,IAAIO,MAAM,0BAA0BP,KAE9C,GAAIpD,KAAK8D,WAAY,CAEjB,MAAM8B,EAAmB5F,KAAKqD,OAAOwC,kBAKrC,OAJI7F,KAAKqD,OAAOyC,cAAc,SAAWF,GACrC5F,KAAKqD,OAAOyC,cAAc,SAAWF,IACrC5F,KAAKqD,OAAO0C,gBAAgBH,EAAmB,GAE5C,IAAI5D,SAAQ,CAACD,EAASE,KACzBjC,KAAKqD,OAAO2C,KAAK,QAASC,IAClBjG,KAAKqD,OAAOwC,kBAAoBjD,EAAYsD,6BAC5ClG,KAAKqD,OAAO0C,gBAAgBnD,EAAYsD,6BAE5CjE,EAAOgE,EAAM,IAEjBjG,KAAKqD,OAAO2C,KAAK,QAAQ,KAIrB,GAHIhG,KAAKqD,OAAOwC,kBAAoBjD,EAAYsD,6BAC5ClG,KAAKqD,OAAO0C,gBAAgBnD,EAAYsD,6BAElB,oBAAflG,KAAK6D,OACZ,OAAO5B,EAAO,IAAI0B,MAAM,iBAE5B5B,EAAQ/B,KAAK6D,OAAO,GACtB,GAEV,CACA7D,KAAKoD,IAAMA,EACXpD,KAAKuD,MAAQX,EAAYY,eAAeO,WACzB,IAAIoC,gBAAgB/C,GAAKtC,IAAI,UAA5C,MAEMsF,EAAO,CAAEC,oBAAoB,GACnC,OAAO,IAAIrE,SAAQ,CAACD,EAASE,KACzB,MAAM4B,EAAS,IAAIZ,EAAGG,EAAK,GAAIgD,IAC3B,EAAItD,EAAQwD,uBACZzC,EAAO0C,QAAW9B,IACd,MAAMU,EAAaV,EACnBxC,EAAOjC,KAAKkF,UAAUC,EAAWc,OAAO,EAI5CpC,EAAO2C,GAAG,SAAUrB,IAChBlD,EAAOjC,KAAKkF,UAAUC,GAAY,IAG1CtB,EAAOiB,OAAS,KACZ9B,EAAIkB,SAAS,iBACblE,KAAK8E,OAAOjB,GACZ7D,KAAKoF,YACLrD,EAAQ8B,EAAO,CAClB,GAET,CAEA4C,gBAAAA,GACqC,YAA7BC,SAASC,kBAET3D,EAAIkB,SAAS,eAAelE,KAAKuD,UAAUvD,KAAK6D,UAC5C7D,KAAKuD,OAASX,EAAYY,eAAeyB,WAAoC,qBAAhBjF,KAAK6D,SAClEb,EAAIkB,SAAS,0BACblE,KAAK2F,cAGjB,CACAiB,OAAAA,GACI,OAAOnF,EAAUzB,UAAM,OAAQ,GAAQ,kBAC7BA,KAAK2F,WAAW3F,KAAKoD,KAE3BsD,SAASG,oBAAoB,mBAAoB7G,KAAKyG,iBAAiBf,KAAK1F,OAC5E0G,SAASI,iBAAiB,mBAAoB9G,KAAKyG,iBAAiBf,KAAK1F,MAC7E,GACJ,CACA+G,UAAAA,GACI,OAAOtF,EAAUzB,UAAM,OAAQ,GAAQ,YAEnC,OADAA,KAAKuD,MAAQX,EAAYY,eAAewD,aACjC,IAAIhF,SAAQ,CAACD,EAASE,KACE,qBAAhBjC,KAAK6D,QAKhB7D,KAAK6D,OAAOmB,QAAWP,IACnBzE,KAAKwE,QAAQC,GACb1C,GAAS,EAEb/B,KAAK6D,OAAOoD,SAPRlF,GAOe,GAE3B,GACJ,CACAmF,aAAAA,GACI,MAAO,CACH3D,MAAOvD,KAAKuD,MACZH,IAAKpD,KAAKoD,IAElB,CAKA+D,WAAAA,CAAY1C,EAAO2C,EAASC,EAASC,GACjCtH,KAAKqD,OAAOmD,GAAG,WAAYnE,IACvB,IAAIkF,EACJvE,EAAIkB,SAAS,mBAAmB7B,KAChCW,EAAIkB,SAAS7B,GACb,IAAImF,GAAc,EAAI3E,EAAW4E,eAAepF,GAEhD,GAAImF,EAAYE,QAAUF,EAAYE,OAAOzD,KAAM,CAC/C,IAAI0D,EAA4C,QAAlCJ,EAAKC,EAAYE,OAAOzD,YAAyB,IAAPsD,OAAgB,EAASA,EAAGK,QACpF,GAAID,EACA,IACI,IAAI9C,EAAMuC,EAAQO,GAClBN,EAAQ5C,EAAOI,EACnB,CACA,MAAOxC,GACHW,EAAIkB,SAAS,4BAA4B7B,KACzCiF,EAAO7C,EAAOpC,EAAEuF,QACpB,CAER,KAEJ5H,KAAKqD,OAAOmD,GAAG,QAASnE,IAChBA,GACAW,EAAIkB,SAAS,mBAAmB7B,KAChCiF,EAAO7C,EAAOpC,EAAEuF,UAGhBN,EAAO7C,EAAO,gBAClB,GAER,CACAoD,eAAAA,CAAgBC,GACZ9H,KAAKqD,OAAOmD,GAAG,WAAYnE,GAAMZ,EAAUzB,UAAM,OAAQ,GAAQ,YAE7DgD,EAAIkB,SAAS,mBAAmB7B,KAChC,IAAI0F,GAAQ,EAAIlF,EAAW4E,eAAepF,SACpCyF,EAASC,EACnB,KACJ,CACA/B,IAAAA,CAAKvB,EAAOuD,GACRhI,KAAKqD,OAAO2C,KAAKvB,EAAOuD,EAC5B,CACAC,GAAAA,CAAIxD,EAAOuD,GACPhI,KAAKqD,OAAO4E,IAAIxD,EAAOuD,EAC3B,CACAE,cAAAA,CAAezD,EAAOuD,GAClBhI,KAAKqD,OAAO6E,eAAezD,EAAOuD,EACtC,CACAxC,IAAAA,CAAK2C,EAASvD,GACV,OAAOnD,EAAUzB,UAAM,OAAQ,GAAQ,YACR,qBAAhBA,KAAK6D,SACZb,EAAIkB,SAAS,8BAA8BU,WAErCuD,KAEV,IACInF,EAAIkB,SAAS,qBAAoB,EAAIrB,EAAWuF,mBAAmBxD,MAC/D5E,KAAK6D,QACL7D,KAAK6D,OAAO2B,MAAK,EAAI3C,EAAWuF,mBAAmBxD,GAE3D,CACA,MAAOvC,GACHrC,KAAK0E,QAAQE,EAAQD,GAAItC,EAC7B,CACJ,GACJ,CACAgG,wBAAAA,CAAyBxD,GACrB,OAAOpD,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,GAAmB,qBAAR6E,EACP,OACJ,IAAIyD,EAAS,CACTZ,OAAQ,CACJzD,KAAMY,IAGV0D,GAAU,EAAI1F,EAAWuF,mBAAmBvD,GAChD7B,EAAIkB,SAAS,kCACblB,EAAIkB,SAASqE,GACbA,GAAU,EAAI1F,EAAWuF,mBAAmBE,GAC5CtI,KAAKqD,OAAOkB,KAAK,UAAWgE,EAChC,GACJ,CACAC,MAAAA,CAAOV,GACH9H,KAAKqD,OAAOmD,GAAG,QAAQ,IAAM/E,EAAUzB,UAAM,OAAQ,GAAQ,YACzDgD,EAAIkB,SAAS,yBACP4D,GACV,KACJ,EAEJpF,EAAQC,mBAAqBA,C,oCCtS7B,IAAI5C,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACIW,EAAsBhB,MAAQA,KAAKgB,qBAAwBf,OAAOC,OAAU,SAASC,EAAGc,GACxFhB,OAAOc,eAAeZ,EAAG,UAAW,CAAEU,YAAY,EAAMK,MAAOD,GACnE,EAAK,SAASd,EAAGc,GACbd,EAAE,WAAac,CACnB,GACIE,EAAgBnB,MAAQA,KAAKmB,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,CAAC,EACd,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBJ,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKf,IAAIN,EAAgBsB,EAAQD,EAAKf,GAEtI,OADAW,EAAmBK,EAAQD,GACpBC,CACX,EACII,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ+F,uBAAoB,EAC5B,MAAMC,EAAY5I,EAAQ,MACpB8C,EAAc9C,EAAQ,MACtBiD,EAAWjD,EAAQ,MACnB6I,EAAY7I,EAAQ,MACpBgD,EAAUhD,EAAQ,MAClB8I,EAAW9I,EAAQ,MACnB+I,EAAQ/I,EAAQ,MAChB+C,EAAa/C,EAAQ,MACrBkD,EAAM7B,EAAarB,EAAQ,OACjC,MAAM2I,EACFtF,WAAAA,GACInD,KAAKqD,OAAS,IAAIN,EAASO,aAE3BtD,KAAK8I,eAAiB,IAAIH,EAAUI,QAAQnG,EAAYoG,wBACxDhJ,KAAKiJ,OAAS,IAAIL,EAASM,cAC3BlJ,KAAKmJ,WAAanJ,KAAKoJ,sBACvBpJ,KAAKqJ,eAAerJ,KAAKmJ,YAEzBnJ,KAAKsJ,UAAY,IAAIZ,EAAU/F,mBAAmBC,EAAY2G,qBAE9DvJ,KAAKwJ,YAAa,EAClBxJ,KAAKyJ,UAAY,EACjBzJ,KAAK0J,kBAAoB,GACzB1J,KAAK2J,aAAe,GACpB3G,EAAIkB,SAAS,yCAAyClE,KAAK0J,oBAC/D,CACAE,iBAAAA,CAAkBC,GACd,IAAIC,GAAY,EAAIjH,EAAWuF,mBAAmByB,GAClD7J,KAAK8I,eAAeiB,YAAYD,EAAWlH,EAAYoH,wBAC3D,CACAC,sBAAAA,GACI,MAAMC,EAAKlK,KAAK8I,eAAeqB,QAAQvH,EAAYoH,yBAC7CI,EAAiB,OAAPF,QAAsB,IAAPA,OAAgB,EAASA,EAAGE,QAC3D,GAAsB,iBAAXA,EAAqB,CAC5BpH,EAAIkB,SAAS,0BACblB,EAAIkB,SAASkG,GACb,IAAIC,GAAc,EAAIxH,EAAW4E,eAAe2C,GAChD,OAAOC,CACX,CAIA,OAFIrK,KAAK8I,eAAewB,aAEjB,IACX,CACAjB,cAAAA,CAAeQ,GACX,IAAIU,EAAa,CACbC,WAAW,EAAI1H,EAAQ2H,aAAaZ,EAAQW,WAC5CE,WAAW,EAAI5H,EAAQ2H,aAAaZ,EAAQa,YAEhD1H,EAAIkB,SAAS,eACb,IAAI4F,GAAY,EAAIjH,EAAWuF,mBAAmBmC,GAClDvH,EAAIkB,SAAS4F,GACb9J,KAAK8I,eAAeiB,YAAYD,EAAWlH,EAAY+H,qBAC3D,CACAvB,mBAAAA,GACI,MAAMc,EAAKlK,KAAK8I,eAAeqB,QAAQvH,EAAY+H,sBAC7CP,EAAiB,OAAPF,QAAsB,IAAPA,OAAgB,EAASA,EAAGE,QAC3D,GAAsB,iBAAXA,EAAqB,CAC5BpH,EAAIkB,SAAS,sBACblB,EAAIkB,SAASkG,GACb,IAAIQ,GAAiB,EAAI/H,EAAW4E,eAAe2C,GACnDpH,EAAIkB,SAAS,eACblB,EAAIkB,SAAS0G,GACb,IAAIf,EAAU,CACVW,WAAW,EAAI1H,EAAQ+H,gBAAgBD,EAAeJ,WACtDE,WAAW,EAAI5H,EAAQ+H,gBAAgBD,EAAeF,YAE1D,OAAOb,CACX,CAEI,OAAO,EAAIhB,EAAMiC,kBAEzB,CACAC,eAAAA,GAEI,OADA/H,EAAIkB,SAAS,yBAAyBlE,KAAK0J,qBACpC1J,KAAK0J,kBAAkBsB,OAAS,CAC3C,CACAC,OAAAA,CAAQC,GACJ,OAAOzJ,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,aAAa,EAAI6I,EAAMsC,SAASD,EAAOtI,EAAYwI,sBAAuBxI,EAAYyI,qBACtFrL,KAAKmJ,WACT,GACJ,CACAmC,YAAAA,CAAaC,GACT,OAAO9J,EAAUzB,KAAMwL,eAAW,GAAQ,UAAWC,EAAOC,GAAY,GACpE,IAAInE,EACJ,MAAMoE,EAAQC,SAASH,EAAM9G,IAM7B,GALIgH,EAAQ3L,KAAKyJ,YACbzJ,KAAKyJ,UAAYkC,GAErB3L,KAAKqD,OAAOkB,KAAKkH,EAAM9G,GAAI8G,IAEtBC,EAAW,OACN1L,KAAK6L,QAAQJ,EAAM9G,IAAI,GAC7B3E,KAAKyJ,WAAa,EAClB,IAAIyB,EAAqF,QAA5E3D,EAAKvH,KAAK8I,eAAeqB,QAAQvH,EAAYkJ,iCAA8C,IAAPvE,OAAgB,EAASA,EAAG6C,QACzHc,UACMlL,KAAK+L,YAAY/L,KAAKyJ,UAAUnF,WAAYmH,EAAM9G,GAAIuG,GAEpE,CACJ,GACJ,CACAc,cAAAA,CAAed,GACX,OAAOzJ,EAAUzB,UAAM,OAAQ,GAAQ,YAEnC,GADAgD,EAAIkB,SAAS,uCAAuCgH,KAC9B,kBAAVA,GAAwC,IAAjBA,EAAMF,OACrC,MAAM,IAAIrH,MAAM,6BAEpBX,EAAIkB,SAAS,wDACPlE,KAAK+G,YAAW,GACtB/G,KAAK8I,eAAeiB,YAAYmB,EAAOtI,EAAYkJ,0BACnD9I,EAAIkB,SAAS,oDACPlE,KAAK4G,SAAQ,EACvB,GACJ,CACAqF,cAAAA,GACI,IAAIf,GAAQ,EAAIpI,EAAQoJ,iBACxBlJ,EAAIkB,SAAS,yBAAyBgH,KACtClL,KAAK2J,aAAeuB,EACpB,MAAMiB,EAAO,CACTC,UAAWlB,EACXmB,SAAUrM,KAAKiJ,OAAOqD,mBAAmB9B,WAE7C,OAAO2B,CACX,CACAvF,OAAAA,GACI,OAAOnF,EAAUzB,KAAMwL,eAAW,GAAQ,UAAWe,GAAc,GAC/D,IAAIC,EAAgBxM,KAAK8I,eAAeqB,QAAQvH,EAAYkJ,0BAE5D,IAAIZ,EAAQlL,KAAK2J,aAGjB,GAFA3G,EAAIkB,SAAS,yBAAyBgH,KAElCqB,EAAa,CACgB,qBAAlBC,GAAmD,OAAlBA,IACxCxJ,EAAIkB,SAAS,yBAAyBsI,KACtCtB,EAAQsB,EAAcpC,SAE1B,IAAIqC,EAAwBzM,KAAK8I,eAAeqB,QAAQvH,EAAY8J,qCAChED,IACAzM,KAAK0J,kBAAoB+C,EAAsBrC,SAGnD,MAAMC,EAAcrK,KAAKiK,yBACzBjK,KAAKiJ,OAAS,IAAIL,EAASM,cAAcmB,EAC7C,CACArK,KAAK4J,kBAAkB5J,KAAKiJ,OAAOqD,oBACnCtM,KAAK8I,eAAeiB,YAAYmB,EAAOtI,EAAYkJ,0BACnD,IAAIa,QAAiB3M,KAAKiL,QAAQC,GAClClI,EAAIkB,SAAS,uBAAuByI,KACpC3M,KAAK8I,eAAeiB,YAAY4C,EAAU,OAE1C3M,KAAKsJ,UAAUd,QAAO,IAAM/G,EAAUzB,UAAM,OAAQ,GAAQ,YACxDgD,EAAIkB,SAAS,wBAEblE,KAAKqD,OAAO2C,KAAKhG,KAAKyJ,UAAUnF,YAAY,IAAM7C,EAAUzB,UAAM,OAAQ,GAAQ,YAE9EA,KAAKyJ,WAAa,EAElBzJ,KAAKqD,OAAO2C,KAAKhG,KAAKyJ,UAAUnF,YAAY,IAAM7C,EAAUzB,UAAM,OAAQ,GAAQ,YAE9EA,KAAKyJ,WAAa,EAClBzG,EAAIkB,SAAS,0CAA0ClE,KAAKyJ,mBAEtDzJ,KAAK4M,4BAA4B5M,KAAKyJ,UAAUnF,WAAY4G,EACtE,MACAlI,EAAIkB,SAAS,0CAA0ClE,KAAKyJ,mBACtDzJ,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAI,CACAjC,GAAI3E,KAAKyJ,UAAUnF,WACnBuI,QAASjK,EAAYkK,oBACrBC,OAAQnK,EAAYoK,mBACpBtF,OAAQ,CACJwD,MAAOA,IAGnB,MACAlI,EAAIkB,SAAS,yBACPlE,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAI,CACAjC,GAAI3E,KAAKyJ,UAAUnF,WACnBuI,QAASjK,EAAYkK,oBACrBC,OAAQnK,EAAYqK,qBACpBvF,OAAQ,CACJwF,MAAOP,KAIf3M,KAAKsJ,UAAUzB,iBAAiBpD,IAC5B,IAAI8C,EAGJ,GAFAvE,EAAIkB,SAAS,0BACblB,EAAIkB,SAASO,KACP,WAAYA,MAAY,SAAUA,EAAM,WAG1C,OAFAzB,EAAIkB,SAAS,oCACblE,KAAKsL,aAAa7G,GAAO,GAG7B,IAAIkD,EAAsC,QAA5BJ,EAAK9C,EAAMiD,OAAOzD,YAAyB,IAAPsD,OAAgB,EAASA,EAAGK,QAC9E,GAAsB,qBAAXD,EAAwB,CAC/BA,EAASA,EAAOwF,QAAQ,KAAM,KAC9B,IAAIC,GAAgB,EAAIvK,EAAW4E,eAAeE,GACrB,kBAAlByF,GAA8B,aAAcA,GAAiBA,EAAcf,UAAYe,EAAcf,SAASrB,OAAS,IAC9HhL,KAAK0J,kBAAoB0D,EAAcf,SACvCrJ,EAAIkB,SAAS,6CAA6ClE,KAAK0J,qBAC/D1J,KAAK8I,eAAeiB,YAAY/J,KAAK0J,kBAAmB9G,EAAY8J,qCAE5E,CAEA1M,KAAKsL,aAAa7G,EAAOA,EAAMsI,SAAWnK,EAAYyK,uBAAuB,GAErF,YACMrN,KAAKsJ,UAAU1C,UACrB,MAAMuF,EAAO,CACTC,UAAWlB,EACXmB,SAAUrM,KAAKiJ,OAAOqD,mBAAmB9B,WAE7C,OAAO2B,CACX,GACJ,CACApF,UAAAA,GACI,OAAOtF,EAAUzB,KAAMwL,eAAW,GAAQ,UAAWe,GAAc,SACzDvM,KAAKsJ,UAAUvC,aAGrB/G,KAAK8I,eAAewB,WAAW1H,EAAYkJ,0BACtCS,IACDvM,KAAK8I,eAAewB,WAAW1H,EAAY8J,qCAC3C1M,KAAK0J,kBAAoB,GAEjC,GACJ,CACA4D,eAAAA,CAAgB3I,EAAI0C,GAChBrH,KAAKqD,OAAO2C,KAAKrB,GAAI,IAAMlD,EAAUzB,UAAM,OAAQ,GAAQ,YACvD,KAER,CACAmH,WAAAA,CAAY1C,EAAO4C,EAASkG,GACxBvN,KAAKsJ,UAAUnC,aAAY,EAAItE,EAAWuF,mBAAmB3D,IAASkD,IAMlE,GAFAA,EAASA,EAAOwF,QAAQ,KAAM,KAC9BnK,EAAIkB,SAAS,oBAAoByD,KACX,qBAAXA,EAAwB,CAC/B,IAAI6F,GAAS,EAAI3K,EAAW4E,eAAeE,GACvC9C,EAAM2I,EAAO5F,QACb4F,EAAOnB,UAAYmB,EAAOnB,SAASrB,OAAS,IAC5ChL,KAAK0J,kBAAoB8D,EAAOnB,SAChCrM,KAAK8I,eAAeiB,YAAY/J,KAAK0J,kBAAmB9G,EAAY8J,qCACpE1J,EAAIkB,SAAS,yCAAyClE,KAAK0J,sBAE/D,IAAIrI,EAASrB,KAAKiJ,OAAO7B,QAAQvC,EAAK7E,KAAK0J,mBAE3C,OADA1G,EAAIkB,SAAS,oBAAoB7C,KAC1BA,CACX,IACDgG,EAASkG,EAChB,CACA/H,IAAAA,CAAKX,GACD,OAAOpD,EAAUzB,UAAM,OAAQ,GAAQ,YAGnC,GADAgD,EAAIkB,SAAS,sBAAsBW,MAC9B7E,KAAK+K,kBAEN,MAAM,IAAIpH,MAAM,yBAEpB,IAAIiE,EAAU5H,KAAKiJ,OAAOwE,QAAQ5I,EAAK7E,KAAK0J,mBAExCwB,EAAQlL,KAAK8I,eAAeqB,QAAQvH,EAAYkJ,0BACpD,MAAMlH,EAAU,CACZD,GAAI3E,KAAKyJ,UAAUnF,WACnByI,OAAQnK,EAAY8K,uBACpBb,QAASjK,EAAYkK,oBACrBpF,OAAQ,CACJE,QAAS,CAEL+F,UAAWvJ,KAAKC,MAAMC,WACtB4G,MAAiB,OAAVA,QAA4B,IAAVA,OAAmB,EAASA,EAAMd,QAC3DxC,QAASA,EACTgG,IAAKhL,EAAYiL,4BAS7B,aALM7N,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAIhC,GACJ5E,KAAKyJ,WAAa,EACXzJ,KAAKyJ,SAChB,GACJ,CACAoC,OAAAA,CAAQiC,EAASC,GACb,OAAOtM,EAAUzB,KAAMwL,eAAW,GAAQ,UAAWG,EAAOtE,EAAS2G,OAASzN,GAC1E,IAAgB,IAAZ8G,EAAkB,CAClB,MAAMzC,EAAU,CACZD,GAAIgH,EACJkB,QAASjK,EAAYkK,oBACrBzL,QAAQ,SAENrB,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAIhC,EACR,MACK,GAAIoJ,EAAQ,CACb,MAAMpJ,EAAU,CACZD,GAAI3E,KAAKyJ,UAAUnF,WACnBuI,QAASjK,EAAYkK,oBACrB7G,MAAO,CACHgI,KAAMD,EAAOC,KACbrG,QAASoG,EAAOpG,gBAGlB5H,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAIhC,EACR,CACJ,GACJ,CAEAmH,WAAAA,CAAYJ,EAAOgC,EAAWzC,GAC1B,OAAOzJ,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM4E,EAAU,CACZD,GAAIgH,EACJkB,QAASjK,EAAYkK,oBACrBC,OAAQnK,EAAYyK,uBACpB3F,OAAQ,CACJzD,KAAM,CACF0J,UAAWA,EACXzC,MAAOA,WAIblL,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAIhC,EACR,GACJ,CAKAgI,2BAAAA,CAA4BjB,EAAOT,GAC/B,OAAOzJ,EAAUzB,UAAM,OAAQ,GAAQ,YAEnCA,KAAKqD,OAAO2C,KAAK2F,GAAQuC,GAAoBzM,EAAUzB,UAAM,OAAQ,GAAQ,YACzE,IAAIuH,EAAI4G,EAAIC,EAEZ,GAAIF,EAAgB7M,OAAQ,CACxB,IAAIgN,EAAUH,EAAgB7M,OAAOgN,QACjCC,EAAeJ,EAAgB7M,OAAO4C,KAC1C,IAAK,IAAIsK,EAAI,EAAGA,EAAID,EAAatD,OAAQuD,IAAK,CAC1C,IAAI1J,EAAMyJ,EAAaC,GACvBvO,KAAKyJ,WAAa,EAClB,IAAIkE,EAAY9I,EAAI8I,UAChBa,EAAW3J,EAAIqG,MACfsD,GAAYtD,UACNlL,KAAKsJ,UAAUjB,yBAAyBxD,SAExC7E,KAAK+L,YAAY/L,KAAKyJ,UAAUnF,WAAYqJ,EAAWzC,GAErE,CAEA,GAAImD,EAAS,CACwF,QAA5E9G,EAAKvH,KAAK8I,eAAeqB,QAAQvH,EAAYkJ,iCAA8C,IAAPvE,GAAyBA,EAAG6C,QACrIpK,KAAKyJ,WAAa,QACZzJ,KAAK4M,4BAA4B5M,KAAKyJ,UAAUnF,WAAY4G,EACtE,CACJ,MAEIlI,EAAIkB,SAAS,0BAA2D,QAAhCiK,EAAKD,EAAgBjI,aAA0B,IAAPkI,OAAgB,EAASA,EAAGF,UAA2C,QAAhCG,EAAKF,EAAgBjI,aAA0B,IAAPmI,OAAgB,EAASA,EAAGxG,UAEnM,MACA5E,EAAIkB,SAAS,sBACb,MAAMU,EAAU,CACZD,GAAIgH,EACJkB,QAASjK,EAAYkK,oBACrBC,OAAQnK,EAAY6L,wBACpB/G,OAAQ,CACJzD,KAAM,CACFiH,MAAOA,WAIblL,KAAKsJ,UAAU9D,MAAK,IAAM/D,EAAUzB,UAAM,OAAQ,GAAQ,YAC5DgD,EAAIkB,SAAS,wCACPlE,KAAKsJ,UAAU1C,SACzB,KAAIhC,EACR,GACJ,CAEA8J,aAAAA,GACI,IAAInH,EACJ,MAAM8C,EAAcrK,KAAKiJ,OAAOqD,mBAC1BqC,EAAM3O,KAAK8I,eAAeqB,QAAQ,OACxC,MAAO,CACHD,GAAIG,EACJa,MAAoF,QAA5E3D,EAAKvH,KAAK8I,eAAeqB,QAAQvH,EAAYkJ,iCAA8C,IAAPvE,OAAgB,EAASA,EAAG6C,QACxHuE,IAAa,OAARA,QAAwB,IAARA,OAAiB,EAASA,EAAIvE,QAE3D,CACAwE,UAAAA,GACI,OAAOnN,EAAUzB,UAAM,OAAQ,GAAQ,YACnCA,KAAK8I,eAAewB,YAExB,GACJ,EAEJ5H,EAAQ+F,kBAAoBA,C,kCC9b5BxI,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQc,eAAiBd,EAAQ+L,wBAA0B/L,EAAQ2K,uBAAyB3K,EAAQmM,qBAAuBnM,EAAQsK,mBAAqBtK,EAAQgL,uBAAyBhL,EAAQuK,qBAAuBvK,EAAQoM,oBAAsBpM,EAAQoK,oBAAsBpK,EAAQmL,yBAA2BnL,EAAQ2I,qBAAuB3I,EAAQgK,oCAAsChK,EAAQoJ,yBAA2BpJ,EAAQiI,qBAAuBjI,EAAQsH,wBAA0BtH,EAAQsG,uBAAyBtG,EAAQ0I,sBAAwB1I,EAAQ6G,oBAAsB7G,EAAQwD,iCAA8B,EAC7mBxD,EAAQwD,4BAA8B,GACtCxD,EAAQ6G,oBAAsB,6DAC9B7G,EAAQ0I,sBAAwB,SAChC1I,EAAQsG,uBAAyB,WACjCtG,EAAQsH,wBAA0B,kBAClCtH,EAAQiI,qBAAuB,eAC/BjI,EAAQoJ,yBAA2B,aACnCpJ,EAAQgK,oCAAsC,wBAC9ChK,EAAQ2I,qBAAuB,MAC/B3I,EAAQmL,yBAA2B,IAEnCnL,EAAQoK,oBAAsB,MAE9BpK,EAAQoM,oBAAsB,OAC9BpM,EAAQuK,qBAAuB,QAC/BvK,EAAQgL,uBAAyB,UACjChL,EAAQsK,mBAAqB,YAC7BtK,EAAQmM,qBAAuB,cAC/BnM,EAAQ2K,uBAAyB,UACjC3K,EAAQ+L,wBAA0B,gBAClC/L,EAAQc,eAAiB,CACrBC,UAAW,EACXM,WAAY,EACZkB,UAAW,EACX+B,aAAc,E,oCC3BLlH,EAAA,MACb,IAAI2B,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQqM,YAAS,EACjB,MAAMC,EAAqBlP,EAAQ,KAC7B+C,EAAa/C,EAAQ,MACrBmP,EAAQnP,EAAQ,MACtB,MAAMiP,EACF5L,WAAAA,CAAY+L,GACRlP,KAAKmP,gBAAkB,IAAIC,IAC3BpP,KAAKqP,mBAAqB,GAC1BrP,KAAKkP,kBAAoBA,EACzBlP,KAAKkP,kBAAkB/H,YAAY,oBAAoB,CAAC1C,EAAOI,KAC3D,IAAIyK,GAAe,EAAIzM,EAAW4E,eAAe5C,GACjD7E,KAAKuP,eAAe9K,EAAO6K,EAAa,IACzC,WACH,GACJ,CACAE,qBAAAA,CAAsBC,GAClBzP,KAAKqP,mBAAmBK,KAAKD,EACjC,CACA1I,UAAAA,GACI/G,KAAKmP,gBAAgBQ,OACzB,CACAC,YAAAA,GACI,OAAOnO,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM6P,EAAYzL,KAAKC,MAAMC,WAE7B,OADA,EAAI2K,EAAM/K,UAAU,2BAA2B2L,KACxCA,CACX,GACJ,CACAC,qBAAAA,CAAsBD,EAAW9N,GAC7B/B,KAAKmP,gBAAgBY,IAAIF,EAAW9N,EACxC,CACAyD,IAAAA,CAAKwK,EAASjO,EAASkO,GACnB,OAAOxO,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM6P,QAAkB7P,KAAK4P,gBAC7B,EAAIZ,EAAmBkB,iBAAgB,IAAMlQ,KAAKkP,kBAAkB1J,KAAK2K,KAAKC,UAAUnQ,OAAOoQ,OAAOpQ,OAAOoQ,OAAO,CAAC,EAAGL,GAAU,CAAEH,UAAWA,OAAgBI,GAC/JjQ,KAAK8P,sBAAsBD,EAAW9N,EAC1C,GACJ,CACAwN,cAAAA,CAAe9K,EAAO6L,GAElB,IADA,EAAIrB,EAAM/K,UAAU,4BAA2B,EAAIrB,EAAWuF,mBAAmBkI,MAC7E,cAAeA,EAAU,EACzB,EAAIrB,EAAM/K,UAAU,oCACpB,IAAI2L,EAAYS,EAAST,UACzB,MAAM9N,EAAU/B,KAAKmP,gBAAgBrO,IAAI+O,GACrC9N,IACA,EAAIkN,EAAM/K,UAAU,oCAAqCnC,GACzDA,EAAQuO,GAERtQ,KAAKmP,gBAAgBoB,OAAOV,MAG5B,EAAIZ,EAAM/K,UAAU,0CACI,eAApBoM,EAASvD,SACT/M,KAAKqP,mBAAmBmB,SAAQxI,GAAYA,MAC5ChI,KAAKqP,mBAAqB,GAC1BrP,KAAK+G,cAGjB,CACJ,EAEJrE,EAAQqM,OAASA,C,oCCvEjB,IAAIhP,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACIW,EAAsBhB,MAAQA,KAAKgB,qBAAwBf,OAAOC,OAAU,SAASC,EAAGc,GACxFhB,OAAOc,eAAeZ,EAAG,UAAW,CAAEU,YAAY,EAAMK,MAAOD,GACnE,EAAK,SAASd,EAAGc,GACbd,EAAE,WAAac,CACnB,GACIE,EAAgBnB,MAAQA,KAAKmB,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,CAAC,EACd,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBJ,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKf,IAAIN,EAAgBsB,EAAQD,EAAKf,GAEtI,OADAW,EAAmBK,EAAQD,GACpBC,CACX,EACII,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACIqO,EAAmBzQ,MAAQA,KAAKyQ,iBAAoB,SAAUrP,GAC9D,OAAQA,GAAOA,EAAIV,WAAcU,EAAM,CAAE,QAAWA,EACxD,EACAnB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQgO,0BAA4BhO,EAAQiO,0BAA4BjO,EAAQkO,wBAA0BlO,EAAQmO,4BAA8BnO,EAAQoO,WAAapO,EAAQqO,WAAarO,EAAQsO,cAAgBtO,EAAQuO,qBAAuBvO,EAAQwO,cAAgBxO,EAAQyO,cAAgBzO,EAAQ0O,aAAe1O,EAAQ2O,cAAgB3O,EAAQ4O,gBAAkB5O,EAAQ6O,gBAAkB7O,EAAQ8O,mBAAgB,EAC5Z9O,EAAQoI,gBAAkBA,EAC1BpI,EAAQ+O,WAAaA,EACrB/O,EAAQgP,WAAaA,EACrBhP,EAAQiP,UAAYA,EACpBjP,EAAQkP,UAAYA,EACpBlP,EAAQmP,UAAYA,EACpBnP,EAAQoP,UAAYA,EACpBpP,EAAQqP,WAAaA,EACrBrP,EAAQsP,WAAaA,EACrBtP,EAAQuP,UAAYA,EACpBvP,EAAQwP,UAAYA,EACpBxP,EAAQyI,QAAUA,EAClBzI,EAAQyP,UAAYA,EACpB,MAAMC,EAAUjR,EAAarB,EAAQ,OAC/BuS,EAAcvS,EAAQ,MACtBwS,EAAgBxS,EAAQ,MACxB+C,EAAa/C,EAAQ,MACrBgD,EAAUhD,EAAQ,MAClByS,EAAc9B,EAAgB3Q,EAAQ,OACtCkD,EAAM7B,EAAarB,EAAQ,OAgBjC,SAASgL,IAGL,OAAOyH,EAAYC,QAAQC,KAAK5I,SACpC,CACA,SAAS4H,EAAWiB,GAChB,OAAO,EAAI7P,EAAW4E,gBAAe,EAAI4K,EAAY/N,WAAU,EAAIgO,EAAcK,YAAYD,EAAKhQ,EAAQ0O,cAAe1O,EAAQyO,eACrI,CACA,SAASO,EAAWkB,GAChB,OAAO,EAAIP,EAAY/N,WAAU,EAAIgO,EAAcK,aAAY,EAAI9P,EAAWuF,mBAAmBwK,GAAMlQ,EAAQyO,eAAgBzO,EAAQ0O,aAC3I,CAiBA,SAASO,EAAUnH,GAGfxH,EAAIkB,SAAS,eAAc,EAAIpB,EAAQ2H,aAAaD,MACpD,IAAIqI,GAAe,EAAIR,EAAY/N,UAAUkG,EAAW9H,EAAQmO,6BAIhE,MAAO,CAACnO,EAAQqO,WAAYrO,EAAQoO,WAAY+B,GAAcC,KAAKpQ,EAAQsO,cAC/E,CACA,SAASY,EAAUmB,GACf,MAAOC,EAAQjG,EAAQkG,GAAcF,EAAOG,MAAMxQ,EAAQsO,eAC1D,GAAIgC,IAAWtQ,EAAQqO,YAAchE,IAAWrK,EAAQoO,WACpD,MAAM,IAAInN,MAAM,0CAapB,MAAM6G,GAAY,EAAI8H,EAAcK,YAAYM,EAAYvQ,EAAQmO,6BACpE,GAAIrG,EAAUQ,SAAWtI,EAAQgO,0BAC7B,MAAM,IAAI/M,MAAM,oDAEpB,OAAO6G,CACX,CAEA,SAASqH,EAAUsB,GACf,OAAO,EAAId,EAAY/N,UAAU6O,EAAOzQ,EAAQ0O,aACpD,CACA,SAASU,EAAUsB,GACf,OAAO,EAAId,EAAcK,YAAYS,EAAS1Q,EAAQ0O,aAC1D,CAEA,SAASW,EAAWrK,GAChB,OAAO,EAAI4K,EAAcK,YAAY,CAACjB,EAAWhK,EAAO2L,QAAS3B,EAAWhK,EAAO9C,UAAUkO,KAAKpQ,EAAQ2O,eAAgB3O,EAAQwO,cACtI,CACA,SAASc,EAAW/N,GAChB,MAAMyD,GAAS,EAAI2K,EAAY/N,UAAUL,EAAMvB,EAAQwO,eAAegC,MAAMxQ,EAAQ2O,eAC9EgC,EAAS5B,EAAW/J,EAAO,IAC3B9C,EAAU6M,EAAW/J,EAAO,IAClC,MAAO,CAAE2L,SAAQzO,UACrB,CAEA,SAASqN,EAAUvK,GACf,MAAO,CAACgK,EAAWhK,EAAO2L,QAAS3B,EAAWhK,EAAO9C,SAAUiN,EAAUnK,EAAO4L,YAAYR,KAAKpQ,EAAQ2O,cAC7G,CACA,SAASa,EAAUvD,GACf,MAAMjH,EAASiH,EAAIuE,MAAMxQ,EAAQ2O,eAC3BgC,EAAS5B,EAAW/J,EAAO,IAC3B9C,EAAU6M,EAAW/J,EAAO,IAC5B4L,EAAYxB,EAAUpK,EAAO,IAC7BzD,GAAO,EAAIqO,EAAcK,YAAYjL,EAAO6L,MAAM,EAAG,GAAGT,KAAKpQ,EAAQ2O,eAAgB3O,EAAQwO,eACnG,MAAO,CAAEmC,SAAQzO,UAAS0O,YAAWrP,OACzC,CACA,SAASkH,EAAQqI,EAAOC,EAAOC,EAAOC,GAClC,OAAOlS,EAAUzB,KAAMwL,eAAW,GAAQ,UAAWoI,EAAKC,EAAKjG,EAAK/D,EAASiK,EAAMC,KAAKC,MAAM5P,KAAKC,QAC/F,MAAMgP,EAAS,CAAEY,IAAKvR,EAAQ6O,gBAAiB2C,IAAKxR,EAAQ4O,iBACtD6C,EAAMxC,EAAU9H,EAAQW,WACxB4J,EAAMN,EAAMlG,EACZyG,EAAM,oBACNzP,EAAU,CAAEuP,MAAKP,MAAKC,MAAKQ,MAAKP,MAAKM,OACrCnQ,EAAO8N,EAAW,CAAEsB,SAAQzO,YAElC5B,EAAIkB,SAAS,eAAe2F,EAAQa,cAAcb,EAAQa,UAAUM,WACpE,MAAMsI,EAAYf,EAAYC,QAAQC,KAAK6B,SAASrQ,EAAM4F,EAAQa,WAClE,OAAOuH,EAAU,CAAEoB,SAAQzO,UAAS0O,aACxC,GACJ,CACA,SAASnB,EAAUxD,GACf,OAAOlN,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM,OAAEqT,EAAM,QAAEzO,EAAO,KAAEX,EAAI,UAAEqP,GAAcpB,EAAUvD,GACvD,GAAI0E,EAAOY,MAAQvR,EAAQ6O,iBAAmB8B,EAAOa,MAAQxR,EAAQ4O,gBACjE,MAAM,IAAI3N,MAAM,gCAEpB,MAAM6G,EAAYoH,EAAUhN,EAAQuP,KACpC,OAAO/B,EAAQmC,OAAO/J,EAAWvG,EAAMqP,EAC3C,GACJ,CA9HA5Q,EAAQ8O,cAAgB,OACxB9O,EAAQ6O,gBAAkB,QAC1B7O,EAAQ4O,gBAAkB,MAC1B5O,EAAQ2O,cAAgB,IACxB3O,EAAQ0O,aAAe,YACvB1O,EAAQyO,cAAgB,OACxBzO,EAAQwO,cAAgB,OACxBxO,EAAQuO,qBAAuB,GAC/BvO,EAAQsO,cAAgB,IACxBtO,EAAQqO,WAAa,MACrBrO,EAAQoO,WAAa,MACrBpO,EAAQmO,4BAA8B,YACtCnO,EAAQkO,wBAA0B,IAClClO,EAAQiO,0BAA4B,MACpCjO,EAAQgO,0BAA4B,E,oCCvEpC,IAAI3Q,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACIW,EAAsBhB,MAAQA,KAAKgB,qBAAwBf,OAAOC,OAAU,SAASC,EAAGc,GACxFhB,OAAOc,eAAeZ,EAAG,UAAW,CAAEU,YAAY,EAAMK,MAAOD,GACnE,EAAK,SAASd,EAAGc,GACbd,EAAE,WAAac,CACnB,GACIE,EAAgBnB,MAAQA,KAAKmB,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,CAAC,EACd,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBJ,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKf,IAAIN,EAAgBsB,EAAQD,EAAKf,GAEtI,OADAW,EAAmBK,EAAQD,GACpBC,CACX,EACApB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQqG,aAAU,EAClB,MAAMjG,EAAUhD,EAAQ,MAClB+C,EAAa/C,EAAQ,MACrBkD,EAAM7B,EAAarB,EAAQ,OACjC,MAAMiJ,EACF5F,WAAAA,CAAYqR,GAER,MAAMC,GAAe,EAAI3R,EAAQ4R,uBACjC1U,KAAKwU,OAASA,EACdxR,EAAIkB,SAAS,8CACblB,EAAIkB,SAASuQ,GACb,MAAME,EAAWF,EAAatK,QAAQpB,EAAQ6L,SAAWJ,GACzD,GAAwB,qBAAbG,GAAyC,OAAbA,EAGnC,OAFA3R,EAAIkB,SAAS,sBACblE,KAAK6U,MAAQ,CAAC,GAIlB,GADA7R,EAAIkB,SAASyQ,IACK,OAAbA,QAAkC,IAAbA,OAAsB,EAASA,EAAS3J,QAAU,EAAG,CAC3E,IAAI8J,GAAW,EAAIjS,EAAW4E,eAAekN,GAC7C3U,KAAK6U,MAAQC,CACjB,CACA9R,EAAIkB,SAAS,kBAAkBlE,KAAK6U,SACV,qBAAf7U,KAAK6U,OAAuC,MAAd7U,KAAK6U,QAC1C7U,KAAK6U,MAAQ,CAAC,EAEtB,CACA9K,WAAAA,CAAYK,EAAS2K,EAAKpQ,EAAK,KAC3B,IAAIqQ,EAAO,CACPrQ,GAAIA,EACJsQ,UAAW7Q,KAAKC,MAAMC,WACtB8F,QAASA,GAEbpK,KAAKkV,SAASF,EAAMD,EACxB,CACAG,QAAAA,CAASF,EAAMD,GACX,IAAII,EAAWpM,EAAQ6L,SAAW5U,KAAKwU,OACvC,MAAMC,GAAe,EAAI3R,EAAQ4R,uBACjC1R,EAAIkB,SAASlE,KAAK6U,OAClB7R,EAAIkB,SAAS,kBAAkBlE,KAAK6U,UAAUE,MAAQC,KACtDhV,KAAK6U,MAAME,GAAOC,EAClB,IAAII,GAAgB,EAAIvS,EAAWuF,mBAAmBpI,KAAK6U,OAC3D7R,EAAIkB,SAAS,YAAY6Q,OAAS/U,KAAK6U,SACvCJ,EAAaY,QAAQF,EAAUC,EACnC,CACAjL,OAAAA,CAAQ4K,GAEJ,OADA/R,EAAIkB,SAAS,YAAY6Q,OAAS/U,KAAK6U,SAChC7U,KAAK6U,MAAME,EACtB,CACAzK,UAAAA,CAAWyK,OAAMxU,GACb,QAAYA,IAARwU,EAAmB,CAEnB/U,KAAK6U,MAAQ,CAAC,EACd,IAAIM,EAAWpM,EAAQ6L,SAAW5U,KAAKwU,OACvCC,aAAaY,QAAQF,EAAU,GACnC,KACK,CACD,IAAIA,EAAWpM,EAAQ6L,SAAW5U,KAAKwU,OACvC,MAAMC,GAAe,EAAI3R,EAAQ4R,uBACjC1R,EAAIkB,SAASlE,KAAK6U,OAClB7U,KAAK6U,MAAME,GAAO,KAClB,IAAIK,GAAgB,EAAIvS,EAAWuF,mBAAmBpI,KAAK6U,OAC3D7R,EAAIkB,SAAS,sBAAsB6Q,OAAS/U,KAAK6U,SACjDJ,EAAaY,QAAQF,EAAUC,EACnC,CACJ,EAEJ1S,EAAQqG,QAAUA,EAClBA,EAAQ6L,SAAW,e,oCC5FnB,IAAInE,EAAmBzQ,MAAQA,KAAKyQ,iBAAoB,SAAUrP,GAC9D,OAAQA,GAAOA,EAAIV,WAAcU,EAAM,CAAE,QAAWA,EACxD,EACAnB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwG,mBAAgB,EACxB,MAAMqJ,EAAc9B,EAAgB3Q,EAAQ,OACtCgD,EAAUhD,EAAQ,MACxB,MAAMoJ,EACF/F,WAAAA,CAAY0G,OAAUtJ,GAClBP,KAAKsV,YAAc,GACnBtV,KAAKuV,eAAiB1L,EAAU7J,KAAKwV,wBAAwB3L,GAAW7J,KAAKyV,eACjF,CACAA,aAAAA,GACI,OAAOlD,EAAYC,QAAQkD,IAAI7L,SACnC,CACA2L,uBAAAA,CAAwB3L,GACpB,MAAO,CACHW,WAAW,EAAI1H,EAAQ+H,gBAAgBhB,EAAQW,WAC/CE,WAAW,EAAI5H,EAAQ+H,gBAAgBhB,EAAQa,WAEvD,CACAiL,WAAAA,GACI,OAAOpD,EAAYC,QAAQoD,YAAY5V,KAAKsV,YAChD,CACA,WAAIzL,GACA,OAAO7J,KAAKuV,cAChB,CACA9H,OAAAA,CAAQ7F,EAASiO,GACb,MAAMC,GAAiB,IAAIC,aAAcC,OAAOpO,GAC1CqO,EAAQjW,KAAK2V,cACbO,EAAY3D,EAAYC,QAAQkD,IAAII,EAAgBG,GAAO,EAAInT,EAAQ+H,gBAAgBgL,GAAoB7V,KAAK6J,QAAQa,WAC9H,IAAIyL,GAAY,EAAIrT,EAAQ2H,cAAa,EAAI3H,EAAQsT,mBAAmBH,EAAOC,IAC3EG,GAAgB,IAAIN,aAAcC,OAAOG,GAC7C,OAAO,EAAIrT,EAAQwT,cAAcD,GAAe,EACpD,CACAjP,OAAAA,CAAQQ,EAAS2O,GACb,IAAIC,GAAgB,EAAI1T,EAAQ2T,cAAc7O,GAAS,GACnD8O,EAAmBF,EAAcG,eACrC,MAAOV,EAAOW,IAAmB,EAAI9T,EAAQ+T,oBAAoBH,EAAkB1W,KAAKsV,aAClFwB,EAAYvE,EAAYC,QAAQkD,IAAIqB,KAAKH,EAAiBX,GAAO,EAAInT,EAAQ+H,gBAAgB0L,GAAkBvW,KAAK6J,QAAQa,WAClI,IAAKoM,EACD,MAAM,IAAInT,MAAM,iCAAiCiE,EAAQtD,gCAAgCiS,EAAgBjS,iCAAiCtE,KAAK6J,QAAQW,UAAUlG,oCAAoCtE,KAAK6J,QAAQa,UAAUpG,cAEhO,OAAO,IAAI0S,aAAcC,OAAOH,EACpC,CACAxK,gBAAAA,GACI,MAAO,CACH9B,WAAW,EAAI1H,EAAQ2H,aAAazK,KAAK6J,QAAQW,WACjDE,WAAW,EAAI5H,EAAQ2H,aAAazK,KAAK6J,QAAQa,WAEzD,EAEJhI,EAAQwG,cAAgBA,C,mCCpDxBjJ,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwU,wBAA0BxU,EAAQyU,6BAA+BzU,EAAQ0U,4BAA8B1U,EAAQ2U,iBAAmB3U,EAAQ4U,aAAe5U,EAAQ6U,qBAAkB,EAC3L,IAAIC,EAAsB1X,EAAQ,MAClCG,OAAOc,eAAe2B,EAAS,kBAAmB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO0W,EAAoBD,eAAiB,IACrI,IAAIE,EAAkB3X,EAAQ,MAC9BG,OAAOc,eAAe2B,EAAS,eAAgB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO2W,EAAgBH,YAAc,IAC3H,IAAII,EAAuB5X,EAAQ,MACnCG,OAAOc,eAAe2B,EAAS,mBAAoB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO4W,EAAqBL,gBAAkB,IACxI,IAAIM,EAAmC7X,EAAQ,MAC/CG,OAAOc,eAAe2B,EAAS,8BAA+B,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO6W,EAAiCP,2BAA6B,IAC1K,IAAIQ,EAAqC9X,EAAQ,MACjDG,OAAOc,eAAe2B,EAAS,+BAAgC,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO8W,EAAmCT,4BAA8B,IAC9K,IAAIU,EAA+B/X,EAAQ,MAC3CG,OAAOc,eAAe2B,EAAS,0BAA2B,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO+W,EAA6BX,uBAAyB,G,kCCb9JjX,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ6U,qBAAkB,EAI1B,MAAMA,UAAwB5T,MAC1B,QAAIwI,GACA,MAAO,EACX,CACAhJ,WAAAA,CAAYyE,GACRkQ,MAAMlQ,GACN5H,KAAK4H,QAAU,GAAG2P,EAAgBvE,UAAUhT,KAAKmD,YAAY4U,OAAO/X,KAAKmM,KAAO,KAAOnM,KAAKmM,KAAO,KAAKvE,EAAU,KAAOA,EAAU,KACnI3H,OAAO+X,eAAehY,KAAMuX,EAAgBjW,UAChD,EAEJoB,EAAQ6U,gBAAkBA,EAC1BA,EAAgBvE,OAAS,yB,oCChBzB/S,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ4U,kBAAe,EACvB,MAAME,EAAsB1X,EAAQ,MAIpC,MAAMwX,UAAqBE,EAAoBD,iBAE/C7U,EAAQ4U,aAAeA,C,oCCRvBrX,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ2U,sBAAmB,EAC3B,MAAMG,EAAsB1X,EAAQ,MAIpC,MAAMuX,UAAyBG,EAAoBD,gBAC/CpU,WAAAA,CAAYyE,GACRkQ,MAAMlQ,GACN3H,OAAO+X,eAAehY,KAAMqX,EAAiB/V,UACjD,CACA,QAAI6K,GACA,MAAO,wCACX,EAEJzJ,EAAQ2U,iBAAmBA,C,oCCf3BpX,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ0U,iCAA8B,EACtC,MAAMI,EAAsB1X,EAAQ,MAIpC,MAAMsX,UAAoCI,EAAoBD,gBAC1D,QAAIpL,GACA,MAAO,iIACX,EAEJzJ,EAAQ0U,4BAA8BA,C,oCCXtCnX,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwU,6BAA0B,EAClC,MAAMM,EAAsB1X,EAAQ,MAIpC,MAAMoX,UAAgCM,EAAoBD,gBACtD,QAAIpL,GACA,MAAO,kFACX,EAEJzJ,EAAQwU,wBAA0BA,C,oCCXlCjX,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQyU,kCAA+B,EACvC,MAAMK,EAAsB1X,EAAQ,MAIpC,MAAMqX,UAAqCK,EAAoBD,gBAC3D,QAAIpL,GACA,MAAO,kDACX,EAEJzJ,EAAQyU,6BAA+BA,C,oCCXvC,IAAIpX,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,KAAY4C,E,oCCfjC,IAAIjB,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQyV,oBAAiB,EACzB,MAAMC,EAAYtY,EAAQ,MAI1B,MAAMqY,EACFhV,WAAAA,GACInD,KAAKyU,cAAe,EAAI2D,EAAUC,qBACtC,CACAlO,OAAAA,CAAQ4K,GACJ,OAAOtT,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAKyU,aAAatK,QAAQ4K,EACrC,GACJ,CACAuD,UAAAA,CAAWvD,GACP,OAAOtT,EAAUzB,UAAM,OAAQ,GAAQ,YACnCA,KAAKyU,aAAa6D,WAAWvD,EACjC,GACJ,CACAM,OAAAA,CAAQN,EAAK7T,GACT,OAAOO,EAAUzB,UAAM,OAAQ,GAAQ,YACnCA,KAAKyU,aAAaY,QAAQN,EAAK7T,EACnC,GACJ,EAEJwB,EAAQyV,eAAiBA,C,kCCnCzBlY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ6V,qBAAkB,EAK1B,MAAMA,EACF,kBAAOC,GAIH,OAHKD,EAAgBE,WACjBF,EAAgBE,SAAW,IAAIF,GAE5BA,EAAgBE,QAC3B,CACAtV,WAAAA,GACInD,KAAK0Y,QAAU,CAAC,CACpB,CACA,UAAI1N,GACA,OAAO/K,OAAO0Y,KAAK3Y,KAAK0Y,SAAS1N,MACrC,CACA2E,KAAAA,GACI3P,KAAK0Y,QAAU,CAAC,CACpB,CACAvO,OAAAA,CAAQ4K,GACJ,IAAIxN,EACJ,OAAoC,QAA5BA,EAAKvH,KAAK0Y,QAAQ3D,UAAyB,IAAPxN,EAAgBA,EAAK,IACrE,CACAwN,GAAAA,CAAI6D,GACA,IAAIrR,EACJ,MAAMoR,EAAO1Y,OAAO0Y,KAAK3Y,KAAK0Y,SAC9B,OAAIE,EAAQ,GAAKA,GAASD,EAAK3N,OACpB,KAEmB,QAAtBzD,EAAKoR,EAAKC,UAA2B,IAAPrR,EAAgBA,EAAK,IAC/D,CACA+Q,UAAAA,CAAWvD,UACA/U,KAAK0Y,QAAQ3D,EACxB,CACAM,OAAAA,CAAQN,EAAK7T,GACTlB,KAAK0Y,QAAQ3D,GAAO7T,CACxB,EAEJwB,EAAQ6V,gBAAkBA,C,iCCzC1B,IAAI9W,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EAUA,SAAS8N,EAAe2I,EAAIC,GACxB,OAAOrX,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EAAI4G,EACR,MAAM4K,EAAyF,QAA7ExR,EAAiB,OAAZuR,QAAgC,IAAZA,OAAqB,EAASA,EAAQC,gBAA6B,IAAPxR,EAAgBA,EAAK,EACtHyR,EAAuF,QAA5E7K,EAAiB,OAAZ2K,QAAgC,IAAZA,OAAqB,EAASA,EAAQE,eAA4B,IAAP7K,EAAgBA,EAAK,IAC1H,GAAkB,oBAAP0K,EACP,MAAM,IAAIlV,MAAM,mCAAmCkV,GAEvD,IACII,EADA1K,EAAI,EAER,MAAOA,EAAIwK,EACP,IACI,aAAaF,GACjB,CACA,MAAOK,GACHD,EAAYC,EACZ3K,IACIA,EAAIwK,UACEI,EAAMH,GAEpB,CAEJ,MAAMC,CACV,GACJ,CAOA,SAASE,EAAMC,EAASN,GACpB,OAAOrX,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,OAAO,IAAIgC,SAAQ,CAACD,EAASE,KACzB,IAAIsF,EAAI4G,EACR,GAAgF,QAA3E5G,EAAiB,OAAZuR,QAAgC,IAAZA,OAAqB,EAASA,EAAQO,cAA2B,IAAP9R,OAAgB,EAASA,EAAG+R,QAEhH,YADArX,EAAO,IAAI0B,MAAM,kBAGrB,MAAM4V,EAAY9T,YAAW,IAAM1D,KAAWqX,GAC8B,QAA3EjL,EAAiB,OAAZ2K,QAAgC,IAAZA,OAAqB,EAASA,EAAQO,cAA2B,IAAPlL,GAAyBA,EAAGrH,iBAAiB,SAAS,KACtI0S,aAAaD,GACbtX,EAAO,IAAI0B,MAAM,iBAAiB,GACpC,GAEV,GACJ,CAvDA1D,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwN,eAAiBA,EACzBxN,EAAQyW,MAAQA,C,oCCXhBlZ,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ+W,gBAAkBA,EAC1B,MAAMC,EAAW5Z,EAAQ,MACzB,SAAS2Z,EAAgB/R,GACrB,IAAIiS,EAAa,mCAAmCjS,EAAO0E,2BAA2B1E,EAAO2E,0FAA0F3E,EAAOmI,oFAAoFnI,EAAOkS,+BAA+BlS,EAAOmS,cAC3TC,EAAYJ,EAASK,OAAOC,KAAKL,GAAYrV,SAAS,UAC1D,MAAO,uFAAuFwV,GAClG,C,kCCHA,SAAS5V,KAAY+V,GAEb,IACIC,QAAQC,MAAM,uBAAwBF,EAC1C,CACA,MAAO1S,GAAM,CAErB,CACA,SAAS6S,KAAYH,GAEb,IACIC,QAAQjU,MAAM,uBAAwBgU,EAC1C,CACA,MAAO1S,GAAM,CAErB,CACA,SAAS8S,KAAcJ,GAEf,IACIC,QAAQI,KAAK,uBAAwBL,EACzC,CACA,MAAO1S,GAAM,CAErB,CA3BAtH,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwB,SAAWA,EACnBxB,EAAQ0X,SAAWA,EACnB1X,EAAQ2X,WAAaA,C,oCCHrBpa,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ+E,cAAgBA,EACxB/E,EAAQ0F,kBAAoBA,EAC5B,MAAM6G,EAAQnP,EAAQ,MAChBya,EAAiBtW,GAASkM,KAAKC,UAAUnM,GAAM,CAACuW,EAAGtZ,IAA4B,kBAAVA,EAAqBA,EAAMoD,WAAa,IAAMpD,IAQnHuZ,EAAaC,IAQf,MAAMC,EAA0B,+QAC1BC,EAAiBF,EAAKvN,QAAQwN,GAA0BE,GAAU,IAAIA,QAC5E,OAAO1K,KAAK2K,MAAMF,GAAgB,CAACJ,EAAGtZ,KAClC,MAAM6Z,EAAwC,kBAAV7Z,GAAsBA,EAAM2Z,MAAM,UACtE,OAAIE,EACOC,OAAO9Z,EAAM+Z,UAAU,EAAG/Z,EAAM8J,OAAS,IAC7C9J,CAAK,GACd,EAEN,SAASuG,EAAcvG,GACnB,GAAqB,kBAAVA,EAEP,MADA,EAAI+N,EAAM/K,UAAUhD,GACd,IAAIyC,MAAM,+CAA+CzC,GAEnE,IACI,OAAOuZ,EAAUvZ,EACrB,CACA,MAAOmB,GAGH,OADA6X,QAAQjU,MAAM,uBAAwB5D,GAC/BnB,CACX,CACJ,CACA,SAASkH,EAAkBlH,GACvB,MAAwB,kBAAVA,EAAqBA,EAAQqZ,EAAcrZ,IAAU,EACvE,C,kCCzCA,SAASga,EAAmB9X,GACxB,MAAsB,MAAlBA,EAAImQ,OAAO,GACJnQ,EAAImQ,MAAM,GAAI,GAElBnQ,CACX,CACA,SAAS+X,EAAa/X,EAAKgY,GACvB,OAAOF,EAAmB9X,GAAO,IAAMgY,CAC3C,CACA,SAASC,EAA4BC,GAMjCC,OAAOxE,KAAKuE,EAChB,CApBArb,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwY,mBAAqBA,EAC7BxY,EAAQyY,aAAeA,EACvBzY,EAAQ2Y,4BAA8BA,C,oCCJzBvb,EAAA,MAAAA,EAAA,MAAAA,EAAA,MAAAA,EAAA,MAAAA,EAAA,MAAAA,EAAA,MACb,IAAI2Q,EAAmBzQ,MAAQA,KAAKyQ,iBAAoB,SAAUrP,GAC9D,OAAQA,GAAOA,EAAIV,WAAcU,EAAM,CAAE,QAAWA,EACxD,EACAnB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ8Y,cAAgB9Y,EAAQ+Y,UAAY/Y,EAAQgS,oBAAsBhS,EAAQgZ,gBAAkBhZ,EAAQ4D,oBAAsB5D,EAAQQ,oCAAiC,EAC3KR,EAAQmI,eAAiBA,EACzBnI,EAAQ+H,YAAcA,EACtB/H,EAAQ0T,kBAAoBA,EAC5B1T,EAAQmU,mBAAqBA,EAC7BnU,EAAQ4T,aAAeA,EACvB5T,EAAQ+T,aAAeA,EACvB/T,EAAQgB,WAAaA,EACrBhB,EAAQiZ,QAAUA,EAClBjZ,EAAQkZ,sBAAwBA,EAChClZ,EAAQwJ,cAAgBA,EACxBxJ,EAAQmZ,iBAAmBA,EAC3B,MAAMtJ,EAAc9B,EAAgB3Q,EAAQ,OACtCgc,EAAmBrL,EAAgB3Q,EAAQ,OAC3CwS,EAAgBxS,EAAQ,MACxBuS,EAAcvS,EAAQ,MACtBic,EAAWjc,EAAQ,MACnB+C,EAAa/C,EAAQ,MACrBkc,EAAalc,EAAQ,MACrBmP,EAAQnP,EAAQ,MAChBmc,EAAS,SACf,SAASpR,EAAeqR,GACpB,GAAIA,EAAUlR,OAAS,IAAM,EACzB,MAAM,IAAIrH,MAAM,kBAAkBuY,mBAEtC,MAAM7a,EAAS,IAAI8a,WAAWD,EAAUlR,OAAS,GACjD,IAAK,IAAIuD,EAAI,EAAGA,EAAI2N,EAAUlR,OAAQuD,GAAK,EACvClN,EAAOkN,EAAI,GAAK3C,SAASsQ,EAAU3I,MAAMhF,EAAGA,EAAI,GAAI,IAExD,OAAOlN,CACX,CACA,SAASoJ,EAAY2R,GACjB,IAAIF,EAAY,GAIhB,OAHAE,EAAU5L,SAAQ6L,IACdH,IAAc,KAAc,IAAPG,GAAa/X,SAAS,KAAKiP,OAAO,EAAE,IAEtD2I,CACX,CACA,SAAS9F,EAAkBkG,EAASC,GAChC,MAAMC,EAAc,IAAIL,WAAWG,EAAQtR,OAASuR,EAAQvR,QAG5D,OAFAwR,EAAYzM,IAAIuM,GAChBE,EAAYzM,IAAIwM,EAASD,EAAQtR,QAC1BwR,CACX,CACA,SAAS3F,EAAmB4F,EAAO7D,GAC/B,GAAIA,GAAS6D,EAAMzR,OACf,MAAM,IAAIrH,MAAM,0BAEpB,MAAM+Y,EAAYD,EAAMlJ,MAAM,EAAGqF,GAC3B+D,EAAYF,EAAMlJ,MAAMqF,GAC9B,MAAO,CAAC8D,EAAWC,EACvB,CACA,SAASC,EAAiB1b,EAAO2b,GAC7B,MAAMzJ,EAAU0I,EAAiBtJ,QAAQsK,aAAa5b,GACtD,OAAK2b,EAGEE,mBAAmB3J,GAFfA,CAGf,CACA,SAAS4J,EAAmB9b,EAAO2b,GAI/B,OAHIA,IACA3b,EAAQ+b,mBAAmB/b,IAExB4a,EAAiBtJ,QAAQ0K,aAAahc,EACjD,CACA,SAASoV,EAAapV,EAAO2b,GACzB,IAAIM,EAUJ,OATIjc,aAAiBib,WACjBgB,EAAajc,GAGQ,kBAAVA,IACPA,GAAQ,EAAI2B,EAAWuF,mBAAmBlH,IAE9Cic,EAAarB,EAAiBtJ,QAAQ4K,WAAWlc,IAE9C0b,EAAiBO,EAAYN,EACxC,CACA,SAASpG,EAAavV,EAAO2b,GACzB,MAAMQ,EAAoBL,EAAmB9b,EAAO2b,GACpD,MAAO,CACHvY,QAAAA,GACI,OAAOwX,EAAiBtJ,QAAQ8K,WAAWD,EAC/C,EACAE,QAAAA,GACI,IACI,OAAO,EAAI1a,EAAW4E,eAAeqU,EAAiBtJ,QAAQ8K,WAAWD,GAC7E,CACA,MAAOhb,GACH,OAAO,IACX,CACJ,EACAsU,YAAAA,GACI,OAAO0G,CACX,EAER,CACA,SAAS3Z,EAAWN,GAChB,MAAMyX,EAAQzX,EAAIyX,MAAM,IAAI2C,OAAO,QAAS,OAC5C,IAAK3C,IAAUA,EAAM7P,OACjB,OAAO,EAEX,IAAIyS,EAAS5C,EAAM,GACnB,OAAO,IAAI2C,OAAO,UAAUE,KAAKD,EACrC,CACA,MAAMva,EAAiCA,IACV,qBAAdoC,UACAA,UAEgB,qBAAXqY,EAAAA,GAAsD,qBAArBA,EAAAA,EAAOrY,UAC7CqY,EAAAA,EAAOrY,UAES,qBAAXiW,QAAsD,qBAArBA,OAAOjW,UAC7CiW,OAAOjW,UAEO,qBAATsY,MAAkD,qBAAnBA,KAAKtY,UACzCsY,KAAKtY,UAETxF,EAAQ,KAEnB4C,EAAQQ,+BAAiCA,EACzC,MAAMoD,EAAsBA,IAA2B,qBAAdhB,WAClB,qBAAXqY,EAAAA,GAAsD,qBAArBA,EAAAA,EAAOrY,WAC7B,qBAAXiW,QAAsD,qBAArBA,OAAOjW,WAC/B,qBAATsY,MAAkD,qBAAnBA,KAAKtY,UAChD5C,EAAQ4D,oBAAsBA,EAC9B,MAAMoV,EAAkBA,IAAyB,qBAAXiC,EAAAA,GAA0D,qBAAxBA,EAAAA,EAAOlJ,cACxD,qBAAX8G,QAAyD,qBAAxBA,OAAO9G,aACpD/R,EAAQgZ,gBAAkBA,EAC1B,MAAMhH,EAAsBA,IACF,qBAAXiJ,EAAAA,GAAyD,qBAAxBA,EAAAA,EAAOlJ,aACxCkJ,EAAAA,EAAOlJ,aAES,qBAAX8G,QAAyD,qBAAxBA,OAAO9G,aAC7C8G,OAAO9G,aAEXA,aAEX/R,EAAQgS,oBAAsBA,EAC9B,MAAM+G,EAAYA,IAAwB,qBAAXF,OAG/B,SAASI,EAAQ5G,EAAKiB,EAASiG,IAC3B,EAAIhN,EAAM/K,UAAU,mBAAmB6Q,KACvC,MAAM1T,GAAS,EAAI0a,EAAS8B,OAAM,EAAIvL,EAAcK,YAAYoC,EAAKiB,IACrE,OAAO,EAAI3D,EAAY/N,UAAUjD,EAAQ2U,EAC7C,CACA,SAAS4F,IACL,OAAOrJ,EAAYC,QAAQoD,YAAYlT,EAAQ8Y,cACnD,CACA,SAAStP,IACL,IAAI4R,EAAgBlC,IAEpB,OADA,EAAI3M,EAAM/K,UAAU,yBAAyB4Z,KACtCnC,GAAQ,EAAItJ,EAAY/N,UAAUwZ,EAAe7B,GAC5D,CACA,SAASJ,EAAiB9T,GACtB,OAAO,EAAIiU,EAAWvC,iBAAiB1R,EAC3C,CAjBArF,EAAQ+Y,UAAYA,EACpB/Y,EAAQ8Y,cAAgB,E,oCCjJxBvb,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ2V,mBAAqBA,EAC7B,MAAM0F,EAAsBje,EAAQ,MAIpC,SAASuY,IACL,OAAI2F,IACOvJ,aAEJsJ,EAAoBxF,gBAAgBC,aAC/C,CAIA,SAASwF,IAEL,IACI,MAA+B,qBAAjBvJ,YAClB,CACA,MAAOlN,GACH,OAAO,CACX,CACJ,C,mCCvBA,IAAIxH,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACIW,EAAsBhB,MAAQA,KAAKgB,qBAAwBf,OAAOC,OAAU,SAASC,EAAGc,GACxFhB,OAAOc,eAAeZ,EAAG,UAAW,CAAEU,YAAY,EAAMK,MAAOD,GACnE,EAAK,SAASd,EAAGc,GACbd,EAAE,WAAac,CACnB,GACIE,EAAgBnB,MAAQA,KAAKmB,cAAiB,SAAUC,GACxD,GAAIA,GAAOA,EAAIV,WAAY,OAAOU,EAClC,IAAIC,EAAS,CAAC,EACd,GAAW,MAAPD,EAAa,IAAK,IAAIf,KAAKe,EAAe,YAANf,GAAmBJ,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKf,IAAIN,EAAgBsB,EAAQD,EAAKf,GAEtI,OADAW,EAAmBK,EAAQD,GACpBC,CACX,EACI4W,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ+F,kBAAoB/F,EAAQwG,cAAgBxG,EAAQub,MAAQvb,EAAQC,mBAAqBD,EAAQwb,mBAAgB,EACzH,IAAIC,EAAgBre,EAAQ,MAC5BG,OAAOc,eAAe2B,EAAS,gBAAiB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOqd,EAAcD,aAAe,IAC3H,IAAIxV,EAAY5I,EAAQ,MACxBG,OAAOc,eAAe2B,EAAS,qBAAsB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO4H,EAAU/F,kBAAoB,IACjID,EAAQub,MAAQ9c,EAAarB,EAAQ,OACrC,IAAI8I,EAAW9I,EAAQ,MACvBG,OAAOc,eAAe2B,EAAS,gBAAiB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO8H,EAASM,aAAe,IACtH,IAAIkV,EAAsBte,EAAQ,MAClCG,OAAOc,eAAe2B,EAAS,oBAAqB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOsd,EAAoB3V,iBAAmB,IACzIwP,EAAanY,EAAQ,MAAoB4C,GACzCuV,EAAanY,EAAQ,MAAiB4C,E,mCCtCtC,IAAI3C,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,MAAa4C,E,kCCblC,IAAI2b,EAFJpe,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ2b,WAAQ,EAEhB,SAAWA,GACPA,EAAM,WAAa,OACnBA,EAAM,WAAa,IACtB,CAHD,CAGGA,IAAU3b,EAAQ2b,MAAQA,EAAQ,CAAC,G,kCCNtCpe,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,G,oCCAtD,IAAInB,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,MAAc4C,GACnCuV,EAAanY,EAAQ,MAAsB4C,E,kCChB3CzC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,G,oCCAtD,IAAInB,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ2b,WAAQ,EAChBpG,EAAanY,EAAQ,MAAkB4C,GACvCuV,EAAanY,EAAQ,MAAqB4C,GAC1C,IAAI4b,EAAUxe,EAAQ,MACtBG,OAAOc,eAAe2B,EAAS,QAAS,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOwd,EAAQD,KAAO,G,oCCnBrG,IAAIte,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,MAAmB4C,GACxCuV,EAAanY,EAAQ,MAAsB4C,E,kCCd3C,IAAI6b,EAQAC,EAVJve,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ8b,yBAA2B9b,EAAQ6b,+BAA4B,EAEvE,SAAWA,GACPA,EAA0BA,EAA0B,iBAAmB,GAAK,gBAC5EA,EAA0BA,EAA0B,qBAAuB,GAAK,oBAChFA,EAA0BA,EAA0B,sBAAwB,GAAK,qBACjFA,EAA0BA,EAA0B,qBAAuB,KAAO,oBAClFA,EAA0BA,EAA0B,wBAA0B,KAAO,sBACxF,CAND,CAMGA,IAA8B7b,EAAQ6b,0BAA4BA,EAA4B,CAAC,IAElG,SAAWC,GACPA,EAAyBA,EAAyB,iBAAmB,GAAK,gBAC1EA,EAAyBA,EAAyB,wBAA0B,KAAO,sBACtF,CAHD,CAGGA,IAA6B9b,EAAQ8b,yBAA2BA,EAA2B,CAAC,G,oCCd/Fve,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ8b,yBAA2B9b,EAAQ6b,+BAA4B,EACvE,IAAIE,EAAkB3e,EAAQ,MAC9BG,OAAOc,eAAe2B,EAAS,4BAA6B,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO2d,EAAgBF,yBAA2B,IACrJte,OAAOc,eAAe2B,EAAS,2BAA4B,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO2d,EAAgBD,wBAA0B,G,iCCFnJ,IAAIE,EAFJze,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQgc,4BAAyB,EAEjC,SAAWA,GACPA,EAAuBA,EAAuB,iBAAmB,GAAK,gBACtEA,EAAuBA,EAAuB,qBAAuB,GAAK,oBAC1EA,EAAuBA,EAAuB,qBAAuB,KAAO,oBAC5EA,EAAuBA,EAAuB,wBAA0B,KAAO,sBAClF,CALD,CAKGA,IAA2Bhc,EAAQgc,uBAAyBA,EAAyB,CAAC,G,oCCRzFze,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQgc,uBAAyBhc,EAAQic,sBAAwBjc,EAAQkc,kCAA+B,EACxG,IAAIC,EAAkC/e,EAAQ,MAC9CG,OAAOc,eAAe2B,EAAS,+BAAgC,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAO+d,EAAgCD,4BAA8B,IAC3K,IAAIE,EAA2Bhf,EAAQ,KACvCG,OAAOc,eAAe2B,EAAS,wBAAyB,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOge,EAAyBH,qBAAuB,IACtJ,IAAII,EAA4Bjf,EAAQ,KACxCG,OAAOc,eAAe2B,EAAS,yBAA0B,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOie,EAA0BL,sBAAwB,G,kCCLzJ,IAAIE,EAFJ3e,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQkc,kCAA+B,EAEvC,SAAWA,GACPA,EAA6BA,EAA6B,iBAAmB,GAAK,gBAClFA,EAA6BA,EAA6B,qBAAuB,GAAK,oBACtFA,EAA6BA,EAA6B,qBAAuB,KAAO,oBACxFA,EAA6BA,EAA6B,sBAAwB,GAAK,qBACvFA,EAA6BA,EAA6B,wBAA0B,KAAO,sBAC9F,CAND,CAMGA,IAAiClc,EAAQkc,6BAA+BA,EAA+B,CAAC,G,iCCP3G,IAAID,EAFJ1e,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQic,2BAAwB,EAEhC,SAAWA,GACPA,EAAsBA,EAAsB,iBAAmB,GAAK,gBACpEA,EAAsBA,EAAsB,qBAAuB,GAAK,oBACxEA,EAAsBA,EAAsB,qBAAuB,KAAO,oBAC1EA,EAAsBA,EAAsB,sBAAwB,GAAK,qBACzEA,EAAsBA,EAAsB,wBAA0B,KAAO,sBAChF,CAND,CAMGA,IAA0Bjc,EAAQic,sBAAwBA,EAAwB,CAAC,G,kCCTtF1e,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQsc,iBAAmBtc,EAAQuc,sBAAwBvc,EAAQwc,0BAAuB,EAC1Fxc,EAAQwc,qBAAuB,IAC/Bxc,EAAQuc,sBAAwB,+BAChCvc,EAAQsc,iBAAmB,2B,oCCJ3B,IAAIjf,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAAA,gBAAkB,EAElB,IAAIyb,EAAgBre,EAAQ,MAC5BG,OAAOc,eAAe2B,EAAS,UAAW,CAAE7B,YAAY,EAAMC,IAAK,WAAc,OAAOqd,EAAcD,aAAe,IACrHjG,EAAanY,EAAQ,MAAa4C,GAClCuV,EAAanY,EAAQ,MAAgC4C,E,oCCpBrD,IAAI3C,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,MAAa4C,GAClCuV,EAAanY,EAAQ,KAAc4C,E,kCChBnCzC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,G,mCCAtD,IAAInB,EAAmBC,MAAQA,KAAKD,kBAAqBE,OAAOC,OAAU,SAASC,EAAGC,EAAGC,EAAGC,QAC7EC,IAAPD,IAAkBA,EAAKD,GAC3B,IAAIG,EAAOP,OAAOQ,yBAAyBL,EAAGC,GACzCG,KAAS,QAASA,GAAQJ,EAAEM,WAAaF,EAAKG,UAAYH,EAAKI,gBAClEJ,EAAO,CAAEK,YAAY,EAAMC,IAAK,WAAa,OAAOV,EAAEC,EAAI,IAE5DJ,OAAOc,eAAeZ,EAAGG,EAAIE,EACjC,EAAM,SAASL,EAAGC,EAAGC,EAAGC,QACTC,IAAPD,IAAkBA,EAAKD,GAC3BF,EAAEG,GAAMF,EAAEC,EACd,GACI4X,EAAgBjY,MAAQA,KAAKiY,cAAiB,SAAS7X,EAAGsC,GAC1D,IAAK,IAAIwV,KAAK9X,EAAa,YAAN8X,GAAoBjY,OAAOqB,UAAUC,eAAeC,KAAKkB,EAASwV,IAAInY,EAAgB2C,EAAStC,EAAG8X,EAC3H,EACAjY,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtD+W,EAAanY,EAAQ,MAAc4C,GACnCuV,EAAanY,EAAQ,MAAuB4C,E,kCChB5CzC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,G,kCCAtDjB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,G,oCCAtDjB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQyc,yBAAsB,EAC9B,MAAMC,EAAatf,EAAQ,KACrBuf,EAAavf,EAAQ,MACrBwf,EAA0B,CAC5B,CAACF,EAAWb,0BAA0BgB,eAAgBF,EAAW/H,aACjE,CAAC8H,EAAWb,0BAA0BiB,oBAAqBH,EAAWhI,kBAE1E,MAAMoI,EACFC,UAAAA,CAAWzZ,GACP,IAAI0Z,EAAmBN,EAAW/H,aAIlC,OAHIrR,EAAMgI,QAAQqR,IACdK,EAAmBL,EAAwBrZ,EAAMgI,OAASoR,EAAW/H,cAElE,IAAIqI,EAAiB1Z,EAAM2B,QACtC,EAEJlF,EAAQyc,oBAAsB,IAAIM,C,kCCjBlCxf,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQkd,eAAY,EACpB,MAAMA,EACFC,OAAAA,CAAQvP,GACJ,MAAO,UAAWA,CACtB,EAEJ5N,EAAQkd,UAAYA,C,oCCPpB3f,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQod,2BAAwB,EAChC,MAAMV,EAAatf,EAAQ,KACrBigB,EAAejgB,EAAQ,MACvBuf,EAAavf,EAAQ,MACrBkgB,EAAwB,CAC1B,CAACZ,EAAWR,6BAA6BW,eAAgBF,EAAW/H,aACpE,CAAC8H,EAAWR,6BAA6BY,oBAAqBH,EAAWhI,kBAE7E,MAAM4I,UAA8BF,EAAaH,UAC7CM,mBAAAA,CAAoBlQ,GAChB,MAAO,CACHjD,OAAQ,sBACRrF,OAAQsI,EAEhB,CACAmQ,kBAAAA,CAAmB7P,GACf,IAAIqP,EAAmBN,EAAW/H,aAIlC,MAHIhH,EAASrK,MAAMgI,QAAQ+R,IACvBL,EAAmBK,EAAsB1P,EAASrK,MAAMgI,OAASoR,EAAW/H,cAE1E,IAAIqI,EAAiBrP,EAASrK,MAAM2B,QAC9C,CACAwY,sBAAAA,CAAuBC,GACnB,MAAO,CACHC,IAAKD,EAAYhf,OAAOiD,WAEhC,EAEJ5B,EAAQod,sBAAwB,IAAIG,C,mCC7BpC,IAAIxe,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ6d,6BAA0B,EAClC,MAAM/I,EAAsB1X,EAAQ,MACpC,MAAMygB,EACFpd,WAAAA,CAAYuV,GACR1Y,KAAK0Y,QAAUA,EACf1Y,KAAKwgB,SAAW,2CACpB,CACAC,eAAAA,CAAgBC,GACZ,OAAOjf,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAK0Y,QAAQrD,QAAQrV,KAAKwgB,SAAUrQ,KAAKC,UAAUsQ,GAC9D,GACJ,CACAC,gBAAAA,GACI,OAAOlf,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,OAAOA,KAAK0Y,QAAQJ,WAAWtY,KAAKwgB,SACxC,GACJ,CACAI,aAAAA,GACI,OAAOnf,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM6gB,QAAe7gB,KAAK0Y,QAAQvO,QAAQnK,KAAKwgB,UAC/C,IAAKK,EACD,OAAO,KAEX,IAAIH,EAEJ,OADAA,EAAavQ,KAAK2K,MAAM+F,GACjBH,CACX,GACJ,CACAI,iBAAAA,GACI,OAAOrf,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM0gB,QAAmB1gB,KAAK4gB,gBAC9B,IAAKF,EACD,MAAM,IAAIlJ,EAAoBD,gBAAgB,iEAElD,OAAOmJ,CACX,GACJ,CACAK,sBAAAA,CAAuBpc,GACnB,OAAOlD,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM0gB,QAAmB1gB,KAAK4gB,gBAC9B,GAAIF,GAAe,iBAAkBA,EAEjC,OADAA,EAAWM,kBAAoBrc,EACxB3E,KAAKygB,gBAAgBC,EAEpC,GACJ,CACAO,oBAAAA,GACI,OAAOxf,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAM0gB,QAAmB1gB,KAAK4gB,gBAC9B,GAAIF,GAAc,sBAAuBA,EACrC,OAAOA,EAAWM,iBAG1B,GACJ,EAEJte,EAAQ6d,wBAA0BA,C,oCCnErBzgB,EAAA,MACb,IAAI2B,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwe,oBAAiB,EACzB,MAAMC,EAAsBrhB,EAAQ,MAC9BshB,EAA8BthB,EAAQ,KACtCuhB,EAAQvhB,EAAQ,MAChBmP,EAAQnP,EAAQ,MAChBse,EAAsBte,EAAQ,MAC9BwhB,EAAYxhB,EAAQ,MACpByhB,EAAWzhB,EAAQ,MACnB4Z,EAAW5Z,EAAQ,MACnBsf,EAAatf,EAAQ,MAC3B,MAAMohB,EACF/d,WAAAA,CAAYuV,GACR1Y,KAAK0Y,QAAUA,EACf1Y,KAAKwhB,KAAO,OACZxhB,KAAKyhB,UAAY,GACjBzhB,KAAK0hB,eAAiB,IAAItD,EAAoB3V,kBAC9CzI,KAAK2hB,uBAAyB,CAAE,cAAiBL,EAAUrC,uBAC3Djf,KAAK4hB,OAAS,IAAIL,EAASxS,OAAO/O,KAAK0hB,gBACvC1hB,KAAK6hB,kBAAmB,EACxB7hB,KAAK8hB,kBAAoB,IAAIV,EAA4Bb,wBAAwB7H,EACrF,CACA,kBAAOqJ,CAAYrJ,GACf,OAAOjX,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAMgiB,EAA0B,IAAIZ,EAA4Bb,wBAAwB7H,GAClFgI,QAAmBsB,EAAwBlB,oBACjD,IAAI,EAAIK,EAAoBc,yBAAyBvB,GACjD,OAAO,KAEX,MAAMwB,EAAW,IAAIhB,EAAexI,GAEpC,OADAwJ,EAASL,iBAAmBnB,EAAWmB,iBAChCK,CACX,GACJ,CACAtb,OAAAA,CAAQgB,EAASiS,EAAUgI,GACvB,OAAOpgB,EAAUzB,UAAM,OAAQ,GAAQ,aACnC,EAAIiP,EAAM/K,UAAU,0BAA2B0D,IAC/C,EAAIqH,EAAM/K,UAAU,2BAA4B2V,IAChD,EAAI5K,EAAM/K,UAAU,mCAAoC2d,GACxD,IACI,MAAMM,EAAcniB,KAAK0hB,eAAezV,iBAClC4D,QAAkB7P,KAAK4hB,OAAOhS,eACpC5P,KAAK6hB,iBAAmBA,EACxB,MAAMO,EAAiB,CACnBC,YAAaC,OAAOhB,EAAUpC,sBAC9BhU,MAAOiX,EAAY/V,UACnBC,SAAU8V,EAAY9V,SACtBwD,UAAWA,EACX0S,SAAU3a,EAAQ4a,SAClBC,SAAU7a,EAAQ8a,MAClB7I,SAAuB,OAAbA,QAAkC,IAAbA,EAAsBA,EAAW,SAEpE,EAAI5K,EAAM/K,UAAU,iCAAkCke,GACtD,MAAMO,EAAoBxS,KAAKC,UAAUgS,IACzC,EAAInT,EAAM/K,UAAU,oCAAqCye,GACzD,MAAMC,EAAgBlJ,EAASK,OAAOC,KAAK2I,GAAmBre,SAAS,WACvE,EAAI2K,EAAM/K,UAAU,gCAAiC0e,GACrD,MAAMtH,EAAc,GAAGgG,EAAUtC,0BAA0B4D,KAC3D,EAAI3T,EAAM/K,UAAU,8BAA+BoX,GACnD,MAAMuH,EAAoB9F,mBAAmBzB,GACvCwH,EAAgBxB,EAAUrC,uBAChC,EAAIhQ,EAAM/K,UAAU,gCAAiC4e,GACrD,MAAMC,EAAU,GAAGD,cAA0BD,IAoB7C,OAnBA,EAAI5T,EAAM/K,UAAU,0BAA2B6e,GAC/C/iB,KAAK8hB,kBACArB,gBAAgB,CACjBe,KAAM,OACNwB,iBAAkBhjB,KAAK2hB,uBACvBvV,UAAW+V,EAAY/V,UACvByV,iBAAkBA,IAEjBrf,MAAK,IAAMf,EAAUzB,UAAM,OAAQ,GAAQ,YAC5C,IAAIuH,EAAI4G,EACiB,OAArB0T,IAAkD,IAArBA,KAC7B,EAAIR,EAAMhG,6BAA6B0H,IACvC,EAAI9T,EAAM/K,UAAU,kBAAgB6e,IAEjB,QAAtBxb,EAAKvH,KAAK4hB,cAA2B,IAAPra,GAAyBA,EAAGuI,sBAAsBD,EAAW7P,KAAKijB,gBAAgBvd,KAAK1F,OAE/F,QAAtBmO,EAAKnO,KAAK4hB,cAA2B,IAAPzT,GAAyBA,EAAGqB,sBAAsBxP,KAAKqP,mBAAmB3J,KAAK1F,aACxGA,KAAK0hB,eAAe9a,SAC9B,MACOmc,CACX,CACA,MAAO9c,GAEH,MADAiU,QAAQjU,MAAM,oBAAqBA,GAC7B,IAAImZ,EAAW7H,gBAAgB,gBACzC,CACJ,GACJ,CACA2L,MAAAA,CAAOpb,GAEH,OADA9H,KAAKyhB,UAAU/R,KAAK5H,GACb,IAAO9H,KAAKyhB,UAAYzhB,KAAKyhB,UAAU0B,QAAOnb,GAAYA,IAAaF,GAClF,CACAuH,kBAAAA,GACI,OAAO5N,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAMojB,EAAoB,CACtB3e,MAAO,aACPoL,UAAWyS,OAAO,GAClB1d,QAAS,CAAC,GAEd5E,KAAKyhB,UAAUjR,SAAQxI,GAAYA,EAASob,WACtCpjB,KAAKqjB,iBACf,GACJ,CACAJ,eAAAA,CAAgB3S,GACZ,OAAO7O,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,MAAMsjB,EAAgBhT,EAGtB,IAFA,EAAIrB,EAAM/K,UAAU,2BAA4Bof,QAEhB/iB,IAA5B+iB,EAAczT,UAAyB,CACvC,MAAM0T,QAAevjB,KAAK8hB,kBAAkBb,uBAC5C,QAAe1gB,IAAXgjB,GAAwBjB,OAAOgB,EAAczT,YAAc0T,EAE3D,YADA,EAAItU,EAAMmL,UAAU,uBAAuBkJ,EAAczT,iEAAiE0T,MAGlI,CAEA,MAAM9B,EAAYzhB,KAAKyhB,UACvB,GAA6B,YAAzB6B,EAAcvW,OAAsB,CACpC,MAAMyW,EAAcF,EAAc1e,QAAQ6e,UAAUC,MAAK1O,GAAsB,aAAdA,EAAK+C,OAChE4L,EAAcL,EAAc1e,QAAQ6e,UAAUC,MAAK1O,GAAsB,cAAdA,EAAK+C,OAChE6L,EAAaN,EAAc1e,QAAQif,OACnCC,EAAgB,CAClBC,SAAUH,EAAWG,SACrBC,QAASJ,EAAWI,QACpBC,WAAYL,EAAWK,WACvBC,mBAAoBN,EAAWM,mBAC/BC,SAAUP,EAAWO,SAASC,KAE5BC,EAAU,GACZb,GACAa,EAAQ3U,KAAK8T,GAEbG,GACAU,EAAQ3U,KAAKiU,GAEjB,MAAMW,QAAmBtkB,KAAK8hB,kBAAkBlB,gBAC1C2D,EAAiB,CACnB/C,KAAM,OACNR,kBAAmBsB,OAAOgB,EAAczT,WACxC2U,aAAc,CACV/f,MAAO,UACPG,QAAS,CACL8d,MAAO2B,EACPI,OAAQX,IAGhBd,iBAAkBhjB,KAAK2hB,uBACvBvV,UAA0B,OAAfkY,QAAsC,IAAfA,OAAwB,EAASA,EAAWlY,UAC9EyV,iBAAiC,OAAfyC,QAAsC,IAAfA,OAAwB,EAASA,EAAWzC,mBAEzF,EAAI5S,EAAM/K,UAAU,4CAA0CqgB,SACxDvkB,KAAK8hB,kBAAkBrB,gBAAgB8D,GAC7C,MAAMG,EAAiB,CACnBjgB,MAAO,UACPoL,UAAWyS,OAAOgB,EAAczT,WAChCjL,QAAS2f,EAAeC,aAAa5f,UAEzC,EAAIqK,EAAM/K,UAAU,qCAAmCwgB,GACvDjD,EAAUjR,SAAQxI,GAAYA,EAAS0c,IAC3C,MACK,GAA6B,kBAAzBpB,EAAcvW,OAA4B,OACzC/M,KAAK8hB,kBAAkBf,uBAAuBuB,OAAOgB,EAAczT,YACzE,MAAM8U,EAAe,CACjBlgB,MAAO,gBACPoL,UAAWyS,OAAOgB,EAAczT,WAChCjL,QAAS0e,EAAc1e,SAE3B6c,EAAUjR,SAAQxI,GAAYA,EAAS2c,IAC3C,CACJ,GACJ,CACAtB,eAAAA,GACI,OAAO5hB,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EAAI4G,GACR,EAAIc,EAAM/K,UAAU,oBACpBlE,KAAKyhB,UAAY,GACM,QAAtBla,EAAKvH,KAAK4hB,cAA2B,IAAPra,GAAyBA,EAAGR,mBACrB,QAA9BoH,EAAKnO,KAAK0hB,sBAAmC,IAAPvT,OAAgB,EAASA,EAAGpH,mBACpE/G,KAAK8hB,kBAAkBnB,kBACjC,GACJ,CACAiE,iBAAAA,GACI,OAAOnjB,EAAUzB,UAAM,OAAQ,GAAQ,aACnC,EAAIiP,EAAM/K,UAAU,8BACpB,MAAM2gB,QAAyB7kB,KAAK8hB,kBAAkBhB,oBACtD,GAAK+D,KAGD,EAAI1D,EAAoBc,yBAAyB4C,GAGrD,GAAIA,EAAiBzY,UACjB,IACI,MAAMsY,EAAiB,CACnBjgB,MAAO,UACPoL,UAAWyS,OAAO,GAClB1d,QAASigB,EAAiBL,aAAa5f,SAE3C5E,KAAKyhB,UAAUjR,SAAQxI,GAAYA,EAAS0c,KAC5C,MAAMtY,EAAYyY,EAAiBzY,WAEnC,EAAI6C,EAAM/K,UAAU,oDAAoDkI,WAClEpM,KAAK0hB,eAAe1V,eAAeI,EAC7C,CACA,MAAO/J,SAEGrC,KAAKqjB,iBACf,YAIMrjB,KAAKqjB,iBAEnB,GACJ,CACAyB,aAAAA,GACI,GAAI9kB,KAAK6hB,iBAAkB,CACvB,MAAMkB,EAAU,GAAGzB,EAAUrC,kCAAkClC,mBAAmBuE,EAAUtC,qBAC5F,EAAIqC,EAAMhG,6BAA6B0H,EAC3C,CACJ,CACAhc,UAAAA,GACI,OAAOtF,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,OAAO,IAAIgC,SAASD,GAAYN,EAAUzB,UAAM,OAAQ,GAAQ,YAC5D,IAAI+kB,GAAS,EACb,MAAMC,EAAgBA,KACbD,IACDA,GAAS,EACTtf,YAAW,KACPzF,KAAKqjB,kBAAkB7gB,KAAKT,EAAQ,GACrC,KACP,EAEJ,UACU/B,KAAKilB,YAAY,CAAElY,OAAQ,aAAcrF,OAAQ,IAAM,CAAEsd,cAAeA,EAAejM,SAAU,GAC3G,CACA,MAAO1W,IACH,EAAI4M,EAAM/K,UAAU,oBAAqB7B,GACpC0iB,GACD/kB,KAAKqjB,kBAAkB7gB,KAAKT,EAEpC,CAAC,QAEGijB,GACJ,CACJ,KACJ,GACJ,CACAC,WAAAA,CAAYjV,EAAS8I,GAEjB,OADA,EAAI7J,EAAM/K,UAAU,gCACb,IAAIlC,SAAQ,CAACD,EAASE,IAAWR,EAAUzB,UAAM,OAAQ,GAAQ,YACpE,IAAIuH,EAAI4G,QACsB,QAAtB5G,EAAKvH,KAAK4hB,cAA2B,IAAPra,OAAgB,EAASA,EAAG/B,KAAKwK,GAAS,SAAUM,GACtFvO,EAAQuO,EACZ,GAAG,CAAEyI,SAAsB,OAAZD,QAAgC,IAAZA,OAAqB,EAASA,EAAQC,WACU,QAAlF5K,EAAiB,OAAZ2K,QAAgC,IAAZA,OAAqB,EAASA,EAAQkM,qBAAkC,IAAP7W,GAAyBA,EAAG3M,KAAKsX,EAChI,KACJ,EAEJpW,EAAQwe,eAAiBA,C,kCC5QzB,SAASe,EAAwBvB,GAC7B,QAAS,iBAAkBA,EAC/B,CAJAzgB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQuf,wBAA0BA,C,oCCFrBniB,EAAA,MACb,IAAI2B,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACI8iB,EAAUllB,MAAQA,KAAKklB,QAAW,SAAUC,EAAG9iB,GAC/C,IAAI+iB,EAAI,CAAC,EACT,IAAK,IAAIlN,KAAKiN,EAAOllB,OAAOqB,UAAUC,eAAeC,KAAK2jB,EAAGjN,IAAM7V,EAAEgjB,QAAQnN,GAAK,IAC9EkN,EAAElN,GAAKiN,EAAEjN,IACb,GAAS,MAALiN,GAAqD,oBAAjCllB,OAAOqlB,sBACtB,KAAI/W,EAAI,EAAb,IAAgB2J,EAAIjY,OAAOqlB,sBAAsBH,GAAI5W,EAAI2J,EAAElN,OAAQuD,IAC3DlM,EAAEgjB,QAAQnN,EAAE3J,IAAM,GAAKtO,OAAOqB,UAAUikB,qBAAqB/jB,KAAK2jB,EAAGjN,EAAE3J,MACvE6W,EAAElN,EAAE3J,IAAM4W,EAAEjN,EAAE3J,IAF4B,CAItD,OAAO6W,CACX,EACAnlB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQwb,mBAAgB,EACxB,MAAMkB,EAAatf,EAAQ,KACrB0lB,EAAoB1lB,EAAQ,MAC5B2lB,EAAoB3lB,EAAQ,MAC5B4lB,EAAoB5lB,EAAQ,MAC5B6lB,EAAwB7lB,EAAQ,MAChC8lB,EAA4B9lB,EAAQ,MACpCwhB,EAAYxhB,EAAQ,MACpBshB,EAA8BthB,EAAQ,KACtC+lB,EAA0B/lB,EAAQ,MAClCmP,EAAQnP,EAAQ,MAChB0X,EAAsB1X,EAAQ,MAC9Buf,EAAavf,EAAQ,MAE3B,MAAMoe,EACF/a,WAAAA,CAAY2V,GAMR,GALA9Y,KAAK8lB,QAAU,KACf9lB,KAAKkiB,SAAW,KAChBliB,KAAK+lB,0BAA4B,GACjC/lB,KAAKgmB,+BAAiC,GACtChmB,KAAK0Y,QAAU,IAAI+M,EAAkBtN,iBACnB,OAAZW,QAAgC,IAAZA,OAAqB,EAASA,EAAQmN,UAC5D,MAAM,IAAIzO,EAAoBD,gBAAgB,iCAElDvX,KAAKkmB,aAAe,CAChBD,SAAUnN,EAAQmN,UAGtBjmB,KAAKmmB,QAAU,IAAIR,EAAsBS,kBAAkB,CACvDlH,qBAAsBoC,EAAUpC,uBAEpClf,KAAKgiB,wBAA0B,IAAIZ,EAA4Bb,wBAAwBvgB,KAAK0Y,QAChG,CAIA,aAAI9U,GACA,OAAwB,OAAjB5D,KAAK8lB,OAChB,CAIA,WAAIO,GACA,IAAI9e,EACJ,OAAgC,QAAvBA,EAAKvH,KAAK8lB,eAA4B,IAAPve,OAAgB,EAASA,EAAG8e,UAAY,IACpF,CAIA,UAAIxC,GACA,OAAO7jB,KAAK8lB,OAChB,CACA,UAAIjC,CAAO3iB,GACPlB,KAAK8lB,QAAU5kB,EACflB,KAAK+lB,0BAA0BvV,SAAQ1I,GAAYA,EAAS9H,KAAK8lB,UACrE,CACAlf,OAAAA,CAAQoJ,GACJ,OAAOvO,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EAEJ,IADA,EAAI0H,EAAM/K,UAAU,0BAAwB8L,GACxChQ,KAAK4D,UACL,MAAM,IAAIyb,EAAWjI,4BAMzB,OAJyB,QAAxB7P,EAAKvH,KAAKkiB,gBAA6B,IAAP3a,GAAyBA,EAAG8b,kBAC7DrjB,KAAKkiB,SAAW,IAAIsD,EAAkBtE,eAAelhB,KAAK0Y,SAC1D1Y,KAAKkiB,SAASgB,OAAOljB,KAAKsmB,qBAAqB5gB,KAAK1F,OACpDA,KAAKmmB,QAAQI,yBACNvmB,KAAKkiB,SAAStb,QAAQ5G,KAAKwmB,qBAAqBxW,GAAsB,OAAZA,QAAgC,IAAZA,OAAqB,EAASA,EAAQ6J,SAAsB,OAAZ7J,QAAgC,IAAZA,OAAqB,EAASA,EAAQ6R,iBACnM,GACJ,CACAyE,oBAAAA,CAAqBjkB,GACjB,OAAQA,EAAEoC,OACN,IAAK,UACDzE,KAAKymB,kBAAkBpkB,EAAEuC,SACzB,MACJ,IAAK,gBACD5E,KAAK0mB,qBAAqBrkB,EAAEuC,SAC5B,MACJ,IAAK,aACD5E,KAAK2mB,qBAAqB,UAEtC,CACAF,iBAAAA,CAAkBjC,GACd,MAAMoC,EAAiBpC,EAAa9B,MAAMgB,MAAK1O,GAAsB,aAAdA,EAAK+C,OACtD8O,EAAerC,EAAa9B,MAAMgB,MAAK1O,GAAsB,cAAdA,EAAK+C,OAC1D,IAAK6O,EACD,MAAM,IAAIpP,EAAoBD,gBAAgB,0CAElD,MAAMsM,EAAS,CACXY,OAAQD,EAAaC,OACrBvC,SAAUliB,KAAKkiB,SAASV,KACxB6E,QAAS,CACLS,QAASF,EAAeE,QACxBC,MAAOH,EAAeI,QACtBC,gBAAiBL,EAAeK,gBAChCzc,UAAWoc,EAAepc,YAG9Bqc,IACAhD,EAAOqD,aAAe,CAClBC,SAAUN,IAGlB7mB,KAAK6jB,OAASA,GACd,EAAI5U,EAAM/K,UAAU,4CAA0C2f,GAC9D7jB,KAAKmmB,QAAQiB,yBAAyBvD,EAC1C,CACA6C,oBAAAA,CAAqBW,GACjB,IAAI9f,EACJ,MAAMtB,EAAQ4f,EAAwB1G,oBAAoBO,WAAW2H,GACrErnB,KAAKgmB,+BAA+BxV,SAAQ8W,GAAiBA,EAAcrhB,MAC3E,EAAIgJ,EAAM/K,UAAU+B,GACpBjG,KAAKmmB,QAAQoB,qBAA0D,QAApChgB,EAAK8f,EAAkBzf,eAA4B,IAAPL,EAAgBA,EAAK,GAAI8f,EAAkBpZ,KAC9H,CACA0Y,oBAAAA,CAAqBa,GACjBxnB,KAAKmmB,QAAQsB,mBAAmBznB,KAAK6jB,OAAQ2D,GAC7CxnB,KAAK6jB,OAAS,IAClB,CACA9c,UAAAA,GACI,OAAOtF,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EACJ,IAAKvH,KAAK4D,UACN,MAAM,IAAIyb,EAAWnI,wBAEzBlX,KAAK2mB,qBAAqB,cACM,QAAxBpf,EAAKvH,KAAKkiB,gBAA6B,IAAP3a,OAAgB,EAASA,EAAGR,YACxE,GACJ,CACA2gB,cAAAA,CAAe5f,EAAUwf,GAKrB,OAJAtnB,KAAK+lB,0BAA0BrW,KAAK5H,GAChCwf,GACAtnB,KAAKgmB,+BAA+BtW,KAAK4X,GAEtC,KACHtnB,KAAK+lB,0BAA4B/lB,KAAK+lB,0BAA0B5C,QAAOnO,GAAQA,IAASlN,IACpFwf,IACAtnB,KAAKgmB,+BAAiChmB,KAAKgmB,+BAA+B7C,QAAOnO,GAAQA,IAASsS,IACtG,CAER,CACA1C,iBAAAA,GACI,OAAOnjB,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EACJvH,KAAKmmB,QAAQwB,kCACb,IAAIzF,EAAW,KACf,IACIA,QAAiBsD,EAAkBtE,eAAea,YAAY/hB,KAAK0Y,QACvE,CACA,MAAOvK,GAKH,OAJAnO,KAAKmmB,QAAQyB,8BAA8B,kCACrC5nB,KAAKgiB,wBAAwBrB,mBACtB,OAAbuB,QAAkC,IAAbA,GAA+BA,EAASmB,uBAC7DnB,EAAW,KAEf,CACA,IAAKA,EAGD,OAFA,EAAIjT,EAAMmL,UAAU,iCACpBpa,KAAKmmB,QAAQyB,8BAA8B,4BAGtB,QAAxBrgB,EAAKvH,KAAKkiB,gBAA6B,IAAP3a,GAAyBA,EAAG8b,kBAC7DrjB,KAAKkiB,SAAWA,EAChBA,EAASgB,OAAOljB,KAAKsmB,qBAAqB5gB,KAAK1F,aACzCA,KAAKkiB,SAAS0C,oBAChB5kB,KAAK4D,UACL5D,KAAKmmB,QAAQ0B,kCAAkC7nB,KAAK6jB,QAGpD7jB,KAAKmmB,QAAQyB,8BAA8B,8BAEnD,GACJ,CACAE,eAAAA,CAAgBC,EAAajP,GACzB,OAAOrX,EAAUzB,UAAM,OAAQ,GAAQ,YACnCA,KAAKgoB,mBACL,EAAItC,EAAkBuC,6BAA6BjoB,KAAK6jB,OAAOY,OAAON,SAAU,CAC5E+D,uBAAwBH,EAAYI,SAASnd,SAEjDhL,KAAKmmB,QAAQiC,iCAAiCpoB,KAAK6jB,OAAQkE,IAC3D,EAAI9Y,EAAM/K,UAAU,0BACpB,MAAM,WAAEmkB,GAAeN,EAAaO,EAAKpD,EAAO6C,EAAa,CAAC,eACxD/N,EAAO+N,EAAY/N,MAAQha,KAAKqmB,QAAQS,QACxCE,EAAUe,EAAYf,SAAWhnB,KAAKqmB,QAAQU,MACpD,GAAIC,GAAW5H,EAAWf,MAAMkK,QAC5B,MAAM,IAAI/Q,EAAoBD,gBAAgB,yBAElD,EAAItI,EAAM/K,UAAU,uCACpB,MAAMoM,QAAiBtQ,KAAKkiB,SAAS+C,YAAYW,EAA0B9F,sBAAsBI,oBAAoBjgB,OAAOoQ,OAAOpQ,OAAOoQ,OAAO,CAAC,EAAGiY,GAAK,CAAEE,YAAaH,EAAYrO,OACjLgN,aAAa,CACbhC,cAAeA,KACX,IAAIzd,EAAI4G,EAC2E,QAAlF5G,EAAiB,OAAZuR,QAAgC,IAAZA,OAAqB,EAASA,EAAQkM,qBAAkC,IAAPzd,GAAyBA,EAAG/F,KAAKsX,GACnG,QAAxB3K,EAAKnO,KAAKkiB,gBAA6B,IAAP/T,GAAyBA,EAAG2W,eAAe,IAGpF,GAAIc,EAA0B9F,sBAAsBD,QAAQvP,GAExD,OADAtQ,KAAKmmB,QAAQsC,8BAA8BzoB,KAAK6jB,OAAQkE,EAAazX,EAASrK,MAAM2B,QAAS0I,EAASrK,MAAMgI,MACrG2X,EAA0B9F,sBAAsBK,mBAAmB7P,GAE9E,MAAMjP,EAASukB,EAA0B9F,sBAAsBM,uBAAuB9P,GAEtF,OADAtQ,KAAKmmB,QAAQuC,uBAAuB1oB,KAAK6jB,OAAQkE,EAAa1mB,GACvDA,CACX,GACJ,CACA2mB,eAAAA,GACI,IAAKhoB,KAAK4D,UACN,MAAM,IAAIyb,EAAWnI,uBAE7B,CACAsP,oBAAAA,CAAqBxW,GACjB,MAAM0S,EAAQ,CACV,CACI3K,KAAM,aASd,OANgB,OAAZ/H,QAAgC,IAAZA,OAAqB,EAASA,EAAQmX,WAC1DzE,EAAMhT,KAAK,CACPqI,KAAM,YACNnT,QAASoL,EAAQmX,WAGlB,CACH3E,SAAUxiB,KAAKkmB,aAAaD,SAC5BvD,MAAOA,EAEf,EAEJhgB,EAAQwb,cAAgBA,C,kCCxPxB,IAAIzc,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQimB,4BAAyB,EAIjC,MAAMA,EACFxlB,WAAAA,GAKInD,KAAKub,OAASA,MAClB,CAOAqN,aAAAA,CAAcC,EAAWC,GACrB,OAAOrnB,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EACJ,MAAM9C,EAAQ,IAAIskB,YAAYF,EAAW,CAAEG,OAAQF,IAC5B,QAAtBvhB,EAAKvH,KAAKub,cAA2B,IAAPhU,GAAyBA,EAAGqhB,cAAcnkB,EAC7E,GACJ,CAQAqC,gBAAAA,CAAiB+hB,EAAW7gB,EAAU8Q,GAClC,OAAOrX,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,IAAIuH,EAEJ,OADuB,QAAtBA,EAAKvH,KAAKub,cAA2B,IAAPhU,GAAyBA,EAAGT,iBAAiB+hB,EAAW7gB,EAAU8Q,GAC1F,KACH,IAAIvR,EACJ,OAA8B,QAAtBA,EAAKvH,KAAKub,cAA2B,IAAPhU,OAAgB,EAASA,EAAGV,oBAAoBgiB,EAAW7gB,EAAS,CAElH,GACJ,EAEJtF,EAAQimB,uBAAyBA,C,oCCrDjC,IAAIlnB,EAAazB,MAAQA,KAAKyB,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMZ,GAAS,OAAOA,aAAiBU,EAAIV,EAAQ,IAAIU,GAAE,SAAUG,GAAWA,EAAQb,EAAQ,GAAI,CAC3G,OAAO,IAAKU,IAAMA,EAAII,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUhB,GAAS,IAAMiB,EAAKN,EAAUO,KAAKlB,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC1F,SAASC,EAASpB,GAAS,IAAMiB,EAAKN,EAAU,SAASX,GAAS,CAAE,MAAOmB,GAAKJ,EAAOI,EAAI,CAAE,CAC7F,SAASF,EAAKd,GAAUA,EAAOkB,KAAOR,EAAQV,EAAOH,OAASY,EAAMT,EAAOH,OAAOsB,KAAKN,EAAWI,EAAW,CAC7GH,GAAMN,EAAYA,EAAUY,MAAMf,EAASC,GAAc,KAAKS,OAClE,GACJ,EACAnC,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ0jB,uBAAoB,EAC5B,MAAM6C,EAAUnpB,EAAQ,MAClBopB,EAA6BppB,EAAQ,MAyB3C,MAAMsmB,EAIF,WAAI+C,GACA,OAAO,EAAIF,EAAQG,mBAAmB,CAClCC,oBAAqBrpB,KAAKkf,sBAElC,CACA/b,WAAAA,CAAY2V,GAKR9Y,KAAKspB,YAAc,eACnBtpB,KAAKupB,gBAAkB,IAAIL,EAA2BP,uBACtD3oB,KAAKkf,qBAAuBpG,EAAQoG,qBACpClf,KAAKwpB,OAAOC,OAChB,CAIAD,IAAAA,GACI,OAAO/nB,EAAUzB,UAAM,OAAQ,GAAQ,YACnC,UACUA,KAAK0pB,0BACf,CACA,MAAOrnB,GAAK,CAChB,GACJ,CAKAqnB,wBAAAA,GACI,OAAOjoB,EAAUzB,UAAM,OAAQ,GAAQ,kBAC7BA,KAAKupB,gBAAgBziB,iBAAiB,+BAA+B,IAAMrF,EAAUzB,UAAM,OAAQ,GAAQ,kBACvGA,KAAKupB,gBAAgBX,cAAc,gCAAgC,EAAIK,EAAQU,4BAA4B3pB,KAAKkf,sBAC1H,KACJ,GACJ,CAMA0K,uBAAAA,CAAwBd,GACpB,IACI9oB,KAAKupB,gBACAX,cAAc,GAAG5oB,KAAKspB,cAAcR,EAAatH,OAAQsH,GACzDW,OACT,CACA,MAAOpnB,GAAK,CAChB,CAKAkkB,sBAAAA,IAA0BtM,GACtB,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQY,8BAA8B7pB,KAAKmpB,WAAYlP,GACzEja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKA+kB,wBAAAA,IAA4BnN,GACxB,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQa,gCAAgC9pB,KAAKmpB,WAAYlP,GAC3Eja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAklB,oBAAAA,IAAwBtN,GACpB,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQc,4BAA4B/pB,KAAKmpB,WAAYlP,GACvEja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAslB,+BAAAA,IAAmC1N,GAC/B,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQe,uCAAuChqB,KAAKmpB,WAAYlP,GAClFja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAwlB,iCAAAA,IAAqC5N,GACjC,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQgB,yCAAyCjqB,KAAKmpB,WAAYlP,GACpFja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAulB,6BAAAA,IAAiC3N,GAC7B,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQiB,qCAAqClqB,KAAKmpB,WAAYlP,GAChFja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAolB,kBAAAA,IAAsBxN,GAClB,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQkB,0BAA0BnqB,KAAKmpB,WAAYlP,GACrEja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKA+lB,gCAAAA,IAAoCnO,GAChC,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQmB,wCAAwCpqB,KAAKmpB,WAAYlP,GACnFja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAqmB,sBAAAA,IAA0BzO,GACtB,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQoB,8BAA8BrqB,KAAKmpB,WAAYlP,GACzEja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,CAKAomB,6BAAAA,IAAiCxO,GAC7B,IACI,MAAMxV,GAAQ,EAAIwkB,EAAQqB,qCAAqCtqB,KAAKmpB,WAAYlP,GAChFja,KAAK4pB,wBAAwBnlB,EACjC,CACA,MAAOpC,GAAK,CAChB,EAEJK,EAAQ0jB,kBAAoBA,C,kCC1M5BnmB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQ6nB,mCAAqC7nB,EAAQ8nB,2BAA6B9nB,EAAQ+nB,uCAAyC/nB,EAAQgoB,sBAAwBhoB,EAAQioB,mCAAqCjoB,EAAQkoB,uCAAyCloB,EAAQmoB,qCAAuCnoB,EAAQooB,yBAA2BpoB,EAAQqoB,6BAA+BroB,EAAQsoB,gCAA6B,EAC/ZtoB,EAAQsoB,2BAA6B,iCACrCtoB,EAAQqoB,6BAA+B,mCACvCroB,EAAQooB,yBAA2B,+BACnCpoB,EAAQmoB,qCAAuC,2CAC/CnoB,EAAQkoB,uCAAyC,6CACjDloB,EAAQioB,mCAAqC,yCAC7CjoB,EAAQgoB,sBAAwB,4BAChChoB,EAAQ+nB,uCAAyC,6CACjD/nB,EAAQ8nB,2BAA6B,iCACrC9nB,EAAQ6nB,mCAAqC,wC,kCCM7C,SAASU,IACL,MAAO,CACHzJ,KAAM,kBAEd,CAKA,SAASmI,EAA2BR,GAChC,MAAO,CACH3H,KAAM,mBACN2H,QAASA,EAEjB,CAKA,SAASC,EAAkBD,GACvB,MAAO,CACHE,oBAAqBF,EAAQE,oBAErC,CACA,SAAS6B,EAAqB/B,EAAStF,GACnC,IAAItc,EAAI4G,EAAIC,EAAI+c,EAAIC,EAAIC,EAAIC,EAAIC,EAChC,MAAMC,GAA6F,QAA9EjkB,EAAgB,OAAXsc,QAA8B,IAAXA,OAAoB,EAASA,EAAOqD,oBAAiC,IAAP3f,OAAgB,EAASA,EAAG4f,WAAa,UAAWtD,EAAOqD,aAAaC,SAC7KsE,EAAWD,EAAa,YAAc,WAC5C,MAAO,CACHE,eAAiJ,QAAhItd,EAA+E,QAAzED,EAAgB,OAAX0V,QAA8B,IAAXA,OAAoB,EAASA,EAAOwC,eAA4B,IAAPlY,OAAgB,EAASA,EAAG2Y,eAA4B,IAAP1Y,EAAgBA,EAAK,KAC9Kud,YAA8F,QAAhFR,EAAgB,OAAXtH,QAA8B,IAAXA,OAAoB,EAASA,EAAOY,OAAOT,eAA4B,IAAPmH,EAAgBA,EAAK,KAC3HS,eAAoG,QAAnFR,EAAgB,OAAXvH,QAA8B,IAAXA,OAAoB,EAASA,EAAOY,OAAOR,kBAA+B,IAAPmH,EAAgBA,EAAK,KACjIS,UAAWJ,EACXK,YAAa7rB,OAAOoQ,OAAO,CAAE0b,SAAyI,QAA9HT,EAA+E,QAAzED,EAAgB,OAAXxH,QAA8B,IAAXA,OAAoB,EAASA,EAAOwC,eAA4B,IAAPgF,OAAgB,EAASA,EAAGtE,aAA0B,IAAPuE,EAAgBA,EAAK,KAAMpJ,SAAqF,QAA1EqJ,EAAgB,OAAX1H,QAA8B,IAAXA,OAAoB,EAASA,EAAO3B,gBAA6B,IAAPqJ,EAAgBA,EAAK,MAAQnC,EAAkBD,IAE7V,CAIA,SAASU,EAA6BV,GAClC,MAAO,CACH3H,KAAM,qBACNsK,YAAa1C,EAAkBD,GAEvC,CAMA,SAASW,EAA+BX,EAAStF,GAC7C,OAAO5jB,OAAOoQ,OAAO,CAAEmR,KAAM,uBAAwBwK,YAAY,GAAQd,EAAqB/B,EAAStF,GAC3G,CAOA,SAASkG,EAA2BZ,EAAS8C,EAAeC,GACxD,MAAO,CACH1K,KAAM,mBACNwK,YAAY,EACZC,cAAeA,EACfE,WAA0B,OAAdD,QAAoC,IAAdA,EAAuBA,EAAY,KACrEJ,YAAa1C,EAAkBD,GAEvC,CAIA,SAASa,EAAsCb,GAC3C,MAAO,CACH3H,KAAM,+BACNsK,YAAa1C,EAAkBD,GAEvC,CAMA,SAASc,EAAwCd,EAAStF,GACtD,OAAO5jB,OAAOoQ,OAAO,CAAEmR,KAAM,iCAAkCwK,YAAY,GAAQd,EAAqB/B,EAAStF,GACrH,CAMA,SAASqG,EAAoCf,EAASxE,GAClD,MAAO,CACHnD,KAAM,6BACNwK,YAAY,EACZC,cAAetH,EACfmH,YAAa1C,EAAkBD,GAEvC,CACA,SAASiD,EAAsBvI,EAAQkE,GACnC,IAAIxgB,EAAI4G,EAAIC,EAAI+c,EAChB,MAAO,CACH3C,YAAuD,QAAzCjhB,EAAK8kB,OAAOtE,EAAYM,mBAAgC,IAAP9gB,EAAgBA,EAAK,KACpFyS,KAAgM,QAAzLmR,EAAiC,QAA3Bhd,EAAK4Z,EAAY/N,YAAyB,IAAP7L,EAAgBA,EAA+E,QAAzEC,EAAgB,OAAXyV,QAA8B,IAAXA,OAAoB,EAASA,EAAOwC,eAA4B,IAAPjY,OAAgB,EAASA,EAAG0Y,eAA4B,IAAPqE,EAAgBA,EAAK,KAC7NhD,SAAUJ,EAAYI,SAASmE,KAAI1kB,IAC/B,IAAIL,EAAI4G,EACR,MAAQ,CACJ2Y,QAAoC,QAA1Bvf,EAAKK,EAAQkf,eAA4B,IAAPvf,EAAgBA,EAAK,KACjEglB,OAAkC,QAAzBpe,EAAKvG,EAAQ2kB,cAA2B,IAAPpe,EAAgBA,EAAK,KAClE,IAGb,CAOA,SAASic,EAAuCjB,EAAStF,EAAQkE,GAC7D,OAAO9nB,OAAOoQ,OAAOpQ,OAAOoQ,OAAO,CAAEmR,KAAM,kCAAoC0J,EAAqB/B,EAAStF,IAAUuI,EAAsBvI,EAAQkE,GACzJ,CAQA,SAASsC,EAA6BlB,EAAStF,EAAQkE,EAAayE,GAChE,OAAOvsB,OAAOoQ,OAAOpQ,OAAOoQ,OAAO,CAAEmR,KAAM,qBAAsBwK,YAAY,EAAMS,mBAAoBD,EAAkBlM,KAAO4K,EAAqB/B,EAAStF,IAAUuI,EAAsBvI,EAAQkE,GAC1M,CASA,SAASuC,EAAoCnB,EAAStF,EAAQkE,EAAapD,EAAcuH,GACrF,OAAOjsB,OAAOoQ,OAAOpQ,OAAOoQ,OAAO,CAAEmR,KAAM,6BAA8BwK,YAAY,EAAOC,cAAetH,EAAcwH,WAA0B,OAAdD,QAAoC,IAAdA,EAAuBA,EAAY,MAAQhB,EAAqB/B,EAAStF,IAAUuI,EAAsBvI,EAAQkE,GAChR,CAQA,SAASoC,EAAyBhB,EAAStF,EAAQ2D,GAC/C,OAAOvnB,OAAOoQ,OAAO,CAAEmR,KAAM,gBAAiBgG,MAAOA,GAAS0D,EAAqB/B,EAAStF,GAChG,CAxKA5jB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQuoB,0BAA4BA,EACpCvoB,EAAQinB,2BAA6BA,EACrCjnB,EAAQ0mB,kBAAoBA,EAC5B1mB,EAAQmnB,6BAA+BA,EACvCnnB,EAAQonB,+BAAiCA,EACzCpnB,EAAQqnB,2BAA6BA,EACrCrnB,EAAQsnB,sCAAwCA,EAChDtnB,EAAQunB,wCAA0CA,EAClDvnB,EAAQwnB,oCAAsCA,EAC9CxnB,EAAQ0nB,uCAAyCA,EACjD1nB,EAAQ2nB,6BAA+BA,EACvC3nB,EAAQ4nB,oCAAsCA,EAC9C5nB,EAAQynB,yBAA2BA,C,oCCbnClqB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,IACtDwB,EAAQulB,4BAA8BA,EACtC,MAAMrQ,EAAqC9X,EAAQ,MAC7CmP,EAAQnP,EAAQ,MACtB,SAASmoB,EAA4B9D,EAAUrL,GAC3C,MAAM4T,EAA2CvI,EAASwI,SAAS,uBAC7DC,EAAyBzI,EAAST,MAAKmJ,GAAWA,GAA8B,kBAAZA,GAAyC,wBAAjBA,EAAQ9U,OAC1G,IAAK2U,IAA6CE,EAC9C,MAAM,IAAIhV,EAAmCT,6BAA6B,mDAE9E,GAAIyV,QAAiErsB,IAAvCqsB,EAAuBE,aACjD,GAAIF,EAAuBE,YAAchU,EAAQoP,uBAC7C,MAAM,IAAItQ,EAAmCT,6BAA6B,6FAA6FyV,EAAuBE,oBAAoBhU,EAAQoP,4CAIlO,EAAIjZ,EAAMoL,YAAY,gJAC1B,C,yJChBO1V,GAAG,O,UAOEooB,EAAAA,EAAAA,IAAe,WAAV,QAAI,K,UAIPA,EAAAA,EAAAA,IAAgC,cAAxB,mBAAe,K,UAMvBA,EAAAA,EAAAA,IAAuB,cAAf,UAAM,K,UAchBA,EAAAA,EAAAA,IAAe,WAAV,QAAI,K,UASPA,EAAAA,EAAAA,IAA8B,cAAtB,iBAAa,K,UAanBA,EAAAA,EAAAA,IAAc,UAAV,SAAK,K,UAqBbA,EAAAA,EAAAA,IAAa,WAAR,MAAE,K,UAIPA,EAAAA,EAAAA,IAA6C,OAAxCC,MAAM,eAAc,kBAAc,K,UAIvCD,EAAAA,EAAAA,IAAqC,OAAhCC,MAAM,eAAc,UAAM,K,UAa/BD,EAAAA,EAAAA,IAAuB,WAAlB,gBAAY,K,UAIfA,EAAAA,EAAAA,IAAsC,OAAjCC,MAAM,eAAc,WAAO,K,UAIhCD,EAAAA,EAAAA,IAAsC,OAAjCC,MAAM,eAAc,WAAO,K,iQAvG5CC,EAAAA,EAAAA,IAuHM,MAvHNC,EAuHM,EAtHJC,EAAAA,EAAAA,IAqHeC,EAAA,MAxHnB5a,SAAA6a,EAAAA,EAAAA,KAIM,IAAkC,EAAlCF,EAAAA,EAAAA,IAAkCG,EAAA,MAJxC9a,SAAA6a,EAAAA,EAAAA,KAIiB,IAAW,EAJ5BE,EAAAA,EAAAA,IAIiB,kBAJjB/S,EAAA,KAKM2S,EAAAA,EAAAA,IAkHUK,EAAA,MAvHhBhb,SAAA6a,EAAAA,EAAAA,KAOQ,IAqBU,EArBVF,EAAAA,EAAAA,IAqBUM,EAAA,CArBDT,MAAM,eAAa,CACf3Z,QAAMga,EAAAA,EAAAA,KACf,IAAe,CAAfK,KATZlb,SAAA6a,EAAAA,EAAAA,KAWU,IAIS,EAJTF,EAAAA,EAAAA,IAISQ,EAAA,CAJDX,MAAM,YAAU,CAXlCxa,SAAA6a,EAAAA,EAAAA,KAYY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAZ7Brb,SAAA6a,EAAAA,EAAAA,KAac,IAAgC,CAAhCS,GAbdP,EAAAA,EAAAA,IAa8C,KAACQ,EAAAA,EAAAA,IAAGC,EAAAC,kBAAgB,MAblEzT,EAAA,OAAAA,EAAA,KAiBU2S,EAAAA,EAAAA,IAISQ,EAAA,CAJDX,MAAM,YAAU,CAjBlCxa,SAAA6a,EAAAA,EAAAA,KAkBY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAlB7Brb,SAAA6a,EAAAA,EAAAA,KAmBc,IAAuB,CAAvBa,GAnBdX,EAAAA,EAAAA,IAmBqC,KAACQ,EAAAA,EAAAA,IAAGI,EAAAjnB,eAAa,MAnBtDsT,EAAA,OAAAA,EAAA,OAAAA,EAAA,KA+BQ2S,EAAAA,EAAAA,IAwCUM,EAAA,CAxCDT,MAAM,kBAAgB,CAClB3Z,QAAMga,EAAAA,EAAAA,KACf,IAAe,CAAfe,KAjCZ5b,SAAA6a,EAAAA,EAAAA,KAmCU,IAIS,EAJTF,EAAAA,EAAAA,IAISQ,EAAA,CAJAU,OAAQ,IAAE,CAnC7B7b,SAAA6a,EAAAA,EAAAA,KAoCY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CApC7Brb,SAAA6a,EAAAA,EAAAA,KAqCc,IAA2E,EAA3EF,EAAAA,EAAAA,IAA2EmB,EAAA,CArCzFC,WAqCiCJ,EAAAK,iBArCjC,sBAAAC,EAAA,KAAAA,EAAA,GAAAC,GAqCiCP,EAAAK,iBAAgBE,GAAEC,YAAY,gB,0BArC/DnU,EAAA,OAAAA,EAAA,KAwCU2S,EAAAA,EAAAA,IAISQ,EAAA,CAJDX,MAAM,YAAU,CAxClCxa,SAAA6a,EAAAA,EAAAA,KAyCY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAzC7Brb,SAAA6a,EAAAA,EAAAA,KA0Cc,IAA8B,CAA9BuB,GA1CdrB,EAAAA,EAAAA,IA0C4C,KAACQ,EAAAA,EAAAA,IAAGI,EAAAU,oBAAkB,MA1ClErU,EAAA,OAAAA,EAAA,KA6CU2S,EAAAA,EAAAA,IAISQ,EAAA,CAJAU,OAAQ,GAAIrB,MAAM,c,CA7CrCxa,SAAA6a,EAAAA,EAAAA,KA8CY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CA9C7Brb,SAAA6a,EAAAA,EAAAA,KA+Cc,IAAiH,EAAjHF,EAAAA,EAAAA,IAAiH2B,EAAA,CAAtGtN,KAAK,UAAWuN,QAAOf,EAAAgB,kBAAmBC,KAAK,sB,CA/CxEzc,SAAA6a,EAAAA,EAAAA,KA+C6F,IAAsB,EA/CnHE,EAAAA,EAAAA,KAAAQ,EAAAA,EAAAA,IA+CgGI,EAAAe,kBAAgB,MA/ChH1U,EAAA,G,kBAAAA,EAAA,OAAAA,EAAA,M,WAmDU2U,EAAAA,EAAAA,IAQWC,EAAAA,GAAA,CARDC,GAAG,QAAM,CACNlB,EAAAmB,YAAS,WAApBrC,EAAAA,EAAAA,IAMM,OA1DlBlY,IAAA,EAoDkCiY,MAAM,gBAAiB+B,QAAKN,EAAA,KAAAA,EAAA,OAAAxU,IAAE+T,EAAAuB,YAAAvB,EAAAuB,cAAAtV,K,EAClD8S,EAAAA,EAAAA,IAIM,OAJDC,MAAM,gBAAiB+B,QAAKN,EAAA,KAAAA,EAAA,IArD/Ce,EAAAA,EAAAA,KAqDyC,QAAW,Y,EACpCzC,EAAAA,EAAAA,IAAiE,UAAzDC,MAAM,eAAgB+B,QAAKN,EAAA,KAAAA,EAAA,OAAAxU,IAAE+T,EAAAuB,YAAAvB,EAAAuB,cAAAtV,KAAY,KACjDwV,GACAtC,EAAAA,EAAAA,IAAqDuC,EAAA,CAAxCxuB,MAAOitB,EAAAwB,QAAUC,KAAM,IAAKC,MAAM,K,wBAxD/DC,EAAAA,EAAAA,IAAA,WA6DU3C,EAAAA,EAAAA,IAISQ,EAAA,CAJAU,OAAQ,GAAIrB,MAAM,c,CA7DrCxa,SAAA6a,EAAAA,EAAAA,KA8DY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CA9D7Brb,SAAA6a,EAAAA,EAAAA,KA+Dc,IAAqG,EAArGF,EAAAA,EAAAA,IAAqG2B,EAAA,CAA1FtN,KAAK,UAAWuN,QAAOf,EAAA+B,qBAAsBd,KAAK,yB,CA/D3Ezc,SAAA6a,EAAAA,EAAAA,KA+DmG,IAAI,EA/DvGE,EAAAA,EAAAA,IA+DmG,WA/DnG/S,EAAA,G,kBAAAA,EAAA,OAAAA,EAAA,KAkEU2S,EAAAA,EAAAA,IAISQ,EAAA,CAJAU,OAAQ,GAAKrB,MAAM,c,CAlEtCxa,SAAA6a,EAAAA,EAAAA,KAmEY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAnE7Brb,SAAA6a,EAAAA,EAAAA,KAoEc,IAA2J,EAA3JF,EAAAA,EAAAA,IAA2J2B,EAAA,CAAhJtN,KAAK,SAAUuN,QAAOf,EAAAgC,iBAAkBf,KAAK,wBAAyBgB,SAAkC,GAAxB9B,EAAA+B,cAAcllB,Q,CApEvHwH,SAAA6a,EAAAA,EAAAA,KAoEoI,IAAyB,EApE7JE,EAAAA,EAAAA,KAAAQ,EAAAA,EAAAA,IAoEuII,EAAAgC,qBAAmB,MApE1J3V,EAAA,G,6BAAAA,EAAA,OAAAA,EAAA,OAAAA,EAAA,KA0EQ2S,EAAAA,EAAAA,IAkBUM,EAAA,CAlBDT,MAAM,eAAa,CACf3Z,QAAMga,EAAAA,EAAAA,KACf,IAAa,CAAb+C,KA5EZ5d,SAAA6a,EAAAA,EAAAA,KA+EU,IAGS,EAHTF,EAAAA,EAAAA,IAGSS,EAAA,CAHAyC,GAAI,GAAKC,GAAI,I,CA/EhC9d,SAAA6a,EAAAA,EAAAA,KAgFY,IAA6C,CAA7CkD,GACApD,EAAAA,EAAAA,IAA8EmB,EAAA,CAjF1FC,WAiF+BJ,EAAAqC,gBAjF/B,sBAAA/B,EAAA,KAAAA,EAAA,GAAAC,GAiF+BP,EAAAqC,gBAAe9B,GAAEC,YAAY,oB,0BAjF5DnU,EAAA,KAmFU2S,EAAAA,EAAAA,IAGSS,EAAA,CAHAyC,GAAI,GAAKC,GAAI,I,CAnFhC9d,SAAA6a,EAAAA,EAAAA,KAoFY,IAAqC,CAArCoD,GACAtD,EAAAA,EAAAA,IAAyDmB,EAAA,CArFrEC,WAqF+BJ,EAAAuC,QArF/B,sBAAAjC,EAAA,KAAAA,EAAA,GAAAC,GAqF+BP,EAAAuC,QAAOhC,GAAEC,YAAY,O,0BArFpDnU,EAAA,KAuFU2S,EAAAA,EAAAA,IAISQ,EAAA,CAJAU,OAAQ,GAAIrB,MAAM,c,CAvFrCxa,SAAA6a,EAAAA,EAAAA,KAwFY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAxF7Brb,SAAA6a,EAAAA,EAAAA,KAyFc,IAAyF,EAAzFF,EAAAA,EAAAA,IAAyF2B,EAAA,CAA9EtN,KAAK,UAAWuN,QAAKN,EAAA,KAAAA,EAAA,GAAAC,GAAEV,EAAAlG,oB,CAzFhDtV,SAAA6a,EAAAA,EAAAA,KAyFmE,IAAwB,EAzF3FE,EAAAA,EAAAA,KAAAQ,EAAAA,EAAAA,IAyFsEI,EAAAwC,oBAAkB,MAzFxFnW,EAAA,OAAAA,EAAA,OAAAA,EAAA,OAAAA,EAAA,KA+FQ2S,EAAAA,EAAAA,IAcUM,EAAA,CAdDT,MAAM,gBAAc,CAChB3Z,QAAMga,EAAAA,EAAAA,KACf,IAAuB,CAAvBuD,KAjGZpe,SAAA6a,EAAAA,EAAAA,KAmGU,IASS,EATTF,EAAAA,EAAAA,IASSQ,EAAA,CATAU,OAAQ,IAAE,CAnG7B7b,SAAA6a,EAAAA,EAAAA,KAoGY,IAGS,EAHTF,EAAAA,EAAAA,IAGSS,EAAA,CAHAyC,GAAI,GAAKC,GAAI,I,CApGlC9d,SAAA6a,EAAAA,EAAAA,KAqGc,IAAsC,CAAtCwD,GACA1D,EAAAA,EAAAA,IAA4EmB,EAAA,CAtG1FC,WAsGiCJ,EAAA2C,YAtGjC,sBAAArC,EAAA,KAAAA,EAAA,GAAAC,GAsGiCP,EAAA2C,YAAWpC,GAAEC,YAAY,YAAYsB,SAAA,I,0BAtGtEzV,EAAA,KAwGY2S,EAAAA,EAAAA,IAGSS,EAAA,CAHAyC,GAAI,GAAKC,GAAI,I,CAxGlC9d,SAAA6a,EAAAA,EAAAA,KAyGc,IAAsC,CAAtC0D,GACA5D,EAAAA,EAAAA,IAA4EmB,EAAA,CA1G1FC,WA0GiCJ,EAAA6C,YA1GjC,sBAAAvC,EAAA,KAAAA,EAAA,GAAAC,GA0GiCP,EAAA6C,YAAWtC,GAAEC,YAAY,YAAYsB,SAAA,I,0BA1GtEzV,EAAA,OAAAA,EAAA,OAAAA,EAAA,KAgHQ2S,EAAAA,EAAAA,IAMUM,EAAA,CANDT,MAAM,eAAa,CAhHpCxa,SAAA6a,EAAAA,EAAAA,KAiHU,IAIS,EAJTF,EAAAA,EAAAA,IAISQ,EAAA,MArHnBnb,SAAA6a,EAAAA,EAAAA,KAkHY,IAES,EAFTF,EAAAA,EAAAA,IAESS,EAAA,CAFAC,KAAM,IAAE,CAlH7Brb,SAAA6a,EAAAA,EAAAA,KAmHc,IAA8F,EAA9FF,EAAAA,EAAAA,IAA8F2B,EAAA,CAAnFtN,KAAK,SAAUuN,QAAKN,EAAA,KAAAA,EAAA,GAAAC,GAAEV,EAAAiD,qBAAqBhC,KAAK,kB,CAnHzEzc,SAAA6a,EAAAA,EAAAA,KAmH0F,IAAM,EAnHhGE,EAAAA,EAAAA,IAmH0F,aAnH1F/S,EAAA,OAAAA,EAAA,OAAAA,EAAA,OAAAA,EAAA,OAAAA,EAAA,OAAAA,EAAA,K,2DAsSI0W,EAAM,IAAIhT,EAAAA,cAAc,CAAC+H,SAAU,CAC3BlO,KAAK,SACLkX,KAAK,GACL7rB,IAAI,aAEhBmY,OAAO6I,IAAM8M,EACb,IAAIC,EAAS,IAAI1oB,EAAAA,kBAMjB2oB,eAAeC,EAAevK,EAASwK,EAAYhe,EAAWie,GAC5D,IAEE,MAAMC,EAAgBC,EAAAA,QAAQ3W,MAAMgM,GAG9Blf,EAAU,GAAG2pB,MAAWC,EAAcltB,UAAS,GAAM,GAAM,KAG3DkG,EAAYuP,EAAOC,KAAKsX,EAAW,OAInCI,EAAkB3X,EAAOC,KAAK1G,EAAU,UAG9C,OAAOqe,EAAAA,EAAAA,YAAW5X,EAAOC,KAAKpS,GAAU8pB,EAAiBlnB,EAC3D,CAAE,MAAOvE,GAEP,OADAiU,QAAQjU,MAAM,6BAA8BA,IACrC,CACT,CACF,CAGA,MAAM6gB,EAAU,mDACV8K,EAAQ,CACZ,UAAa,WACb,OAAU,CACR,YAAe,GACf,MAAS,uBAEX,UAAa,2FACb,QAAW,cACX,WAAc,MACd,WAAc,gDAEVte,EAAYse,EAAMte,UAClBie,EAASK,EAAML,OAAOrwB,MAE5BmwB,EAAevK,EAAS8K,EAAOte,EAAWie,GACrC/uB,MAAKqvB,IACJ3X,QAAQlX,IAAI,sBAAuB6uB,EAAQ,IAE5CpI,OAAMxjB,IACLiU,QAAQjU,MAAM,uBAAwBA,EAAM,IAMlD,OACE8R,KAAM,MACN+Z,WAAY,CACVC,UAASA,EAAAA,GAEX9tB,KAAMA,KACG,CACL+tB,UAAW,GACXC,cAAe,GACfzD,iBAAkB,GAClB0D,gBAAiB,IACjBC,QAAS,GACTC,cAAc,EACdlD,iBAAkB,OAClBiB,oBAAqB,OACrBW,YAAa,GACbE,YAAa,GACbR,gBAAgB,GAChBG,mBAAmB,OACnBT,cAAc,GACdQ,QAAQ,GACR7B,mBAAmB,GACnBS,WAAW,EACXK,QAAS,+BACTzoB,cAAc,KAGlBmrB,SAAU,CACRC,cAAc,WACZpY,QAAQlX,IAAI,oBAAoBhD,KAAKgyB,aAAahyB,KAAKiyB,iBACvD,IAAIC,EAAkBjU,EAAAA,MAAMpC,iBAC1B,CACEwG,YAAa,IACbjW,UAAWpM,KAAKgyB,UAChB3lB,SAAUrM,KAAKiyB,cACf1P,SAAU,CACRxK,KAAM,OACN3U,IAAK,IACLmvB,QAAS,KAEX1iB,UAAU,IACV+J,YAAa5Z,KAAKwuB,mBAGtB,OAAO0D,CACT,EACAjE,iBAAiB,WACf,OAAOjuB,KAAKkwB,aACd,GAIFsC,QAAS,CACP,uBAAMxD,GACFhvB,KAAKyyB,YAET,EACA,sBAAMzC,GACJ9V,QAAQlX,IAAI,qCACZkuB,EAAInqB,YACN,EACA,0BAAMgpB,GACJ7V,QAAQlX,IAAI,kCACZkuB,EAAItM,mBACN,EACAqM,kBAAmBA,KACjB/W,QAAQlX,IAAI,2BACZmuB,EAAOviB,YAAY,EAIrB,qBAAMkZ,GAGN,GAFE5N,QAAQlX,IAAI,mBACZkX,QAAQlX,IAAI,0BAA0BhD,KAAKwwB,iBAC1CxwB,KAAKwwB,gBAAgB,CAEtB,MAAMkC,EAAWviB,KAAK2K,MAAM9a,KAAKwwB,iBAGjC,OAFAtW,QAAQlX,IAAI,2BAA2B0vB,QACvCxB,EAAIpJ,gBAAgB4K,EAEtB,CACE,IAAIC,EACA,CAAC,SAAW,CAAC,CAAC,QAAU,mDAAmD,OAAS,YAAY,QAAU,6MAA6M,WAAa,cAAc,SAAW,IAAI,KAAO,oDAE5W,IACE,IAAItxB,QAAe6vB,EAAIpJ,gBAAgB6K,GACvC3yB,KAAK0wB,QAAUrvB,EAAOif,GACxB,CAAC,MAAOje,GACFA,aAAagV,EAAAA,iBACfrX,KAAK0wB,QAAU,SAEf1wB,KAAK0wB,QAAU,OAEnB,CACF,EAEA,gBAAM+B,GACJ,GAAIvB,EAAIttB,UACNsW,QAAQlX,IAAI,iCACR,CACJkX,QAAQlX,IAAI,iCAA8BhD,KAAKwuB,kBAC/C,IAAIoE,EAAc,CAChBzL,SAASnnB,KAAKwuB,iBACd3U,SAAS,eACTgI,kBAAiB,GAGnB,GAAI7hB,KAAK6yB,OAAQ,CACfD,EAAY/Y,SAAW,KACvB+Y,EAAY/Q,kBAAmB,EAC/B3H,QAAQlX,IAAI,6BAA6B4vB,GAEzC,IAAIxvB,QAAY8tB,EAAItqB,QAAQgsB,GAC5B1Y,QAAQlX,IAAI,2BAA2BI,GACnCA,IACFpD,KAAK2vB,QAAUvsB,EACfpD,KAAKsvB,WAAY,EAGrB,MACKtvB,KAAK8yB,qBACNF,EAAY/Y,SAAW,MAEzBK,QAAQlX,IAAI,gBAAgB4vB,SACrB1B,EAAItqB,QAAQgsB,EAEvB,CAEF,EAEArD,UAAAA,GACEvvB,KAAKsvB,WAAY,CACnB,EAEAuD,IAAAA,GACE,MAAME,EAAgBC,UAAUC,UAChC/Y,QAAQlX,IAAI,4BAA4B+vB,GAExC,MAAMG,EAAS,CAAC,UAAW,SAAU,YAAa,gBAAiB,OAAQ,QAC3E,IAAIC,GAAO,EACX,IAAK,IAAIlyB,EAAI,EAAGA,EAAIiyB,EAAOloB,OAAQ/J,IACjC,GAAI8xB,EAAc1N,QAAQ6N,EAAOjyB,IAAM,EAAG,CACxCkyB,GAAO,EACP,KACF,CAEF,OAAOA,CACT,EACAL,gBAAAA,GACE,MAAMC,EAAgBC,UAAUC,UAC1BC,EAAS,CAAC,SAAU,UAC1B,IAAIC,GAAO,EACX,IAAK,IAAIlyB,EAAI,EAAGA,EAAIiyB,EAAOloB,OAAQ/J,IACjC,GAAI8xB,EAAc1N,QAAQ6N,EAAOjyB,IAAM,EAAG,CACxCkyB,GAAO,EACP,KACF,CAEF,OAAOA,CACT,GAEFC,OAAAA,GAEElZ,QAAQlX,IAAI,iBACZkX,QAAQlX,IAAIkuB,GAEZ,MAAM7tB,EAAS,CACb2nB,EAAAA,2BACAD,EAAAA,6BACAD,EAAAA,yBACAD,EAAAA,qCACAD,EAAAA,uCACAD,EAAAA,mCACAD,EAAAA,sBACAD,EAAAA,uCACAD,EAAAA,2BACAD,EAAAA,oCAGFlnB,EAAOmN,SAAQqY,IACbtN,OAAOzU,iBAAiB+hB,GAAYpkB,IAClCyV,QAAQlX,IAAI6lB,EAAUpkB,EAAMukB,QAC5BhpB,KAAKkH,cAAgB2hB,CAAQ,GAC7B,GAEN,EAEAwK,OAAAA,GACErzB,KAAKoyB,cAAe,EAGpB,MAAM/nB,EAAc8mB,EAAOziB,gBAC3BwL,QAAQlX,IAAIqH,GACZrK,KAAK8wB,YAAczmB,EAAYH,GAAGM,UAClCxK,KAAKgxB,YAAc3mB,EAAYH,GAAGQ,UAClC1K,KAAKiyB,cAAgBjyB,KAAK8wB,YAC1B9wB,KAAKgyB,UAAY3nB,EAAYa,OAAOd,QAEpC8mB,EAAIxJ,gBAAgB9D,IAEd,GADA1J,QAAQlX,IAAI,iCAA+B4gB,GACvCA,EAAY,CAEd,GADA5jB,KAAKkwB,cAAgBtM,EAAWyC,QAAQS,QACpC9mB,KAAKwuB,iBAAkB,CACzB,MAAM1H,EAAU9mB,KAAKkwB,cACf5c,EAAYsQ,EAAWsD,cAAcC,UAAUyK,MAAMte,UACrDie,EAAS3N,EAAWsD,cAAcC,UAAUyK,MAAML,OAClD+B,EAAS1P,EAAWyC,QAAQ7b,UAClC6mB,EAAevK,EAASwM,EAAQ,GAAGhgB,IAAaie,EAAOrwB,OAClDsB,MAAKqvB,IACJ7xB,KAAK6uB,mBAAqBgD,EAC1B3X,QAAQlX,IAAI,sBAAuB6uB,EAAQ,IAE5CpI,OAAMxjB,IACLjG,KAAK6uB,mBAAqB,OAE1B3U,QAAQjU,MAAM,uBAAwBA,EAAM,GAEpD,MACEjG,KAAK6uB,mBAAqB,KAE5B7uB,KAAKsvB,WAAY,CAEnB,MACEtvB,KAAKkwB,cAAgB,OACvB,IACEhX,IACEA,aAAe7B,EAAAA,iBACjBrX,KAAKkwB,cAAgB,SAErBlwB,KAAKkwB,cAAgB,UAAUhX,EAAItR,SACrC,GASR,G,UC5kBF,MAAM2rB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,QCJA,MAAMC,GAAMC,EAAAA,EAAAA,IAAUC,GAEtBF,EAAIG,IAAIC,EAAAA,GACRJ,EAAIK,MAAM,O,2ECPNC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB1zB,IAAjB2zB,EACH,OAAOA,EAAaxxB,QAGrB,IAAIyxB,EAASJ,EAAyBE,GAAY,CAGjDvxB,QAAS,CAAC,GAOX,OAHA0xB,EAAoBH,GAAUzyB,KAAK2yB,EAAOzxB,QAASyxB,EAAQA,EAAOzxB,QAASsxB,GAGpEG,EAAOzxB,OACf,CAGAsxB,EAAoB5zB,EAAIg0B,E,WCzBxB,IAAIC,EAAW,GACfL,EAAoBM,EAAI,SAASjzB,EAAQkzB,EAAU1b,EAAI2b,GACtD,IAAGD,EAAH,CAMA,IAAIE,EAAeC,IACnB,IAASnmB,EAAI,EAAGA,EAAI8lB,EAASrpB,OAAQuD,IAAK,CACrCgmB,EAAWF,EAAS9lB,GAAG,GACvBsK,EAAKwb,EAAS9lB,GAAG,GACjBimB,EAAWH,EAAS9lB,GAAG,GAE3B,IAJA,IAGIrM,GAAY,EACPyyB,EAAI,EAAGA,EAAIJ,EAASvpB,OAAQ2pB,MACpB,EAAXH,GAAsBC,GAAgBD,IAAav0B,OAAO0Y,KAAKqb,EAAoBM,GAAGM,OAAM,SAAS7f,GAAO,OAAOif,EAAoBM,EAAEvf,GAAKwf,EAASI,GAAK,IAChKJ,EAASM,OAAOF,IAAK,IAErBzyB,GAAY,EACTsyB,EAAWC,IAAcA,EAAeD,IAG7C,GAAGtyB,EAAW,CACbmyB,EAASQ,OAAOtmB,IAAK,GACrB,IAAIumB,EAAIjc,SACEtY,IAANu0B,IAAiBzzB,EAASyzB,EAC/B,CACD,CACA,OAAOzzB,CArBP,CAJCmzB,EAAWA,GAAY,EACvB,IAAI,IAAIjmB,EAAI8lB,EAASrpB,OAAQuD,EAAI,GAAK8lB,EAAS9lB,EAAI,GAAG,GAAKimB,EAAUjmB,IAAK8lB,EAAS9lB,GAAK8lB,EAAS9lB,EAAI,GACrG8lB,EAAS9lB,GAAK,CAACgmB,EAAU1b,EAAI2b,EAwB/B,C,eC5BAR,EAAoBe,EAAI,SAASZ,GAChC,IAAIa,EAASb,GAAUA,EAAOzzB,WAC7B,WAAa,OAAOyzB,EAAO,UAAY,EACvC,WAAa,OAAOA,CAAQ,EAE7B,OADAH,EAAoBiB,EAAED,EAAQ,CAAEE,EAAGF,IAC5BA,CACR,C,eCNAhB,EAAoBiB,EAAI,SAASvyB,EAASyyB,GACzC,IAAI,IAAIpgB,KAAOogB,EACXnB,EAAoB7zB,EAAEg1B,EAAYpgB,KAASif,EAAoB7zB,EAAEuC,EAASqS,IAC5E9U,OAAOc,eAAe2B,EAASqS,EAAK,CAAElU,YAAY,EAAMC,IAAKq0B,EAAWpgB,IAG3E,C,eCPAif,EAAoBoB,EAAI,WACvB,GAA0B,kBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOr1B,MAAQ,IAAIs1B,SAAS,cAAb,EAChB,CAAE,MAAOjzB,GACR,GAAsB,kBAAXkZ,OAAqB,OAAOA,MACxC,CACA,CAPuB,E,eCAxByY,EAAoB7zB,EAAI,SAASo1B,EAAKC,GAAQ,OAAOv1B,OAAOqB,UAAUC,eAAeC,KAAK+zB,EAAKC,EAAO,C,eCCtGxB,EAAoBc,EAAI,SAASpyB,GACX,qBAAX+yB,QAA0BA,OAAOC,aAC1Cz1B,OAAOc,eAAe2B,EAAS+yB,OAAOC,YAAa,CAAEx0B,MAAO,WAE7DjB,OAAOc,eAAe2B,EAAS,aAAc,CAAExB,OAAO,GACvD,C,eCDA,IAAIy0B,EAAkB,CACrB,IAAK,GAaN3B,EAAoBM,EAAEK,EAAI,SAASiB,GAAW,OAAoC,IAA7BD,EAAgBC,EAAgB,EAGrF,IAAIC,EAAuB,SAASC,EAA4B7xB,GAC/D,IAKIgwB,EAAU2B,EALVrB,EAAWtwB,EAAK,GAChB8xB,EAAc9xB,EAAK,GACnB+xB,EAAU/xB,EAAK,GAGIsK,EAAI,EAC3B,GAAGgmB,EAAS0B,MAAK,SAAStxB,GAAM,OAA+B,IAAxBgxB,EAAgBhxB,EAAW,IAAI,CACrE,IAAIsvB,KAAY8B,EACZ/B,EAAoB7zB,EAAE41B,EAAa9B,KACrCD,EAAoB5zB,EAAE6zB,GAAY8B,EAAY9B,IAGhD,GAAG+B,EAAS,IAAI30B,EAAS20B,EAAQhC,EAClC,CAEA,IADG8B,GAA4BA,EAA2B7xB,GACrDsK,EAAIgmB,EAASvpB,OAAQuD,IACzBqnB,EAAUrB,EAAShmB,GAChBylB,EAAoB7zB,EAAEw1B,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBC,GAAW,EAE5B,OAAO5B,EAAoBM,EAAEjzB,EAC9B,EAEI60B,EAAqBtY,KAAK,0BAA4BA,KAAK,2BAA6B,GAC5FsY,EAAmB1lB,QAAQqlB,EAAqBnwB,KAAK,KAAM,IAC3DwwB,EAAmBxmB,KAAOmmB,EAAqBnwB,KAAK,KAAMwwB,EAAmBxmB,KAAKhK,KAAKwwB,G,IC/CvF,IAAIC,EAAsBnC,EAAoBM,OAAE/zB,EAAW,CAAC,MAAM,WAAa,OAAOyzB,EAAoB,KAAO,IACjHmC,EAAsBnC,EAAoBM,EAAE6B,E","sources":["webpack://okxconnect/../src/core/connect/connect.js","webpack://okxconnect/../src/core/connect/connectionManager.js","webpack://okxconnect/../src/core/connect/constants.js","webpack://okxconnect/../src/core/connect/engine.js","webpack://okxconnect/../src/core/connect/jwt.js","webpack://okxconnect/../src/core/connect/storage.js","webpack://okxconnect/../src/core/crypto/crypto.js","webpack://okxconnect/../src/core/protocol/error/index.js","webpack://okxconnect/../src/core/protocol/error/okx-connect.error.js","webpack://okxconnect/../src/core/protocol/error/unknown.error.js","webpack://okxconnect/../src/core/protocol/error/user-rejects.error.js","webpack://okxconnect/../src/core/protocol/error/wallet-already-connected.error.js","webpack://okxconnect/../src/core/protocol/error/wallet-not-connected.error.js","webpack://okxconnect/../src/core/protocol/error/wallet-not-support-feature.error.js","webpack://okxconnect/../src/core/protocol/index.js","webpack://okxconnect/../src/core/storage/default-storage.js","webpack://okxconnect/../src/core/storage/in-memory-storage.js","webpack://okxconnect/../src/core/utils/call-for-success.js","webpack://okxconnect/../src/core/utils/deeplink.js","webpack://okxconnect/../src/core/utils/log.js","webpack://okxconnect/../src/core/utils/safejson.js","webpack://okxconnect/../src/core/utils/url.js","webpack://okxconnect/../src/core/utils/utils.js","webpack://okxconnect/../src/core/utils/web-api.js","webpack://okxconnect/../src/index.js","webpack://okxconnect/../src/ton/protocol/index.js","webpack://okxconnect/../src/ton/protocol/models/CHAIN.js","webpack://okxconnect/../src/ton/protocol/models/app-message/connect-request/index.js","webpack://okxconnect/../src/ton/protocol/models/app-message/index.js","webpack://okxconnect/../src/ton/protocol/models/app-message/request/index.js","webpack://okxconnect/../src/ton/protocol/models/index.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/index.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-event/connect-event.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-event/index.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-response/disconnect-rpc-response.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-response/index.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-response/send-transaction-rpc-response.js","webpack://okxconnect/../src/ton/protocol/models/wallet-message/wallet-response/sign-data-rpc-response.js","webpack://okxconnect/../src/ton/tonsdk/constants/version.js","webpack://okxconnect/../src/ton/tonsdk/index.js","webpack://okxconnect/../src/ton/tonsdk/models/index.js","webpack://okxconnect/../src/ton/tonsdk/models/methods/connect/index.js","webpack://okxconnect/../src/ton/tonsdk/models/methods/index.js","webpack://okxconnect/../src/ton/tonsdk/models/methods/send-transaction/index.js","webpack://okxconnect/../src/ton/tonsdk/models/wallet/index.js","webpack://okxconnect/../src/ton/tonsdk/parsers/connect-errors-parser.js","webpack://okxconnect/../src/ton/tonsdk/parsers/rpc-parser.js","webpack://okxconnect/../src/ton/tonsdk/parsers/send-transaction-parser.js","webpack://okxconnect/../src/ton/tonsdk/provider/bridge-connection-storage.js","webpack://okxconnect/../src/ton/tonsdk/provider/bridge/bridge-provider.js","webpack://okxconnect/../src/ton/tonsdk/provider/bridge/models/bridge-connection.js","webpack://okxconnect/../src/ton/tonsdk/ton-connect.js","webpack://okxconnect/../src/ton/tonsdk/tracker/browser-event-dispatcher.js","webpack://okxconnect/../src/ton/tonsdk/tracker/ton-connect-tracker.js","webpack://okxconnect/../src/ton/tonsdk/tracker/tracker-constants.js","webpack://okxconnect/../src/ton/tonsdk/tracker/types.js","webpack://okxconnect/../src/ton/tonsdk/utils/feature-support.js","webpack://okxconnect/./src/App.vue","webpack://okxconnect/./src/App.vue?7ccd","webpack://okxconnect/./src/main.js","webpack://okxconnect/webpack/bootstrap","webpack://okxconnect/webpack/runtime/chunk loaded","webpack://okxconnect/webpack/runtime/compat get default export","webpack://okxconnect/webpack/runtime/define property getters","webpack://okxconnect/webpack/runtime/global","webpack://okxconnect/webpack/runtime/hasOwnProperty shorthand","webpack://okxconnect/webpack/runtime/make namespace object","webpack://okxconnect/webpack/runtime/jsonp chunk loading","webpack://okxconnect/webpack/startup"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OKXWalletConnector = void 0;\nconst constants_1 = require(\"./constants\");\nconst safejson_1 = require(\"../utils/safejson\");\nconst utils_1 = require(\"../utils/utils\");\nconst events_1 = require(\"events\");\nconst log = __importStar(require(\"../utils/log\"));\nconst WS = (0, utils_1.resolveWebSocketImplementation)();\nclass OKXWalletConnector {\n    constructor(url) {\n        this.events = new events_1.EventEmitter();\n        this.state = constants_1.ConnectorState.InitState;\n        if (!(0, utils_1.checkWSUrl)(url)) {\n            throw new Error(`CONNECTOR: invalid url ${url}`);\n        }\n        this.url = url;\n    }\n    get connected() {\n        return typeof this.socket !== \"undefined\";\n    }\n    get connecting() {\n        return this.state == constants_1.ConnectorState.Connecting;\n    }\n    // ------------------------------------------------------\n    // 推送结构\n    onPayload(e) {\n        if (typeof e.data === \"undefined\")\n            return;\n        log.logDebug('get received data');\n        log.logDebug(e);\n        if (typeof e.data === \"string\") {\n            let rsp = e.data;\n            if (rsp === \"pong\") {\n                log.logDebug(`CONNECT: receive pong ${Date.now().toString()}`);\n                return;\n            }\n        }\n        this.events.emit(\"payload\", e.data);\n    }\n    onClose(event) {\n        this.socket = undefined;\n        this.events.emit(\"close\", event);\n    }\n    onError(id, e) {\n        const payload = { id: id, msg: e.toString() };\n        this.events.emit(\"payload\", payload);\n    }\n    onopen(socket) {\n        socket.onmessage = (event) => this.onPayload(event);\n        socket.onclose = (event) => this.onClose(event);\n        this.socket = socket;\n        this.state = constants_1.ConnectorState.Connected;\n        this.events.emit(\"open\");\n    }\n    // ------------------------------------------------------\n    emitError(errorEvent) {\n        this.events.emit(\"fail\", errorEvent);\n    }\n    // ------------------------------------------------------\n    heartbeat() {\n        if (!this.socket) {\n            log.logDebug('socket not exist');\n            return;\n        }\n        if (this.socket.readyState !== WebSocket.OPEN) {\n            log.logDebug('socket not ready');\n            return;\n        }\n        log.logDebug(`send ping heart beat: ${Date.now().toString()}`);\n        this.socket.send(\"ping\");\n        setTimeout(this.heartbeat.bind(this), 15000);\n    }\n    registOpen(url = this.url) {\n        if (!(0, utils_1.checkWSUrl)(url)) {\n            throw new Error(`CONNECTOR: invalid url ${url}`);\n        }\n        if (this.connecting) {\n            /// event observer limits\n            const maxListenerCount = this.events.getMaxListeners();\n            if (this.events.listenerCount(\"open\") >= maxListenerCount ||\n                this.events.listenerCount(\"fail\") >= maxListenerCount) {\n                this.events.setMaxListeners(maxListenerCount + 1);\n            }\n            return new Promise((resolve, reject) => {\n                this.events.once(\"fail\", (error) => {\n                    if (this.events.getMaxListeners() > constants_1.EVENT_EMITTER_MAX_LISTENERS) {\n                        this.events.setMaxListeners(constants_1.EVENT_EMITTER_MAX_LISTENERS);\n                    }\n                    reject(error);\n                });\n                this.events.once(\"open\", () => {\n                    if (this.events.getMaxListeners() > constants_1.EVENT_EMITTER_MAX_LISTENERS) {\n                        this.events.setMaxListeners(constants_1.EVENT_EMITTER_MAX_LISTENERS);\n                    }\n                    if (typeof this.socket == \"undefined\") {\n                        return reject(new Error(\"Connect lost\"));\n                    }\n                    resolve(this.socket);\n                });\n            });\n        }\n        this.url = url;\n        this.state = constants_1.ConnectorState.Connecting;\n        const origin = new URLSearchParams(url).get(\"origin\");\n        // TODO: 参考wallet connect 连接设置，localhost时为false\n        const opts = { rejectUnauthorized: false };\n        return new Promise((resolve, reject) => {\n            const socket = new WS(url, [], opts);\n            if ((0, utils_1.hasBuiltInWebSocket)()) {\n                socket.onerror = (event) => {\n                    const errorEvent = event;\n                    reject(this.emitError(errorEvent.error));\n                };\n            }\n            else {\n                socket.on(\"error\", (errorEvent) => {\n                    reject(this.emitError(errorEvent));\n                });\n            }\n            socket.onopen = () => {\n                log.logDebug('socket opened');\n                this.onopen(socket);\n                this.heartbeat();\n                resolve(socket);\n            };\n        });\n    }\n    // ------------------------------------------------------\n    onVisibleChanged() {\n        if (document.visibilityState === 'visible') {\n            // check and restore\n            log.logDebug(`get changed ${this.state}, ${this.socket}`);\n            if (this.state == constants_1.ConnectorState.Connected && typeof this.socket === \"undefined\") {\n                log.logDebug('CONNECTION need reopen');\n                this.registOpen();\n            }\n        }\n    }\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.registOpen(this.url);\n            // listener for reconnect\n            document.removeEventListener('visibilitychange', this.onVisibleChanged.bind(this));\n            document.addEventListener('visibilitychange', this.onVisibleChanged.bind(this));\n        });\n    }\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.state = constants_1.ConnectorState.Disconnected;\n            return new Promise((resolve, reject) => {\n                if (typeof this.socket === \"undefined\") {\n                    // reject(new Error(\"CONNECTION closed\"))\n                    resolve();\n                    return;\n                }\n                this.socket.onclose = (event) => {\n                    this.onClose(event);\n                    resolve();\n                };\n                this.socket.close();\n            });\n        });\n    }\n    currentStatus() {\n        return {\n            state: this.state,\n            url: this.url\n        };\n    }\n    // 推送数据中需要透传event字段作为回调标记\n    // event 会映射为 jsonstr\n    /// @params Promise\n    /// @params success/failed callback\n    addListener(event, decrypt, success, failed) {\n        this.events.on(\"payload\", (e) => {\n            var _a;\n            log.logDebug(`<<< get payload ${e}`);\n            log.logDebug(e);\n            let parsedEvent = (0, safejson_1.safeJsonParse)(e);\n            // parse the data to chose success or failed\n            if (parsedEvent.params && parsedEvent.params.data) {\n                let rawMsg = (_a = parsedEvent.params.data) === null || _a === void 0 ? void 0 : _a.message;\n                if (rawMsg) {\n                    try {\n                        let msg = decrypt(rawMsg);\n                        success(event, msg);\n                    }\n                    catch (e) {\n                        log.logDebug(`CONNECT: decrypt failed: ${e}`);\n                        failed(event, e.message);\n                    }\n                }\n            }\n        });\n        this.events.on(\"fail\", (e) => {\n            if (e) {\n                log.logDebug(`CONNECT failed: ${e}`);\n                failed(event, e.message);\n            }\n            else {\n                failed(event, \"Unkonow error\");\n            }\n        });\n    }\n    addPackageParse(callback) {\n        this.events.on(\"payload\", (e) => __awaiter(this, void 0, void 0, function* () {\n            // parse the data to chose success or failed\n            log.logDebug(`<<<< received e:${e}`);\n            let param = (0, safejson_1.safeJsonParse)(e);\n            yield callback(param);\n        }));\n    }\n    once(event, listener) {\n        this.events.once(event, listener);\n    }\n    off(event, listener) {\n        this.events.off(event, listener);\n    }\n    removeListener(event, listener) {\n        this.events.removeListener(event, listener);\n    }\n    send(doLogin, payload) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof this.socket === \"undefined\") {\n                log.logDebug(`>>> send payload undefined ${payload}`);\n                // this.socket = await this.registOpen();\n                yield doLogin();\n            }\n            try {\n                log.logDebug(`>>> send payload ${(0, safejson_1.safeJsonStringify)(payload)}`);\n                if (this.socket) {\n                    this.socket.send((0, safejson_1.safeJsonStringify)(payload));\n                }\n            }\n            catch (e) {\n                this.onError(payload.id, e);\n            }\n        });\n    }\n    getMsgPayloadFromHistory(msg) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof msg === \"undefined\")\n                return;\n            let tmpMsg = {\n                params: {\n                    data: msg\n                }\n            };\n            let jsonstr = (0, safejson_1.safeJsonStringify)(msg);\n            log.logDebug('get received data from history');\n            log.logDebug(jsonstr);\n            jsonstr = (0, safejson_1.safeJsonStringify)(tmpMsg);\n            this.events.emit(\"payload\", jsonstr);\n        });\n    }\n    onOpen(callback) {\n        this.events.on(\"open\", () => __awaiter(this, void 0, void 0, function* () {\n            log.logDebug(`>>> ws opened: `);\n            yield callback();\n        }));\n    }\n}\nexports.OKXWalletConnector = OKXWalletConnector;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ConnectionManager = void 0;\nconst connect_1 = require(\"./connect\");\nconst constants_1 = require(\"./constants\");\nconst events_1 = require(\"events\");\nconst storage_1 = require(\"./storage\");\nconst utils_1 = require(\"../utils/utils\");\nconst crypto_1 = require(\"../crypto/crypto\");\nconst jwt_1 = require(\"./jwt\");\nconst safejson_1 = require(\"../utils/safejson\");\nconst log = __importStar(require(\"../utils/log\"));\nclass ConnectionManager {\n    constructor() {\n        this.events = new events_1.EventEmitter();\n        // local storage\n        this.connectStorage = new storage_1.Storage(constants_1.OKXCONNECTOR_CACHE_KEY); // 目前没有区分project id\n        this.crypto = new crypto_1.SessionCrypto();\n        this.jwtKeyPair = this.getCachedJWTKeyPair();\n        this.saveJWTKeyPair(this.jwtKeyPair);\n        // wss connection\n        this.connector = new connect_1.OKXWalletConnector(constants_1.OKXCONNECTOR_WS_URL);\n        // connection state\n        this.sendEnable = false;\n        this.packageId = 0;\n        this.connectedWalletPK = '';\n        this.currentTopic = '';\n        log.logDebug(`this.connectedWalletPK  constructor   ${this.connectedWalletPK}`);\n    }\n    saveCryptoKeyPair(keyPair) {\n        let cacheInfo = (0, safejson_1.safeJsonStringify)(keyPair);\n        this.connectStorage.saveContent(cacheInfo, constants_1.OKXCONNECTOR_CRYPTO_KEY);\n    }\n    getCachedCryptoKeyPair() {\n        const kp = this.connectStorage.getItem(constants_1.OKXCONNECTOR_CRYPTO_KEY);\n        const content = kp === null || kp === void 0 ? void 0 : kp.content;\n        if (typeof content == 'string') {\n            log.logDebug('get cached crypto key:');\n            log.logDebug(content);\n            let keyPairInfo = (0, safejson_1.safeJsonParse)(content);\n            return keyPairInfo;\n        }\n        else {\n            this.connectStorage.clearCache();\n        }\n        return null;\n    }\n    saveJWTKeyPair(keyPair) {\n        var strkeyPair = {\n            publicKey: (0, utils_1.toHexString)(keyPair.publicKey),\n            secretKey: (0, utils_1.toHexString)(keyPair.secretKey)\n        };\n        log.logDebug('save jwt kp');\n        let cacheInfo = (0, safejson_1.safeJsonStringify)(strkeyPair);\n        log.logDebug(cacheInfo);\n        this.connectStorage.saveContent(cacheInfo, constants_1.OKXCONNECTOR_JWT_KEY);\n    }\n    getCachedJWTKeyPair() {\n        const kp = this.connectStorage.getItem(constants_1.OKXCONNECTOR_JWT_KEY);\n        const content = kp === null || kp === void 0 ? void 0 : kp.content;\n        if (typeof content == 'string') {\n            log.logDebug('get cached jwt kp:');\n            log.logDebug(content);\n            let strKeyPairInfo = (0, safejson_1.safeJsonParse)(content);\n            log.logDebug('save jwt kp');\n            log.logDebug(strKeyPairInfo);\n            var keyPair = {\n                publicKey: (0, utils_1.hexToByteArray)(strKeyPairInfo.publicKey),\n                secretKey: (0, utils_1.hexToByteArray)(strKeyPairInfo.secretKey)\n            };\n            return keyPair;\n        }\n        else {\n            return (0, jwt_1.generateKeyPair)();\n        }\n    }\n    isWalletPKReady() {\n        log.logDebug(`isWalletPKReady  ===> ${this.connectedWalletPK}`);\n        return this.connectedWalletPK.length > 0;\n    }\n    makeJWT(topic) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield (0, jwt_1.signJWT)(topic, constants_1.OKXCONNECTOR_JWT_SIDE, constants_1.OKXCONNECTOR_JWT_TTL, // 24h\n            this.jwtKeyPair);\n        });\n    }\n    parsePackage(input_1) {\n        return __awaiter(this, arguments, void 0, function* (input, ignoreACK = false) {\n            var _a;\n            const msgId = parseInt(input.id);\n            if (msgId > this.packageId) {\n                this.packageId = msgId;\n            }\n            this.events.emit(input.id, input);\n            // send back ACK\n            if (!ignoreACK) {\n                yield this.sendACK(input.id, true);\n                this.packageId += 1;\n                let topic = (_a = this.connectStorage.getItem(constants_1.OKXCONNECTOR_TOKEN_CACHE)) === null || _a === void 0 ? void 0 : _a.content;\n                if (topic) {\n                    yield this.sendReceive(this.packageId.toString(), input.id, topic);\n                }\n            }\n        });\n    }\n    restoreConnect(topic) {\n        return __awaiter(this, void 0, void 0, function* () {\n            log.logDebug(`connectionManager  restoreConenct   ${topic}`);\n            if ((typeof topic !== 'string') || topic.length === 0) {\n                throw new Error('CONNECTION: invalid topic');\n            }\n            log.logDebug(`connectionManager  restoreConenct   disconnect`);\n            yield this.disconnect(true);\n            this.connectStorage.saveContent(topic, constants_1.OKXCONNECTOR_TOKEN_CACHE);\n            log.logDebug(`connectionManager  restoreConenct   conect`);\n            yield this.connect(true);\n        });\n    }\n    getConnectInfo() {\n        var topic = (0, utils_1.generateTopic)();\n        log.logDebug(`generate topic token: ${topic}`);\n        this.currentTopic = topic;\n        const info = {\n            channelId: topic,\n            clientId: this.crypto.stringifyKeypair().publicKey,\n        };\n        return info;\n    }\n    connect() {\n        return __awaiter(this, arguments, void 0, function* (fromRestore = false) {\n            let lastConnectId = this.connectStorage.getItem(constants_1.OKXCONNECTOR_TOKEN_CACHE);\n            //1. generate topic & jwt\n            var topic = this.currentTopic;\n            log.logDebug(`generate topic token: ${topic}`);\n            // crypto keypair\n            if (fromRestore) {\n                if (typeof lastConnectId !== 'undefined' && lastConnectId !== null) {\n                    log.logDebug(`read last connect id: ${lastConnectId}`);\n                    topic = lastConnectId.content;\n                }\n                var cachedSenderPublicKey = this.connectStorage.getItem(constants_1.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);\n                if (cachedSenderPublicKey) {\n                    this.connectedWalletPK = cachedSenderPublicKey.content;\n                }\n                // 只有重连场景下才读缓存并重新覆盖crypto对象\n                const keyPairInfo = this.getCachedCryptoKeyPair();\n                this.crypto = new crypto_1.SessionCrypto(keyPairInfo);\n            }\n            this.saveCryptoKeyPair(this.crypto.stringifyKeypair());\n            this.connectStorage.saveContent(topic, constants_1.OKXCONNECTOR_TOKEN_CACHE);\n            var jwtToken = yield this.makeJWT(topic);\n            log.logDebug(`generate jwt token: ${jwtToken}`);\n            this.connectStorage.saveContent(jwtToken, 'jwt');\n            // 1. 收到open事件就会进行login和subscribe流程\n            this.connector.onOpen(() => __awaiter(this, void 0, void 0, function* () {\n                log.logDebug(`1. connector on open`);\n                //2. send jwt to login\n                this.events.once(this.packageId.toString(), () => __awaiter(this, void 0, void 0, function* () {\n                    // ack\n                    this.packageId += 1;\n                    //3. send subscribe\n                    this.events.once(this.packageId.toString(), () => __awaiter(this, void 0, void 0, function* () {\n                        // ack\n                        this.packageId += 1;\n                        log.logDebug(`4. subscribe callback then send fetch: ${this.packageId}`);\n                        // 4. fetch messages\n                        yield this.sendFetchAndConsumeMessages(this.packageId.toString(), topic);\n                    }));\n                    log.logDebug(`3. login callback then send subscribe: ${this.packageId}`);\n                    yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                        log.logDebug('CONNECT: reconnect before send');\n                        yield this.connector.connect();\n                    }), {\n                        id: this.packageId.toString(),\n                        jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                        method: constants_1.CONNECT_METHOD_SUB,\n                        params: {\n                            topic: topic\n                        }\n                    });\n                }));\n                log.logDebug(`2. login called`);\n                yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                    log.logDebug('CONNECT: reconnect before send');\n                    yield this.connector.connect();\n                }), {\n                    id: this.packageId.toString(),\n                    jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                    method: constants_1.CONNECT_METHOD_LOGIN,\n                    params: {\n                        token: jwtToken\n                    }\n                });\n                // 4. listen when dapp back to front, receive wallet public key\n                this.connector.addPackageParse((event) => {\n                    var _a;\n                    log.logDebug(`connect: parse package`);\n                    log.logDebug(event);\n                    if (!(\"params\" in event) || !(\"data\" in event[\"params\"])) {\n                        log.logDebug('connect: TEST: received msg');\n                        this.parsePackage(event, true);\n                        return;\n                    }\n                    let rawMsg = (_a = event.params.data) === null || _a === void 0 ? void 0 : _a.message;\n                    if (typeof rawMsg !== 'undefined') {\n                        rawMsg = rawMsg.replace(/'/g, '\"');\n                        let parsedMessage = (0, safejson_1.safeJsonParse)(rawMsg);\n                        if (typeof parsedMessage !== 'string' && \"clientId\" in parsedMessage && parsedMessage.clientId && parsedMessage.clientId.length > 0) {\n                            this.connectedWalletPK = parsedMessage.clientId;\n                            log.logDebug(`this.connectedWalletPK  addPackageParse   ${this.connectedWalletPK}`);\n                            this.connectStorage.saveContent(this.connectedWalletPK, constants_1.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);\n                        }\n                    }\n                    // ignore receive echo\n                    this.parsePackage(event, event.method === constants_1.CONNECT_METHOD_RECEIVE);\n                });\n            }));\n            yield this.connector.connect();\n            const info = {\n                channelId: topic,\n                clientId: this.crypto.stringifyKeypair().publicKey,\n            };\n            return info;\n        });\n    }\n    disconnect() {\n        return __awaiter(this, arguments, void 0, function* (fromRestore = false) {\n            yield this.connector.disconnect();\n            //clean cached topic\n            //如果是恢复连接，就不清理解密public key\n            this.connectStorage.clearCache(constants_1.OKXCONNECTOR_TOKEN_CACHE);\n            if (!fromRestore) {\n                this.connectStorage.clearCache(constants_1.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);\n                this.connectedWalletPK = '';\n            }\n        });\n    }\n    addListenerOnce(id, success) {\n        this.events.once(id, () => __awaiter(this, void 0, void 0, function* () {\n            // ack\n        }));\n    }\n    addListener(event, success, fail) {\n        this.connector.addListener((0, safejson_1.safeJsonStringify)(event), (rawMsg) => {\n            // if (this.isWalletPKReady()) {\n            //    throw new Error('connection not finish')\n            // }\n            rawMsg = rawMsg.replace(/'/g, '\"');\n            log.logDebug(`addListener ===> ${rawMsg}`);\n            if (typeof rawMsg !== 'undefined') {\n                var msgObj = (0, safejson_1.safeJsonParse)(rawMsg);\n                var msg = msgObj.message;\n                if (msgObj.clientId && msgObj.clientId.length > 0) {\n                    this.connectedWalletPK = msgObj.clientId;\n                    this.connectStorage.saveContent(this.connectedWalletPK, constants_1.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE);\n                    log.logDebug(`this.connectedWalletPK  addListener   ${this.connectedWalletPK}`);\n                }\n                var result = this.crypto.decrypt(msg, this.connectedWalletPK);\n                log.logDebug(`addListener ===> ${result}`);\n                return result;\n            }\n        }, success, fail);\n    }\n    send(msg) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // 从msg构建传输层包结构\n            log.logDebug(`messagesend =====> ${msg}`);\n            if (!this.isWalletPKReady()) {\n                // TODO: channel not ready\n                throw new Error('connection not finish');\n            }\n            let message = this.crypto.encrypt(msg, this.connectedWalletPK);\n            // topic只维护一份\n            let topic = this.connectStorage.getItem(constants_1.OKXCONNECTOR_TOKEN_CACHE);\n            const payload = {\n                id: this.packageId.toString(),\n                method: constants_1.CONNECT_METHOD_PUBLISH,\n                jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                params: {\n                    message: {\n                        // messageId: hashKey(message,BASE64), // TODO:make message id from message\n                        messageId: Date.now().toString(), // TODO:make message id from message\n                        topic: topic === null || topic === void 0 ? void 0 : topic.content,\n                        message: message,\n                        ttl: constants_1.OKXCONNECTOR_MESSAGE_TTL\n                    }\n                } // crypted\n            };\n            yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                log.logDebug('CONNECT: reconnect before send');\n                yield this.connector.connect();\n            }), payload);\n            this.packageId += 1;\n            return this.packageId;\n        });\n    }\n    sendACK(msgId_1, success_1) {\n        return __awaiter(this, arguments, void 0, function* (msgId, success, reason = undefined) {\n            if (success === true) {\n                const payload = {\n                    id: msgId,\n                    jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                    result: true\n                };\n                yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                    log.logDebug('CONNECT: reconnect before send');\n                    yield this.connector.connect();\n                }), payload);\n            }\n            else if (reason) {\n                const payload = {\n                    id: this.packageId.toString(),\n                    jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                    error: {\n                        code: reason.code, //int\n                        message: reason.message\n                    }\n                };\n                yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                    log.logDebug('CONNECT: reconnect before send');\n                    yield this.connector.connect();\n                }), payload);\n            }\n        });\n    }\n    // send receive\n    sendReceive(msgId, messageId, topic) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const payload = {\n                id: msgId,\n                jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                method: constants_1.CONNECT_METHOD_RECEIVE,\n                params: {\n                    data: {\n                        messageId: messageId,\n                        topic: topic\n                    }\n                }\n            };\n            yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                log.logDebug('CONNECT: reconnect before send');\n                yield this.connector.connect();\n            }), payload);\n        });\n    }\n    // send receive\n    // 1. fetch all \n    // 2. send back receive\n    // 3. check has more, if so, repeat from 1st step\n    sendFetchAndConsumeMessages(msgId, topic) {\n        return __awaiter(this, void 0, void 0, function* () {\n            //1. send fetch\n            this.events.once(msgId, (fetchedMessages) => __awaiter(this, void 0, void 0, function* () {\n                var _a, _b, _c;\n                //2. consume received messages\n                if (fetchedMessages.result) {\n                    var hasMore = fetchedMessages.result.hasMore;\n                    var receivedMsgs = fetchedMessages.result.data;\n                    for (let i = 0; i < receivedMsgs.length; i++) {\n                        let msg = receivedMsgs[i];\n                        this.packageId += 1;\n                        let messageId = msg.messageId;\n                        let msgTopic = msg.topic;\n                        if (msgTopic == topic) {\n                            yield this.connector.getMsgPayloadFromHistory(msg);\n                            // 如果未推送记录中topic与当前topic相同，则回receive\n                            yield this.sendReceive(this.packageId.toString(), messageId, topic);\n                        }\n                    }\n                    // 3. 检查hasMore, 如果未完全拉取，则继续请求fetch message\n                    if (hasMore) {\n                        const cachedTopic = (_a = this.connectStorage.getItem(constants_1.OKXCONNECTOR_TOKEN_CACHE)) === null || _a === void 0 ? void 0 : _a.content;\n                        this.packageId += 1;\n                        yield this.sendFetchAndConsumeMessages(this.packageId.toString(), topic);\n                    }\n                }\n                else {\n                    log.logDebug(`CONNECT: get error rsp ${(_b = fetchedMessages.error) === null || _b === void 0 ? void 0 : _b.code} : ${(_c = fetchedMessages.error) === null || _c === void 0 ? void 0 : _c.message}`);\n                }\n            }));\n            log.logDebug('5. send fetch more');\n            const payload = {\n                id: msgId,\n                jsonrpc: constants_1.CONNECT_JSONRPC_VER,\n                method: constants_1.CONNECT_METHOD_FETCHMSG,\n                params: {\n                    data: {\n                        topic: topic\n                    }\n                }\n            };\n            yield this.connector.send(() => __awaiter(this, void 0, void 0, function* () {\n                log.logDebug('CONNECT: reconnect before send');\n                yield this.connector.connect();\n            }), payload);\n        });\n    }\n    // test api\n    getCryptoInfo() {\n        var _a;\n        const keyPairInfo = this.crypto.stringifyKeypair();\n        const jwt = this.connectStorage.getItem('jwt');\n        return {\n            kp: keyPairInfo,\n            topic: (_a = this.connectStorage.getItem(constants_1.OKXCONNECTOR_TOKEN_CACHE)) === null || _a === void 0 ? void 0 : _a.content,\n            jwt: jwt === null || jwt === void 0 ? void 0 : jwt.content\n        };\n    }\n    cleanCache() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.connectStorage.clearCache();\n            // await this.disconnect()\n        });\n    }\n}\nexports.ConnectionManager = ConnectionManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ConnectorState = exports.CONNECT_METHOD_FETCHMSG = exports.CONNECT_METHOD_RECEIVE = exports.CONNECT_METHOD_UNSUB = exports.CONNECT_METHOD_SUB = exports.CONNECT_METHOD_PUBLISH = exports.CONNECT_METHOD_LOGIN = exports.CONNECT_METHOD_PUSH = exports.CONNECT_JSONRPC_VER = exports.OKXCONNECTOR_MESSAGE_TTL = exports.OKXCONNECTOR_JWT_TTL = exports.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE = exports.OKXCONNECTOR_TOKEN_CACHE = exports.OKXCONNECTOR_JWT_KEY = exports.OKXCONNECTOR_CRYPTO_KEY = exports.OKXCONNECTOR_CACHE_KEY = exports.OKXCONNECTOR_JWT_SIDE = exports.OKXCONNECTOR_WS_URL = exports.EVENT_EMITTER_MAX_LISTENERS = void 0;\nexports.EVENT_EMITTER_MAX_LISTENERS = 10;\nexports.OKXCONNECTOR_WS_URL = \"wss://test-walletreplay.okg.com/ws/v1/wallet-connect-relay\";\nexports.OKXCONNECTOR_JWT_SIDE = \"wallet\";\nexports.OKXCONNECTOR_CACHE_KEY = \"test_key\";\nexports.OKXCONNECTOR_CRYPTO_KEY = \"test_crypto_key\";\nexports.OKXCONNECTOR_JWT_KEY = \"test_jwt_key\";\nexports.OKXCONNECTOR_TOKEN_CACHE = \"test_token\";\nexports.OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE = \"test_sender_publicKey\";\nexports.OKXCONNECTOR_JWT_TTL = 86400000;\nexports.OKXCONNECTOR_MESSAGE_TTL = 300000;\n// --------------- JSON RPC ---------------\nexports.CONNECT_JSONRPC_VER = \"2.0\";\n// --------------- ws methods -------------\nexports.CONNECT_METHOD_PUSH = \"push\";\nexports.CONNECT_METHOD_LOGIN = \"login\";\nexports.CONNECT_METHOD_PUBLISH = \"publish\";\nexports.CONNECT_METHOD_SUB = \"subscribe\";\nexports.CONNECT_METHOD_UNSUB = \"unsubscribe\";\nexports.CONNECT_METHOD_RECEIVE = \"receive\";\nexports.CONNECT_METHOD_FETCHMSG = \"fetchMessages\";\nexports.ConnectorState = {\n    InitState: 0,\n    Connecting: 1,\n    Connected: 2,\n    Disconnected: 3,\n};\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Engine = void 0;\nconst call_for_success_1 = require(\"../utils/call-for-success\");\nconst safejson_1 = require(\"../utils/safejson\");\nconst log_1 = require(\"../utils/log\");\nclass Engine {\n    constructor(connectionManager) {\n        this.pendingRequests = new Map();\n        this.disconnectListener = [];\n        this.connectionManager = connectionManager;\n        this.connectionManager.addListener(\"ton_sdk_response\", (event, msg) => {\n            var jsonResponse = (0, safejson_1.safeJsonParse)(msg);\n            this.handleResponse(event, jsonResponse);\n        }, function () {\n        });\n    }\n    addDisconnectListener(disconnecter) {\n        this.disconnectListener.push(disconnecter);\n    }\n    disconnect() {\n        this.pendingRequests.clear();\n    }\n    getRequestId() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const requestId = Date.now().toString();\n            (0, log_1.logDebug)(`getRequestId   =====>   ${requestId}`);\n            return requestId;\n        });\n    }\n    bindRequestForPromise(requestId, resolve) {\n        this.pendingRequests.set(requestId, resolve);\n    }\n    send(request, resolve, option) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const requestId = yield this.getRequestId();\n            (0, call_for_success_1.callForSuccess)(() => this.connectionManager.send(JSON.stringify(Object.assign(Object.assign({}, request), { requestId: requestId }))), option);\n            this.bindRequestForPromise(requestId, resolve);\n        });\n    }\n    handleResponse(event, response) {\n        (0, log_1.logDebug)(`handleResponse  ======> ${(0, safejson_1.safeJsonStringify)(response)}`);\n        if (\"requestId\" in response) {\n            (0, log_1.logDebug)(\"handleResponse  ===> in response\");\n            let requestId = response.requestId;\n            const resolve = this.pendingRequests.get(requestId);\n            if (resolve) {\n                (0, log_1.logDebug)(\"handleResponse  ===> find resolve\", resolve);\n                resolve(response);\n                // 从pendingRequests中删除这个Promise\n                this.pendingRequests.delete(requestId);\n            }\n            else {\n                (0, log_1.logDebug)(\"handleResponse  ===>  not find resolve\");\n                if (response.method === \"disconnect\") {\n                    this.disconnectListener.forEach(listener => listener());\n                    this.disconnectListener = [];\n                    this.disconnect();\n                }\n            }\n        }\n    }\n}\nexports.Engine = Engine;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MULTICODEC_ED25519_LENGTH = exports.MULTICODEC_ED25519_HEADER = exports.MULTICODEC_ED25519_BASE = exports.MULTICODEC_ED25519_ENCODING = exports.DID_METHOD = exports.DID_PREFIX = exports.DID_DELIMITER = exports.KEY_PAIR_SEED_LENGTH = exports.DATA_ENCODING = exports.JSON_ENCODING = exports.JWT_ENCODING = exports.JWT_DELIMITER = exports.JWT_IRIDIUM_TYP = exports.JWT_IRIDIUM_ALG = exports.JWTHeaderType = void 0;\nexports.generateKeyPair = generateKeyPair;\nexports.decodeJSON = decodeJSON;\nexports.encodeJSON = encodeJSON;\nexports.encodeIss = encodeIss;\nexports.decodeIss = decodeIss;\nexports.encodeSig = encodeSig;\nexports.decodeSig = decodeSig;\nexports.encodeData = encodeData;\nexports.decodeData = decodeData;\nexports.encodeJWT = encodeJWT;\nexports.decodeJWT = decodeJWT;\nexports.signJWT = signJWT;\nexports.verifyJWT = verifyJWT;\nconst ed25519 = __importStar(require(\"@stablelib/ed25519\"));\nconst to_string_1 = require(\"uint8arrays/to-string\");\nconst from_string_1 = require(\"uint8arrays/from-string\");\nconst safejson_1 = require(\"../utils/safejson\");\nconst utils_1 = require(\"../utils/utils\");\nconst tweetnacl_1 = __importDefault(require(\"tweetnacl\"));\nconst log = __importStar(require(\"../utils/log\"));\nexports.JWTHeaderType = \"dapp\";\nexports.JWT_IRIDIUM_ALG = \"EdDSA\";\nexports.JWT_IRIDIUM_TYP = \"JWT\";\nexports.JWT_DELIMITER = \".\";\nexports.JWT_ENCODING = \"base64url\";\nexports.JSON_ENCODING = \"utf8\";\nexports.DATA_ENCODING = \"utf8\";\nexports.KEY_PAIR_SEED_LENGTH = 32;\nexports.DID_DELIMITER = \":\";\nexports.DID_PREFIX = \"did\";\nexports.DID_METHOD = \"key\";\nexports.MULTICODEC_ED25519_ENCODING = \"base58btc\";\nexports.MULTICODEC_ED25519_BASE = \"z\";\nexports.MULTICODEC_ED25519_HEADER = \"K36\";\nexports.MULTICODEC_ED25519_LENGTH = 32;\nfunction generateKeyPair() {\n    // let local_seed = randomBytes(KEY_PAIR_SEED_LENGTH)\n    // return ed25519.generateKeyPairFromSeed(local_seed);\n    return tweetnacl_1.default.sign.keyPair();\n}\nfunction decodeJSON(str) {\n    return (0, safejson_1.safeJsonParse)((0, to_string_1.toString)((0, from_string_1.fromString)(str, exports.JWT_ENCODING), exports.JSON_ENCODING));\n}\nfunction encodeJSON(val) {\n    return (0, to_string_1.toString)((0, from_string_1.fromString)((0, safejson_1.safeJsonStringify)(val), exports.JSON_ENCODING), exports.JWT_ENCODING);\n}\n// ---------- Issuer ----------------------------------------------- //\n//  function base58Encode(buffer: Uint8Array) {\n//   const BASE58_ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';\n//   let num = BigInt('0x' + Array.from(buffer).map(byte => byte.toString(16).padStart(2, '0')).join(''));\n//   let result = '';\n//   while (num > 0) {\n//     let divmod = num % 58n;\n//     num = num / 58n;\n//     result = BASE58_ALPHABET.charAt(Number(divmod)) + result;\n//   }\n//   for (let byte of buffer) {\n//     if (byte === 0) result = '1' + result;\n//     else break;\n//   }\n//   return result;\n// }\nfunction encodeIss(publicKey) {\n    // const header = fromString(MULTICODEC_ED25519_HEADER, MULTICODEC_ED25519_ENCODING);\n    // log.logDebug(`header: ${toHexString(header)}`)\n    log.logDebug(`publicKey: ${(0, utils_1.toHexString)(publicKey)}`);\n    var publicKeyStr = (0, to_string_1.toString)(publicKey, exports.MULTICODEC_ED25519_ENCODING);\n    // var publicKeyStr58 =  bs58.encode(publicKey)\n    // log.logDebug(`publicKey base58: ${publicKeyStr}, ${publicKeyStr58}`)\n    // log.logDebug(`multi codec: ${multicodec}`)\n    return [exports.DID_PREFIX, exports.DID_METHOD, publicKeyStr].join(exports.DID_DELIMITER);\n}\nfunction decodeIss(issuer) {\n    const [prefix, method, multicodec] = issuer.split(exports.DID_DELIMITER);\n    if (prefix !== exports.DID_PREFIX || method !== exports.DID_METHOD) {\n        throw new Error(`Issuer must be a DID with method \"key\"`);\n    }\n    // 简化iss编码后multicodec直接用base58解码即可得到publicKey\n    // const base = multicodec.slice(0, 1);\n    // if (base !== MULTICODEC_ED25519_BASE) {\n    //   throw new Error(`Issuer must be a key in mulicodec format`);\n    // }\n    // const bytes = fromString(multicodec.slice(1), MULTICODEC_ED25519_ENCODING);\n    // const type = toString(bytes.slice(0, 2), MULTICODEC_ED25519_ENCODING);\n    // if (type !== MULTICODEC_ED25519_HEADER) {\n    //   throw new Error(`Issuer must be a public key with type \"Ed25519\"`);\n    // }\n    // const publicKey = bytes.slice(2);\n    const publicKey = (0, from_string_1.fromString)(multicodec, exports.MULTICODEC_ED25519_ENCODING);\n    if (publicKey.length !== exports.MULTICODEC_ED25519_LENGTH) {\n        throw new Error(`Issuer must be a public key with length 32 bytes`);\n    }\n    return publicKey;\n}\n// ---------- Signature ----------------------------------------------- //\nfunction encodeSig(bytes) {\n    return (0, to_string_1.toString)(bytes, exports.JWT_ENCODING);\n}\nfunction decodeSig(encoded) {\n    return (0, from_string_1.fromString)(encoded, exports.JWT_ENCODING);\n}\n// ---------- Data ----------------------------------------------- //\nfunction encodeData(params) {\n    return (0, from_string_1.fromString)([encodeJSON(params.header), encodeJSON(params.payload)].join(exports.JWT_DELIMITER), exports.DATA_ENCODING);\n}\nfunction decodeData(data) {\n    const params = (0, to_string_1.toString)(data, exports.DATA_ENCODING).split(exports.JWT_DELIMITER);\n    const header = decodeJSON(params[0]);\n    const payload = decodeJSON(params[1]);\n    return { header, payload };\n}\n// ---------- JWT ----------------------------------------------- //\nfunction encodeJWT(params) {\n    return [encodeJSON(params.header), encodeJSON(params.payload), encodeSig(params.signature)].join(exports.JWT_DELIMITER);\n}\nfunction decodeJWT(jwt) {\n    const params = jwt.split(exports.JWT_DELIMITER);\n    const header = decodeJSON(params[0]);\n    const payload = decodeJSON(params[1]);\n    const signature = decodeSig(params[2]);\n    const data = (0, from_string_1.fromString)(params.slice(0, 2).join(exports.JWT_DELIMITER), exports.DATA_ENCODING);\n    return { header, payload, signature, data };\n}\nfunction signJWT(sub_1, aud_1, ttl_1, keyPair_1) {\n    return __awaiter(this, arguments, void 0, function* (sub, aud, ttl, keyPair, iat = Math.floor(Date.now())) {\n        const header = { alg: exports.JWT_IRIDIUM_ALG, typ: exports.JWT_IRIDIUM_TYP };\n        const iss = encodeIss(keyPair.publicKey);\n        const exp = iat + ttl;\n        const act = \"authenticate user\";\n        const payload = { iss, sub, aud, act, iat, exp };\n        const data = encodeData({ header, payload });\n        // const signature = ed25519.sign(keyPair.secretKey, data);\n        log.logDebug(`get sec kp: ${keyPair.secretKey} {${keyPair.secretKey.length}}`);\n        const signature = tweetnacl_1.default.sign.detached(data, keyPair.secretKey);\n        return encodeJWT({ header, payload, signature });\n    });\n}\nfunction verifyJWT(jwt) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { header, payload, data, signature } = decodeJWT(jwt);\n        if (header.alg !== exports.JWT_IRIDIUM_ALG || header.typ !== exports.JWT_IRIDIUM_TYP) {\n            throw new Error(\"JWT must use EdDSA algorithm\");\n        }\n        const publicKey = decodeIss(payload.iss);\n        return ed25519.verify(publicKey, data, signature);\n    });\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Storage = void 0;\nconst utils_1 = require(\"../utils/utils\");\nconst safejson_1 = require(\"../utils/safejson\");\nconst log = __importStar(require(\"../utils/log\"));\nclass Storage {\n    constructor(subKey) {\n        // 1. load data from local storage\n        const localStorage = (0, utils_1.resolveLocalStorage)();\n        this.subKey = subKey;\n        log.logDebug('--------get current local storage --------');\n        log.logDebug(localStorage);\n        const cacheStr = localStorage.getItem(Storage.cacheKey + subKey);\n        if (typeof cacheStr === \"undefined\" || cacheStr === null) {\n            log.logDebug(\"with no cache\");\n            this.cache = {};\n            return;\n        }\n        log.logDebug(cacheStr);\n        if ((cacheStr === null || cacheStr === void 0 ? void 0 : cacheStr.length) > 0) {\n            var cacheObj = (0, safejson_1.safeJsonParse)(cacheStr);\n            this.cache = cacheObj;\n        }\n        log.logDebug(`get cache obj: ${this.cache}`);\n        if (typeof this.cache === 'undefined' || this.cache == null) {\n            this.cache = {};\n        }\n    }\n    saveContent(content, key, id = '-') {\n        let item = {\n            id: id,\n            timestamp: Date.now().toString(),\n            content: content\n        };\n        this.saveItem(item, key);\n    }\n    saveItem(item, key) {\n        let localKey = Storage.cacheKey + this.subKey;\n        const localStorage = (0, utils_1.resolveLocalStorage)();\n        log.logDebug(this.cache);\n        log.logDebug(`get cache obj: ${this.cache}, ${key}, ${item}`);\n        this.cache[key] = item;\n        let totalCacheStr = (0, safejson_1.safeJsonStringify)(this.cache);\n        log.logDebug(`STORAGE: ${key} @ ${this.cache}`);\n        localStorage.setItem(localKey, totalCacheStr);\n    }\n    getItem(key) {\n        log.logDebug(`STORAGE: ${key} @ ${this.cache}`);\n        return this.cache[key];\n    }\n    clearCache(key = undefined) {\n        if (key === undefined) {\n            // clean all\n            this.cache = {};\n            let localKey = Storage.cacheKey + this.subKey;\n            localStorage.setItem(localKey, '');\n        }\n        else {\n            let localKey = Storage.cacheKey + this.subKey;\n            const localStorage = (0, utils_1.resolveLocalStorage)();\n            log.logDebug(this.cache);\n            this.cache[key] = null;\n            let totalCacheStr = (0, safejson_1.safeJsonStringify)(this.cache);\n            log.logDebug(`STORAGE: clean key ${key} @ ${this.cache}`);\n            localStorage.setItem(localKey, totalCacheStr);\n        }\n    }\n}\nexports.Storage = Storage;\nStorage.cacheKey = 'OKXStorageKey';\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SessionCrypto = void 0;\nconst tweetnacl_1 = __importDefault(require(\"tweetnacl\"));\nconst utils_1 = require(\"../utils/utils\");\nclass SessionCrypto {\n    constructor(keyPair = undefined) {\n        this.nonceLength = 24;\n        this.sessionKeyPair = keyPair ? this.createKeypairFromString(keyPair) : this.createKeypair();\n    }\n    createKeypair() {\n        return tweetnacl_1.default.box.keyPair();\n    }\n    createKeypairFromString(keyPair) {\n        return {\n            publicKey: (0, utils_1.hexToByteArray)(keyPair.publicKey),\n            secretKey: (0, utils_1.hexToByteArray)(keyPair.secretKey),\n        };\n    }\n    createNonce() {\n        return tweetnacl_1.default.randomBytes(this.nonceLength);\n    }\n    get keyPair() {\n        return this.sessionKeyPair;\n    }\n    encrypt(message, receiverPublicKey) {\n        const encodedMessage = new TextEncoder().encode(message);\n        const nonce = this.createNonce();\n        const encrypted = tweetnacl_1.default.box(encodedMessage, nonce, (0, utils_1.hexToByteArray)(receiverPublicKey), this.keyPair.secretKey);\n        var hexResult = (0, utils_1.toHexString)((0, utils_1.concatUint8Arrays)(nonce, encrypted));\n        var encodedResult = new TextEncoder().encode(hexResult);\n        return (0, utils_1.base64encode)(encodedResult, false);\n    }\n    decrypt(message, senderPublicKey) {\n        let base64Content = (0, utils_1.base64decode)(message, true);\n        let messageByteArray = base64Content.toUint8Array();\n        const [nonce, internalMessage] = (0, utils_1.splitToUint8Arrays)(messageByteArray, this.nonceLength);\n        const decrypted = tweetnacl_1.default.box.open(internalMessage, nonce, (0, utils_1.hexToByteArray)(senderPublicKey), this.keyPair.secretKey);\n        if (!decrypted) {\n            throw new Error(`Decryption error: \\n message: ${message.toString()} \\n sender pubkey: ${senderPublicKey.toString()} \\n keypair pubkey: ${this.keyPair.publicKey.toString()} \\n keypair secretkey: ${this.keyPair.secretKey.toString()}`);\n        }\n        return new TextDecoder().decode(decrypted);\n    }\n    stringifyKeypair() {\n        return {\n            publicKey: (0, utils_1.toHexString)(this.keyPair.publicKey),\n            secretKey: (0, utils_1.toHexString)(this.keyPair.secretKey)\n        };\n    }\n}\nexports.SessionCrypto = SessionCrypto;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WalletNotConnectedError = exports.WalletNotSupportFeatureError = exports.WalletAlreadyConnectedError = exports.UserRejectsError = exports.UnknownError = exports.OkxConnectError = void 0;\nvar okx_connect_error_1 = require(\"./okx-connect.error\");\nObject.defineProperty(exports, \"OkxConnectError\", { enumerable: true, get: function () { return okx_connect_error_1.OkxConnectError; } });\nvar unknown_error_1 = require(\"./unknown.error\");\nObject.defineProperty(exports, \"UnknownError\", { enumerable: true, get: function () { return unknown_error_1.UnknownError; } });\nvar user_rejects_error_1 = require(\"./user-rejects.error\");\nObject.defineProperty(exports, \"UserRejectsError\", { enumerable: true, get: function () { return user_rejects_error_1.UserRejectsError; } });\nvar wallet_already_connected_error_1 = require(\"./wallet-already-connected.error\");\nObject.defineProperty(exports, \"WalletAlreadyConnectedError\", { enumerable: true, get: function () { return wallet_already_connected_error_1.WalletAlreadyConnectedError; } });\nvar wallet_not_support_feature_error_1 = require(\"./wallet-not-support-feature.error\");\nObject.defineProperty(exports, \"WalletNotSupportFeatureError\", { enumerable: true, get: function () { return wallet_not_support_feature_error_1.WalletNotSupportFeatureError; } });\nvar wallet_not_connected_error_1 = require(\"./wallet-not-connected.error\");\nObject.defineProperty(exports, \"WalletNotConnectedError\", { enumerable: true, get: function () { return wallet_not_connected_error_1.WalletNotConnectedError; } });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OkxConnectError = void 0;\n/**\n * Base class for TonConnect errors. You can check if the error was triggered by the using `err instanceof TonConnectError`.\n */\nclass OkxConnectError extends Error {\n    get info() {\n        return '';\n    }\n    constructor(message) {\n        super(message);\n        this.message = `${OkxConnectError.prefix} ${this.constructor.name}${this.info ? ': ' + this.info : ''}${message ? '\\n' + message : ''}`;\n        Object.setPrototypeOf(this, OkxConnectError.prototype);\n    }\n}\nexports.OkxConnectError = OkxConnectError;\nOkxConnectError.prefix = '[OKX_CONNECT_SDK_ERROR]';\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UnknownError = void 0;\nconst okx_connect_error_1 = require(\"./okx-connect.error\");\n/**\n * Unhanded unknown error.\n */\nclass UnknownError extends okx_connect_error_1.OkxConnectError {\n}\nexports.UnknownError = UnknownError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserRejectsError = void 0;\nconst okx_connect_error_1 = require(\"./okx-connect.error\");\n/**\n * Thrown when user rejects the action in the wallet.\n */\nclass UserRejectsError extends okx_connect_error_1.OkxConnectError {\n    constructor(message) {\n        super(message);\n        Object.setPrototypeOf(this, UserRejectsError.prototype); // 手动设置原型链\n    }\n    get info() {\n        return 'User rejects the action in the wallet.';\n    }\n}\nexports.UserRejectsError = UserRejectsError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WalletAlreadyConnectedError = void 0;\nconst okx_connect_error_1 = require(\"./okx-connect.error\");\n/**\n * Thrown when wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection.\n */\nclass WalletAlreadyConnectedError extends okx_connect_error_1.OkxConnectError {\n    get info() {\n        return 'Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection.';\n    }\n}\nexports.WalletAlreadyConnectedError = WalletAlreadyConnectedError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WalletNotConnectedError = void 0;\nconst okx_connect_error_1 = require(\"./okx-connect.error\");\n/**\n * Thrown when send transaction or other protocol methods called while wallet is not connected.\n */\nclass WalletNotConnectedError extends okx_connect_error_1.OkxConnectError {\n    get info() {\n        return 'Send transaction or other protocol methods called while wallet is not connected.';\n    }\n}\nexports.WalletNotConnectedError = WalletNotConnectedError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WalletNotSupportFeatureError = void 0;\nconst okx_connect_error_1 = require(\"./okx-connect.error\");\n/**\n * Thrown when wallet doesn't support requested feature method.\n */\nclass WalletNotSupportFeatureError extends okx_connect_error_1.OkxConnectError {\n    get info() {\n        return \"Wallet doesn't support requested feature method.\";\n    }\n}\nexports.WalletNotSupportFeatureError = WalletNotSupportFeatureError;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./error\"), exports);\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DefaultStorage = void 0;\nconst web_api_1 = require(\"../utils/web-api\");\n/**\n * Default storage to save protocol data, uses `localStorage` if it is available. In Safari's private mode, it uses `InMemoryStorage`. In Node.js, it throws an error.\n */\nclass DefaultStorage {\n    constructor() {\n        this.localStorage = (0, web_api_1.tryGetLocalStorage)();\n    }\n    getItem(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.localStorage.getItem(key);\n        });\n    }\n    removeItem(key) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.localStorage.removeItem(key);\n        });\n    }\n    setItem(key, value) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.localStorage.setItem(key, value);\n        });\n    }\n}\nexports.DefaultStorage = DefaultStorage;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InMemoryStorage = void 0;\n/**\n * In memory storage like localStorage, but without persistence.\n * Uses as a fallback for localStorage in Safari's private mode.\n */\nclass InMemoryStorage {\n    static getInstance() {\n        if (!InMemoryStorage.instance) {\n            InMemoryStorage.instance = new InMemoryStorage();\n        }\n        return InMemoryStorage.instance;\n    }\n    constructor() {\n        this.storage = {};\n    }\n    get length() {\n        return Object.keys(this.storage).length;\n    }\n    clear() {\n        this.storage = {};\n    }\n    getItem(key) {\n        var _a;\n        return (_a = this.storage[key]) !== null && _a !== void 0 ? _a : null;\n    }\n    key(index) {\n        var _a;\n        const keys = Object.keys(this.storage);\n        if (index < 0 || index >= keys.length) {\n            return null;\n        }\n        return (_a = keys[index]) !== null && _a !== void 0 ? _a : null;\n    }\n    removeItem(key) {\n        delete this.storage[key];\n    }\n    setItem(key, value) {\n        this.storage[key] = value;\n    }\n}\nexports.InMemoryStorage = InMemoryStorage;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.callForSuccess = callForSuccess;\nexports.delay = delay;\n/**\n * Function to call ton api until we get response.\n * Because ton network is pretty unstable we need to make sure response is final.\n * @param {T} fn - function to call\n * @param {CallForSuccessOptions} [options] - optional configuration options\n */\nfunction callForSuccess(fn, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        var _a, _b;\n        const attempts = (_a = options === null || options === void 0 ? void 0 : options.attempts) !== null && _a !== void 0 ? _a : 3;\n        const delayMs = (_b = options === null || options === void 0 ? void 0 : options.delayMs) !== null && _b !== void 0 ? _b : 800;\n        if (typeof fn !== 'function') {\n            throw new Error(`Expected a function, got ${typeof fn}`);\n        }\n        let i = 0;\n        let lastError;\n        while (i < attempts) {\n            try {\n                return yield fn();\n            }\n            catch (err) {\n                lastError = err;\n                i++;\n                if (i < attempts) {\n                    yield delay(delayMs);\n                }\n            }\n        }\n        throw lastError;\n    });\n}\n/**\n * Delays the execution of code for a specified number of milliseconds.\n * @param {number} timeout - The number of milliseconds to delay the execution.\n * @param {DelayOptions} [options] - Optional configuration options for the delay.\n * @return {Promise<void>} - A promise that resolves after the specified delay, or rejects if the delay is aborted.\n */\nfunction delay(timeout, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            var _a, _b;\n            if ((_a = options === null || options === void 0 ? void 0 : options.signal) === null || _a === void 0 ? void 0 : _a.aborted) {\n                reject(new Error('Delay aborted'));\n                return;\n            }\n            const timeoutId = setTimeout(() => resolve(), timeout);\n            (_b = options === null || options === void 0 ? void 0 : options.signal) === null || _b === void 0 ? void 0 : _b.addEventListener('abort', () => {\n                clearTimeout(timeoutId);\n                reject(new Error('Delay aborted'));\n            });\n        });\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.generateOKXLink = generateOKXLink;\nconst buffer_1 = require(\"buffer\");\nfunction generateOKXLink(params) {\n    let payloadStr = `{ \"protocolVer\":1, \"channelId\":\"${params.channelId}\", \"clientId\":\"${params.clientId}\", \"dAppInfo\":{ \"url\":\"url\", \"name\":\"testApp\", \"iconUrl\":\"url\" }, \"requestId\":\"${params.requestId}\", \"requests\":[ { \"name\":\"ton_addr\" }, { \"name\":\"ton_proof\", \"payload\":\"${params.testPayload}\"}], \"redirect\":\"${params.redirect}\" }`;\n    let base64Str = buffer_1.Buffer.from(payloadStr).toString('base64');\n    return `https://www.okx.com/download?deeplink=okx%3A%2F%2Fweb3%2Fwallet%2Fconnect%3Fparam%3D${base64Str}`;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.logDebug = logDebug;\nexports.logError = logError;\nexports.logWarning = logWarning;\nfunction logDebug(...args) {\n    if (typeof 'console' !== undefined) {\n        try {\n            console.debug('[TON_CONNECT_SDK]', ...args);\n        }\n        catch (_a) { }\n    }\n}\nfunction logError(...args) {\n    if (typeof 'console' !== undefined) {\n        try {\n            console.error('[TON_CONNECT_SDK]', ...args);\n        }\n        catch (_a) { }\n    }\n}\nfunction logWarning(...args) {\n    if (typeof 'console' !== undefined) {\n        try {\n            console.warn('[TON_CONNECT_SDK]', ...args);\n        }\n        catch (_a) { }\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.safeJsonParse = safeJsonParse;\nexports.safeJsonStringify = safeJsonStringify;\nconst log_1 = require(\"./log\");\nconst JSONStringify = (data) => JSON.stringify(data, (_, value) => (typeof value === \"bigint\" ? value.toString() + \"n\" : value));\n/*\n  Function to parse JSON.\n  If JSON has values in our custom format BigInt (strings with \"n\" character at the end), we just parse them to BigInt values.\n  If JSON has big number values, but not in our custom format, we copy it, and in a copy we convert those values to our custom format,\n  then parse them to BigInt values.\n  Other values (not big numbers and not our custom format BigInt values) are not affected and parsed as native JSON.parse() would parse them.\n*/\nconst JSONParse = (json) => {\n    /*\n      Big numbers are found and marked using Regex with this condition:\n      Number's length is bigger than 16 || Number's length is 16 and any numerical digit of the number is greater than that of the Number.MAX_SAFE_INTEGER\n      Additionally, it skips values that are strings (between double quotes).\n      */\n    // prettier-ignore\n    // eslint-disable-next-line no-useless-escape\n    const numbersBiggerThanMaxInt = /(?<!\")(?<=:)\\b(\\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))(?=[,\\}\\]]|$)/g;\n    const serializedData = json.replace(numbersBiggerThanMaxInt, (match) => `\"${match}n\"`);\n    return JSON.parse(serializedData, (_, value) => {\n        const isCustomFormatBigInt = typeof value === \"string\" && value.match(/^\\d+n$/);\n        if (isCustomFormatBigInt)\n            return BigInt(value.substring(0, value.length - 1));\n        return value;\n    });\n};\nfunction safeJsonParse(value) {\n    if (typeof value !== \"string\") {\n        (0, log_1.logDebug)(value);\n        throw new Error(`Cannot safe json parse value of type ${typeof value}`);\n    }\n    try {\n        return JSONParse(value);\n    }\n    catch (e) {\n        // eslint-disable-next-line no-console\n        console.error(\"safeJsonParse error:\", e);\n        return value;\n    }\n}\nfunction safeJsonStringify(value) {\n    return typeof value === \"string\" ? value : JSONStringify(value) || \"\";\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.removeUrlLastSlash = removeUrlLastSlash;\nexports.addPathToUrl = addPathToUrl;\nexports.openOKXDeeplinkWithFallback = openOKXDeeplinkWithFallback;\nfunction removeUrlLastSlash(url) {\n    if (url.slice(-1) === '/') {\n        return url.slice(0, -1);\n    }\n    return url;\n}\nfunction addPathToUrl(url, path) {\n    return removeUrlLastSlash(url) + '/' + path;\n}\nfunction openOKXDeeplinkWithFallback(deeplinkUrl) {\n    // if (isBelow16iOS()) {\n    //     window.open(deeplinkUrl);\n    // } else {\n    //     window.location.href = deeplinkUrl;\n    // }\n    window.open(deeplinkUrl);\n}\nfunction isBelow16iOS() {\n    const userAgent = navigator.userAgent;\n    // 检查是否是iOS设备\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    if (isIOS) {\n        // 提取iOS版本号\n        const match = userAgent.match(/OS (\\d+)_/);\n        if (match && match[1]) {\n            const version = parseInt(match[1], 10);\n            return version < 16;\n        }\n    }\n    // 如果不是iOS设备或无法确定版本,返回false\n    return false;\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RANDOM_LENGTH = exports.isBrowser = exports.resolveLocalStorage = exports.hasLocalStorage = exports.hasBuiltInWebSocket = exports.resolveWebSocketImplementation = void 0;\nexports.hexToByteArray = hexToByteArray;\nexports.toHexString = toHexString;\nexports.concatUint8Arrays = concatUint8Arrays;\nexports.splitToUint8Arrays = splitToUint8Arrays;\nexports.base64encode = base64encode;\nexports.base64decode = base64decode;\nexports.checkWSUrl = checkWSUrl;\nexports.hashKey = hashKey;\nexports.generateRandomBytes32 = generateRandomBytes32;\nexports.generateTopic = generateTopic;\nexports.generateDeepLink = generateDeepLink;\nconst tweetnacl_1 = __importDefault(require(\"tweetnacl\"));\nconst tweetnacl_util_1 = __importDefault(require(\"tweetnacl-util\"));\nconst from_string_1 = require(\"uint8arrays/from-string\");\nconst to_string_1 = require(\"uint8arrays/to-string\");\nconst sha256_1 = require(\"@stablelib/sha256\");\nconst safejson_1 = require(\"./safejson\");\nconst deeplink_1 = require(\"./deeplink\");\nconst log_1 = require(\"./log\");\nconst BASE16 = \"base16\";\nfunction hexToByteArray(hexString) {\n    if (hexString.length % 2 !== 0) {\n        throw new Error(`Cannot convert ${hexString} to bytesArray`);\n    }\n    const result = new Uint8Array(hexString.length / 2);\n    for (let i = 0; i < hexString.length; i += 2) {\n        result[i / 2] = parseInt(hexString.slice(i, i + 2), 16);\n    }\n    return result;\n}\nfunction toHexString(byteArray) {\n    let hexString = '';\n    byteArray.forEach(byte => {\n        hexString += ('0' + (byte & 0xff).toString(16)).slice(-2);\n    });\n    return hexString;\n}\nfunction concatUint8Arrays(buffer1, buffer2) {\n    const mergedArray = new Uint8Array(buffer1.length + buffer2.length);\n    mergedArray.set(buffer1);\n    mergedArray.set(buffer2, buffer1.length);\n    return mergedArray;\n}\nfunction splitToUint8Arrays(array, index) {\n    if (index >= array.length) {\n        throw new Error('Index is out of buffer');\n    }\n    const subArray1 = array.slice(0, index);\n    const subArray2 = array.slice(index);\n    return [subArray1, subArray2];\n}\nfunction encodeUint8Array(value, urlSafe) {\n    const encoded = tweetnacl_util_1.default.encodeBase64(value);\n    if (!urlSafe) {\n        return encoded;\n    }\n    return encodeURIComponent(encoded);\n}\nfunction decodeToUint8Array(value, urlSafe) {\n    if (urlSafe) {\n        value = decodeURIComponent(value);\n    }\n    return tweetnacl_util_1.default.decodeBase64(value);\n}\nfunction base64encode(value, urlSafe) {\n    let uint8Array;\n    if (value instanceof Uint8Array) {\n        uint8Array = value;\n    }\n    else {\n        if (typeof value !== 'string') {\n            value = (0, safejson_1.safeJsonStringify)(value);\n        }\n        uint8Array = tweetnacl_util_1.default.decodeUTF8(value);\n    }\n    return encodeUint8Array(uint8Array, urlSafe);\n}\nfunction base64decode(value, urlSafe) {\n    const decodedUint8Array = decodeToUint8Array(value, urlSafe);\n    return {\n        toString() {\n            return tweetnacl_util_1.default.encodeUTF8(decodedUint8Array);\n        },\n        toObject() {\n            try {\n                return (0, safejson_1.safeJsonParse)(tweetnacl_util_1.default.encodeUTF8(decodedUint8Array));\n            }\n            catch (e) {\n                return null;\n            }\n        },\n        toUint8Array() {\n            return decodedUint8Array;\n        }\n    };\n}\nfunction checkWSUrl(url) {\n    const match = url.match(new RegExp(/^\\w+:/, \"gi\"));\n    if (!match || !match.length) {\n        return false;\n    }\n    let scheme = match[0];\n    return new RegExp(\"^wss?:\").test(scheme);\n}\nconst resolveWebSocketImplementation = () => {\n    if (typeof WebSocket !== \"undefined\") {\n        return WebSocket;\n    }\n    else if (typeof global !== \"undefined\" && typeof global.WebSocket !== \"undefined\") {\n        return global.WebSocket;\n    }\n    else if (typeof window !== \"undefined\" && typeof window.WebSocket !== \"undefined\") {\n        return window.WebSocket;\n    }\n    else if (typeof self !== \"undefined\" && typeof self.WebSocket !== \"undefined\") {\n        return self.WebSocket;\n    }\n    return require(\"ws\");\n};\nexports.resolveWebSocketImplementation = resolveWebSocketImplementation;\nconst hasBuiltInWebSocket = () => typeof WebSocket !== \"undefined\" ||\n    (typeof global !== \"undefined\" && typeof global.WebSocket !== \"undefined\") ||\n    (typeof window !== \"undefined\" && typeof window.WebSocket !== \"undefined\") ||\n    (typeof self !== \"undefined\" && typeof self.WebSocket !== \"undefined\");\nexports.hasBuiltInWebSocket = hasBuiltInWebSocket;\nconst hasLocalStorage = () => (typeof global !== \"undefined\" && (typeof global.localStorage !== \"undefined\")) ||\n    (typeof window !== \"undefined\" && typeof window.localStorage !== \"undefined\");\nexports.hasLocalStorage = hasLocalStorage;\nconst resolveLocalStorage = () => {\n    if (typeof global !== \"undefined\" && typeof global.localStorage !== \"undefined\") {\n        return global.localStorage;\n    }\n    else if (typeof window !== \"undefined\" && typeof window.localStorage !== \"undefined\") {\n        return window.localStorage;\n    }\n    return localStorage;\n};\nexports.resolveLocalStorage = resolveLocalStorage;\nconst isBrowser = () => typeof window !== \"undefined\";\nexports.isBrowser = isBrowser;\nexports.RANDOM_LENGTH = 32;\nfunction hashKey(key, encode = BASE16) {\n    (0, log_1.logDebug)(`hash key called ${key}`);\n    const result = (0, sha256_1.hash)((0, from_string_1.fromString)(key, encode));\n    return (0, to_string_1.toString)(result, encode);\n}\nfunction generateRandomBytes32() {\n    return tweetnacl_1.default.randomBytes(exports.RANDOM_LENGTH);\n}\nfunction generateTopic() {\n    let randomBytes32 = generateRandomBytes32();\n    (0, log_1.logDebug)(`generate topic called ${randomBytes32}`);\n    return hashKey((0, to_string_1.toString)(randomBytes32, BASE16));\n}\nfunction generateDeepLink(param) {\n    return (0, deeplink_1.generateOKXLink)(param);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.tryGetLocalStorage = tryGetLocalStorage;\nconst in_memory_storage_1 = require(\"../storage/in-memory-storage\");\n/**\n * Returns `localStorage` if it is available. In Safari's private mode, it returns `InMemoryStorage`. In Node.js, it throws an error.\n */\nfunction tryGetLocalStorage() {\n    if (isLocalStorageAvailable()) {\n        return localStorage;\n    }\n    return in_memory_storage_1.InMemoryStorage.getInstance();\n}\n/**\n * Checks if `localStorage` is available.\n */\nfunction isLocalStorageAvailable() {\n    // We use a try/catch block because Safari's private mode throws an error when attempting to access localStorage.\n    try {\n        return typeof localStorage !== 'undefined';\n    }\n    catch (_a) {\n        return false;\n    }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ConnectionManager = exports.SessionCrypto = exports.utils = exports.OKXWalletConnector = exports.OKXTonConnect = void 0;\nvar ton_connect_1 = require(\"./ton/tonsdk/ton-connect\");\nObject.defineProperty(exports, \"OKXTonConnect\", { enumerable: true, get: function () { return ton_connect_1.OKXTonConnect; } });\nvar connect_1 = require(\"./core/connect/connect\");\nObject.defineProperty(exports, \"OKXWalletConnector\", { enumerable: true, get: function () { return connect_1.OKXWalletConnector; } });\nexports.utils = __importStar(require(\"./core/utils/utils\"));\nvar crypto_1 = require(\"./core/crypto/crypto\");\nObject.defineProperty(exports, \"SessionCrypto\", { enumerable: true, get: function () { return crypto_1.SessionCrypto; } });\nvar connectionManager_1 = require(\"./core/connect/connectionManager\");\nObject.defineProperty(exports, \"ConnectionManager\", { enumerable: true, get: function () { return connectionManager_1.ConnectionManager; } });\n__exportStar(require(\"./core/protocol\"), exports);\n__exportStar(require(\"./ton/tonsdk\"), exports);\n// export * from './ton/tonsdk'\n// window.OKWalletConnectSDK = {\n//     CONNECT: connect,\n//     TON: new tonsdk.OKXTonConnect({metaData: {\n//             name:\"测试dapp\",\n//             icon:\"\",\n//             url:\"\"\n//         }}),\n//     testCrypto: new SessionCrypto(),\n//     utils: utils,\n//     testCM: new ConnectionManager()\n// }\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./models\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CHAIN = void 0;\nvar CHAIN;\n(function (CHAIN) {\n    CHAIN[\"MAINNET\"] = \"-239\";\n    CHAIN[\"TESTNET\"] = \"-3\";\n})(CHAIN || (exports.CHAIN = CHAIN = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./request\"), exports);\n__exportStar(require(\"./connect-request\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CHAIN = void 0;\n__exportStar(require(\"./app-message\"), exports);\n__exportStar(require(\"./wallet-message\"), exports);\nvar CHAIN_1 = require(\"./CHAIN\");\nObject.defineProperty(exports, \"CHAIN\", { enumerable: true, get: function () { return CHAIN_1.CHAIN; } });\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./wallet-event\"), exports);\n__exportStar(require(\"./wallet-response\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CONNECT_ITEM_ERROR_CODES = exports.CONNECT_EVENT_ERROR_CODES = void 0;\nvar CONNECT_EVENT_ERROR_CODES;\n(function (CONNECT_EVENT_ERROR_CODES) {\n    CONNECT_EVENT_ERROR_CODES[CONNECT_EVENT_ERROR_CODES[\"UNKNOWN_ERROR\"] = 0] = \"UNKNOWN_ERROR\";\n    CONNECT_EVENT_ERROR_CODES[CONNECT_EVENT_ERROR_CODES[\"BAD_REQUEST_ERROR\"] = 1] = \"BAD_REQUEST_ERROR\";\n    CONNECT_EVENT_ERROR_CODES[CONNECT_EVENT_ERROR_CODES[\"USER_REJECTS_ERROR\"] = 3] = \"USER_REJECTS_ERROR\";\n    CONNECT_EVENT_ERROR_CODES[CONNECT_EVENT_ERROR_CODES[\"UNKNOWN_APP_ERROR\"] = 100] = \"UNKNOWN_APP_ERROR\";\n    CONNECT_EVENT_ERROR_CODES[CONNECT_EVENT_ERROR_CODES[\"METHOD_NOT_SUPPORTED\"] = 400] = \"METHOD_NOT_SUPPORTED\";\n})(CONNECT_EVENT_ERROR_CODES || (exports.CONNECT_EVENT_ERROR_CODES = CONNECT_EVENT_ERROR_CODES = {}));\nvar CONNECT_ITEM_ERROR_CODES;\n(function (CONNECT_ITEM_ERROR_CODES) {\n    CONNECT_ITEM_ERROR_CODES[CONNECT_ITEM_ERROR_CODES[\"UNKNOWN_ERROR\"] = 0] = \"UNKNOWN_ERROR\";\n    CONNECT_ITEM_ERROR_CODES[CONNECT_ITEM_ERROR_CODES[\"METHOD_NOT_SUPPORTED\"] = 400] = \"METHOD_NOT_SUPPORTED\";\n})(CONNECT_ITEM_ERROR_CODES || (exports.CONNECT_ITEM_ERROR_CODES = CONNECT_ITEM_ERROR_CODES = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CONNECT_ITEM_ERROR_CODES = exports.CONNECT_EVENT_ERROR_CODES = void 0;\nvar connect_event_1 = require(\"./connect-event\");\nObject.defineProperty(exports, \"CONNECT_EVENT_ERROR_CODES\", { enumerable: true, get: function () { return connect_event_1.CONNECT_EVENT_ERROR_CODES; } });\nObject.defineProperty(exports, \"CONNECT_ITEM_ERROR_CODES\", { enumerable: true, get: function () { return connect_event_1.CONNECT_ITEM_ERROR_CODES; } });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DISCONNECT_ERROR_CODES = void 0;\nvar DISCONNECT_ERROR_CODES;\n(function (DISCONNECT_ERROR_CODES) {\n    DISCONNECT_ERROR_CODES[DISCONNECT_ERROR_CODES[\"UNKNOWN_ERROR\"] = 0] = \"UNKNOWN_ERROR\";\n    DISCONNECT_ERROR_CODES[DISCONNECT_ERROR_CODES[\"BAD_REQUEST_ERROR\"] = 1] = \"BAD_REQUEST_ERROR\";\n    DISCONNECT_ERROR_CODES[DISCONNECT_ERROR_CODES[\"UNKNOWN_APP_ERROR\"] = 100] = \"UNKNOWN_APP_ERROR\";\n    DISCONNECT_ERROR_CODES[DISCONNECT_ERROR_CODES[\"METHOD_NOT_SUPPORTED\"] = 400] = \"METHOD_NOT_SUPPORTED\";\n})(DISCONNECT_ERROR_CODES || (exports.DISCONNECT_ERROR_CODES = DISCONNECT_ERROR_CODES = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DISCONNECT_ERROR_CODES = exports.SIGN_DATA_ERROR_CODES = exports.SEND_TRANSACTION_ERROR_CODES = void 0;\nvar send_transaction_rpc_response_1 = require(\"./send-transaction-rpc-response\");\nObject.defineProperty(exports, \"SEND_TRANSACTION_ERROR_CODES\", { enumerable: true, get: function () { return send_transaction_rpc_response_1.SEND_TRANSACTION_ERROR_CODES; } });\nvar sign_data_rpc_response_1 = require(\"./sign-data-rpc-response\");\nObject.defineProperty(exports, \"SIGN_DATA_ERROR_CODES\", { enumerable: true, get: function () { return sign_data_rpc_response_1.SIGN_DATA_ERROR_CODES; } });\nvar disconnect_rpc_response_1 = require(\"./disconnect-rpc-response\");\nObject.defineProperty(exports, \"DISCONNECT_ERROR_CODES\", { enumerable: true, get: function () { return disconnect_rpc_response_1.DISCONNECT_ERROR_CODES; } });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SEND_TRANSACTION_ERROR_CODES = void 0;\nvar SEND_TRANSACTION_ERROR_CODES;\n(function (SEND_TRANSACTION_ERROR_CODES) {\n    SEND_TRANSACTION_ERROR_CODES[SEND_TRANSACTION_ERROR_CODES[\"UNKNOWN_ERROR\"] = 0] = \"UNKNOWN_ERROR\";\n    SEND_TRANSACTION_ERROR_CODES[SEND_TRANSACTION_ERROR_CODES[\"BAD_REQUEST_ERROR\"] = 1] = \"BAD_REQUEST_ERROR\";\n    SEND_TRANSACTION_ERROR_CODES[SEND_TRANSACTION_ERROR_CODES[\"UNKNOWN_APP_ERROR\"] = 100] = \"UNKNOWN_APP_ERROR\";\n    SEND_TRANSACTION_ERROR_CODES[SEND_TRANSACTION_ERROR_CODES[\"USER_REJECTS_ERROR\"] = 3] = \"USER_REJECTS_ERROR\";\n    SEND_TRANSACTION_ERROR_CODES[SEND_TRANSACTION_ERROR_CODES[\"METHOD_NOT_SUPPORTED\"] = 400] = \"METHOD_NOT_SUPPORTED\";\n})(SEND_TRANSACTION_ERROR_CODES || (exports.SEND_TRANSACTION_ERROR_CODES = SEND_TRANSACTION_ERROR_CODES = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SIGN_DATA_ERROR_CODES = void 0;\nvar SIGN_DATA_ERROR_CODES;\n(function (SIGN_DATA_ERROR_CODES) {\n    SIGN_DATA_ERROR_CODES[SIGN_DATA_ERROR_CODES[\"UNKNOWN_ERROR\"] = 0] = \"UNKNOWN_ERROR\";\n    SIGN_DATA_ERROR_CODES[SIGN_DATA_ERROR_CODES[\"BAD_REQUEST_ERROR\"] = 1] = \"BAD_REQUEST_ERROR\";\n    SIGN_DATA_ERROR_CODES[SIGN_DATA_ERROR_CODES[\"UNKNOWN_APP_ERROR\"] = 100] = \"UNKNOWN_APP_ERROR\";\n    SIGN_DATA_ERROR_CODES[SIGN_DATA_ERROR_CODES[\"USER_REJECTS_ERROR\"] = 3] = \"USER_REJECTS_ERROR\";\n    SIGN_DATA_ERROR_CODES[SIGN_DATA_ERROR_CODES[\"METHOD_NOT_SUPPORTED\"] = 400] = \"METHOD_NOT_SUPPORTED\";\n})(SIGN_DATA_ERROR_CODES || (exports.SIGN_DATA_ERROR_CODES = SIGN_DATA_ERROR_CODES = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.standardDeeplink = exports.standardUniversalLink = exports.tonConnectSdkVersion = void 0;\nexports.tonConnectSdkVersion = '1';\nexports.standardUniversalLink = 'https://www.okx.com/download';\nexports.standardDeeplink = 'okx://web3/wallet/connect';\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = void 0;\n// export { IStorage } from '../../core/storage/storage.interface';\nvar ton_connect_1 = require(\"./ton-connect\");\nObject.defineProperty(exports, \"default\", { enumerable: true, get: function () { return ton_connect_1.OKXTonConnect; } });\n__exportStar(require(\"./models\"), exports);\n__exportStar(require(\"./tracker/tracker-constants\"), exports);\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./wallet\"), exports);\n__exportStar(require(\"./methods\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./connect\"), exports);\n__exportStar(require(\"./send-transaction\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.connectErrorsParser = void 0;\nconst protocol_1 = require(\"../../protocol\");\nconst protocol_2 = require(\"../../../core/protocol\");\nconst connectEventErrorsCodes = {\n    [protocol_1.CONNECT_EVENT_ERROR_CODES.UNKNOWN_ERROR]: protocol_2.UnknownError,\n    [protocol_1.CONNECT_EVENT_ERROR_CODES.USER_REJECTS_ERROR]: protocol_2.UserRejectsError,\n};\nclass ConnectErrorsParser {\n    parseError(error) {\n        let ErrorConstructor = protocol_2.UnknownError;\n        if (error.code in connectEventErrorsCodes) {\n            ErrorConstructor = connectEventErrorsCodes[error.code] || protocol_2.UnknownError;\n        }\n        return new ErrorConstructor(error.message);\n    }\n}\nexports.connectErrorsParser = new ConnectErrorsParser();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RpcParser = void 0;\nclass RpcParser {\n    isError(response) {\n        return 'error' in response;\n    }\n}\nexports.RpcParser = RpcParser;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sendTransactionParser = void 0;\nconst protocol_1 = require(\"../../protocol\");\nconst rpc_parser_1 = require(\"./rpc-parser\");\nconst protocol_2 = require(\"../../../core/protocol\");\nconst sendTransactionErrors = {\n    [protocol_1.SEND_TRANSACTION_ERROR_CODES.UNKNOWN_ERROR]: protocol_2.UnknownError,\n    [protocol_1.SEND_TRANSACTION_ERROR_CODES.USER_REJECTS_ERROR]: protocol_2.UserRejectsError,\n};\nclass SendTransactionParser extends rpc_parser_1.RpcParser {\n    convertToRpcRequest(request) {\n        return {\n            method: 'ton_sendTransaction',\n            params: request\n        };\n    }\n    parseAndThrowError(response) {\n        let ErrorConstructor = protocol_2.UnknownError;\n        if (response.error.code in sendTransactionErrors) {\n            ErrorConstructor = sendTransactionErrors[response.error.code] || protocol_2.UnknownError;\n        }\n        throw new ErrorConstructor(response.error.message);\n    }\n    convertFromRpcResponse(rpcResponse) {\n        return {\n            boc: rpcResponse.result.toString()\n        };\n    }\n}\nexports.sendTransactionParser = new SendTransactionParser();\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BridgeConnectionStorage = void 0;\nconst okx_connect_error_1 = require(\"../../../core/protocol/error/okx-connect.error\");\nclass BridgeConnectionStorage {\n    constructor(storage) {\n        this.storage = storage;\n        this.storeKey = 'okx-ton-connect-storage_bridge-connection';\n    }\n    storeConnection(connection) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.storage.setItem(this.storeKey, JSON.stringify(connection));\n        });\n    }\n    removeConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.storage.removeItem(this.storeKey);\n        });\n    }\n    getConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const stored = yield this.storage.getItem(this.storeKey);\n            if (!stored) {\n                return null;\n            }\n            let connection;\n            connection = JSON.parse(stored);\n            return connection;\n        });\n    }\n    getHttpConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const connection = yield this.getConnection();\n            if (!connection) {\n                throw new okx_connect_error_1.OkxConnectError('Trying to read HTTP connection source while nothing is stored');\n            }\n            return connection;\n        });\n    }\n    storeLastWalletEventId(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const connection = yield this.getConnection();\n            if (connection && ('connectEvent' in connection)) {\n                connection.lastWalletEventId = id;\n                return this.storeConnection(connection);\n            }\n        });\n    }\n    getLastWalletEventId() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const connection = yield this.getConnection();\n            if (connection && 'lastWalletEventId' in connection) {\n                return connection.lastWalletEventId;\n            }\n            return undefined;\n        });\n    }\n}\nexports.BridgeConnectionStorage = BridgeConnectionStorage;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BridgeProvider = void 0;\nconst bridge_connection_1 = require(\"./models/bridge-connection\");\nconst bridge_connection_storage_1 = require(\"../bridge-connection-storage\");\nconst url_1 = require(\"../../../../core/utils/url\");\nconst log_1 = require(\"../../../../core/utils/log\");\nconst connectionManager_1 = require(\"../../../../core/connect/connectionManager\");\nconst version_1 = require(\"../../constants/version\");\nconst engine_1 = require(\"../../../../core/connect/engine\");\nconst buffer_1 = require(\"buffer\");\nconst protocol_1 = require(\"../../../../core/protocol\");\nclass BridgeProvider {\n    constructor(storage) {\n        this.storage = storage;\n        this.type = 'http';\n        this.listeners = [];\n        this.connectManager = new connectionManager_1.ConnectionManager();\n        this.walletConnectionSource = { \"universalLink\": version_1.standardUniversalLink };\n        this.engine = new engine_1.Engine(this.connectManager);\n        this.openUniversalUrl = false;\n        this.connectionStorage = new bridge_connection_storage_1.BridgeConnectionStorage(storage);\n    }\n    static fromStorage(storage) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const bridgeConnectionStorage = new bridge_connection_storage_1.BridgeConnectionStorage(storage);\n            const connection = yield bridgeConnectionStorage.getHttpConnection();\n            if ((0, bridge_connection_1.isPendingConnectionHttp)(connection)) {\n                return null;\n            }\n            const provider = new BridgeProvider(storage);\n            provider.openUniversalUrl = connection.openUniversalUrl;\n            return provider;\n        });\n    }\n    connect(message, redirect, openUniversalUrl) {\n        return __awaiter(this, void 0, void 0, function* () {\n            (0, log_1.logDebug)('provider-----message>>>', message);\n            (0, log_1.logDebug)('provider-----redirect>>>', redirect);\n            (0, log_1.logDebug)('provider-----openUniversalUrl>>>', openUniversalUrl);\n            try {\n                const connectInfo = this.connectManager.getConnectInfo();\n                const requestId = yield this.engine.getRequestId();\n                this.openUniversalUrl = openUniversalUrl;\n                const connectRequest = {\n                    protocolVer: Number(version_1.tonConnectSdkVersion),\n                    topic: connectInfo.channelId,\n                    clientId: connectInfo.clientId,\n                    requestId: requestId,\n                    dAppInfo: message.dappInfo,\n                    requests: message.items,\n                    redirect: redirect !== null && redirect !== void 0 ? redirect : \"none\",\n                };\n                (0, log_1.logDebug)('provider-----connectRequest>>>', connectRequest);\n                const connectRequestStr = JSON.stringify(connectRequest);\n                (0, log_1.logDebug)('provider-----connectRequestStr>>>', connectRequestStr);\n                const base64Encoded = buffer_1.Buffer.from(connectRequestStr).toString('base64');\n                (0, log_1.logDebug)('provider-----base64Encoded>>>', base64Encoded);\n                const deeplinkUrl = `${version_1.standardDeeplink}?param=${base64Encoded}`;\n                (0, log_1.logDebug)('provider-----deeplinkUrl>>>', deeplinkUrl);\n                const deeplinkEncodeUrl = encodeURIComponent(deeplinkUrl);\n                const universalLink = version_1.standardUniversalLink;\n                (0, log_1.logDebug)('provider-----universalLink>>>', universalLink);\n                const fullUrl = `${universalLink}?deeplink=${deeplinkEncodeUrl}`;\n                (0, log_1.logDebug)('provider-----fullUrl>>>', fullUrl);\n                this.connectionStorage\n                    .storeConnection({\n                    type: 'http',\n                    connectionSource: this.walletConnectionSource,\n                    channelId: connectInfo.channelId,\n                    openUniversalUrl: openUniversalUrl,\n                })\n                    .then(() => __awaiter(this, void 0, void 0, function* () {\n                    var _a, _b;\n                    if (openUniversalUrl !== null && openUniversalUrl === true) {\n                        (0, url_1.openOKXDeeplinkWithFallback)(fullUrl);\n                        (0, log_1.logDebug)('跳转链接----->>>', fullUrl);\n                    }\n                    (_a = this.engine) === null || _a === void 0 ? void 0 : _a.bindRequestForPromise(requestId, this.connectListener.bind(this));\n                    //处理接收 钱包发起的断开连接\n                    (_b = this.engine) === null || _b === void 0 ? void 0 : _b.addDisconnectListener(this.disconnectListener.bind(this));\n                    yield this.connectManager.connect();\n                }));\n                return fullUrl;\n            }\n            catch (error) {\n                console.error('Error connecting:', error);\n                throw new protocol_1.OkxConnectError('connect error');\n            }\n        });\n    }\n    listen(callback) {\n        this.listeners.push(callback);\n        return () => (this.listeners = this.listeners.filter(listener => listener !== callback));\n    }\n    disconnectListener() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const disconnectMessage = {\n                event: 'disconnect',\n                requestId: Number(1),\n                payload: {},\n            };\n            this.listeners.forEach(listener => listener(disconnectMessage));\n            yield this.closeConnection();\n        });\n    }\n    connectListener(response) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const walletMessage = response;\n            (0, log_1.logDebug)('Wallet message received:', walletMessage);\n            //connect 与connecterror  disconnect\n            if (walletMessage.requestId !== undefined) {\n                const lastId = yield this.connectionStorage.getLastWalletEventId();\n                if (lastId !== undefined && Number(walletMessage.requestId) <= lastId) {\n                    (0, log_1.logError)(`Received event id (=${walletMessage.requestId}) must be greater than stored last wallet event id (=${lastId}) `);\n                    return;\n                }\n            }\n            // `this.listeners` might be modified in the event handler\n            const listeners = this.listeners;\n            if (walletMessage.method === 'connect') {\n                const tonAddrItem = walletMessage.payload.responses.find(item => item.name === 'ton_addr');\n                const tonProfItem = walletMessage.payload.responses.find(item => item.name === 'ton_proof');\n                const walletInfo = walletMessage.payload.wallet;\n                const tonDeviceInfo = {\n                    platform: walletInfo.platform,\n                    appName: walletInfo.appName,\n                    appVersion: walletInfo.appVersion,\n                    maxProtocolVersion: walletInfo.maxProtocolVersion,\n                    features: walletInfo.features.ton,\n                };\n                const itemArr = [];\n                if (tonAddrItem) {\n                    itemArr.push(tonAddrItem);\n                }\n                if (tonProfItem) {\n                    itemArr.push(tonProfItem);\n                }\n                const oldStorage = yield this.connectionStorage.getConnection();\n                const tonConnectInfo = {\n                    type: 'http',\n                    lastWalletEventId: Number(walletMessage.requestId),\n                    connectEvent: {\n                        event: 'connect',\n                        payload: {\n                            items: itemArr,\n                            device: tonDeviceInfo,\n                        },\n                    },\n                    connectionSource: this.walletConnectionSource,\n                    channelId: oldStorage === null || oldStorage === void 0 ? void 0 : oldStorage.channelId,\n                    openUniversalUrl: oldStorage === null || oldStorage === void 0 ? void 0 : oldStorage.openUniversalUrl,\n                };\n                (0, log_1.logDebug)('Wallet message --->>tonConnectInfo>>>:', tonConnectInfo);\n                yield this.connectionStorage.storeConnection(tonConnectInfo);\n                const successMessage = {\n                    event: 'connect',\n                    requestId: Number(walletMessage.requestId),\n                    payload: tonConnectInfo.connectEvent.payload,\n                };\n                (0, log_1.logDebug)('Wallet message --->>success>>>:', successMessage);\n                listeners.forEach(listener => listener(successMessage));\n            }\n            else if (walletMessage.method === 'connect_error') {\n                yield this.connectionStorage.storeLastWalletEventId(Number(walletMessage.requestId));\n                const errorMessage = {\n                    event: 'connect_error',\n                    requestId: Number(walletMessage.requestId),\n                    payload: walletMessage.payload,\n                };\n                listeners.forEach(listener => listener(errorMessage));\n            }\n        });\n    }\n    closeConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            (0, log_1.logDebug)('close connection');\n            this.listeners = [];\n            (_a = this.engine) === null || _a === void 0 ? void 0 : _a.disconnect();\n            yield ((_b = this.connectManager) === null || _b === void 0 ? void 0 : _b.disconnect());\n            yield this.connectionStorage.removeConnection();\n        });\n    }\n    restoreConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            (0, log_1.logDebug)(`provider  restoreConenct  `);\n            const storedConnection = yield this.connectionStorage.getHttpConnection();\n            if (!storedConnection) {\n                return;\n            }\n            if ((0, bridge_connection_1.isPendingConnectionHttp)(storedConnection)) {\n                return;\n            }\n            if (storedConnection.channelId) {\n                try {\n                    const successMessage = {\n                        event: 'connect',\n                        requestId: Number(0),\n                        payload: storedConnection.connectEvent.payload,\n                    };\n                    this.listeners.forEach(listener => listener(successMessage));\n                    const channelId = storedConnection.channelId;\n                    // TOOD 激活这个通道\n                    (0, log_1.logDebug)(`connectionManager  restoreConenctWithchannelId   ${channelId}`);\n                    yield this.connectManager.restoreConnect(channelId);\n                }\n                catch (e) {\n                    //清空本地数据\n                    yield this.closeConnection();\n                }\n            }\n            else {\n                //清空本地数据\n                yield this.closeConnection();\n            }\n        });\n    }\n    openOKXWallet() {\n        if (this.openUniversalUrl) {\n            const fullUrl = `${version_1.standardUniversalLink}?deeplink=${encodeURIComponent(version_1.standardDeeplink)}`;\n            (0, url_1.openOKXDeeplinkWithFallback)(fullUrl);\n        }\n    }\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve) => __awaiter(this, void 0, void 0, function* () {\n                let called = false;\n                const onRequestSent = () => {\n                    if (!called) {\n                        called = true;\n                        setTimeout(() => {\n                            this.closeConnection().then(resolve);\n                        }, 1000);\n                    }\n                };\n                try {\n                    yield this.sendRequest({ method: 'disconnect', params: [] }, { onRequestSent: onRequestSent, attempts: 1 });\n                }\n                catch (e) {\n                    (0, log_1.logDebug)('Disconnect error:', e);\n                    if (!called) {\n                        this.closeConnection().then(resolve);\n                    }\n                }\n                finally {\n                    onRequestSent();\n                }\n            }));\n        });\n    }\n    sendRequest(request, options) {\n        (0, log_1.logDebug)(\"sendTransaction  sendRequest\");\n        return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            yield ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.send(request, function (response) {\n                resolve(response);\n            }, { attempts: options === null || options === void 0 ? void 0 : options.attempts }));\n            (_b = options === null || options === void 0 ? void 0 : options.onRequestSent) === null || _b === void 0 ? void 0 : _b.call(options);\n        }));\n    }\n}\nexports.BridgeProvider = BridgeProvider;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isPendingConnectionHttp = isPendingConnectionHttp;\nfunction isPendingConnectionHttp(connection) {\n    return !('connectEvent' in connection);\n}\n// export type BridgeConnectionHttpRaw = Omit<BridgeConnectionHttp, 'session'> & {\n//     session: BridgeSessionRaw;\n// };\n//\n// export type BridgePendingConnectionHttpRaw = Omit<BridgePendingConnectionHttp, 'sessionCrypto'> & {\n//     sessionCrypto: KeyPair;\n// };\n//\n// export type BridgeConnectionRaw =\n//     | BridgeConnectionHttpRaw\n//     | BridgePendingConnectionHttpRaw;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OKXTonConnect = void 0;\nconst protocol_1 = require(\"../protocol\");\nconst bridge_provider_1 = require(\"./provider/bridge/bridge-provider\");\nconst default_storage_1 = require(\"../../core/storage/default-storage\");\nconst feature_support_1 = require(\"./utils/feature-support\");\nconst ton_connect_tracker_1 = require(\"./tracker/ton-connect-tracker\");\nconst send_transaction_parser_1 = require(\"./parsers/send-transaction-parser\");\nconst version_1 = require(\"./constants/version\");\nconst bridge_connection_storage_1 = require(\"./provider/bridge-connection-storage\");\nconst connect_errors_parser_1 = require(\"./parsers/connect-errors-parser\");\nconst log_1 = require(\"../../core/utils/log\");\nconst okx_connect_error_1 = require(\"../../core/protocol/error/okx-connect.error\");\nconst protocol_2 = require(\"../../core/protocol\");\n// import { createAbortController } from '/utils/create-abort-controller';\nclass OKXTonConnect {\n    constructor(options) {\n        this._wallet = null;\n        this.provider = null;\n        this.statusChangeSubscriptions = [];\n        this.statusChangeErrorSubscriptions = [];\n        this.storage = new default_storage_1.DefaultStorage();\n        if (!(options === null || options === void 0 ? void 0 : options.metaData)) {\n            throw new okx_connect_error_1.OkxConnectError('Dapp metaData can not be null');\n        }\n        this.dappSettings = {\n            metaData: options.metaData,\n        };\n        //本地钱包列表\n        this.tracker = new ton_connect_tracker_1.TonConnectTracker({\n            tonConnectSdkVersion: version_1.tonConnectSdkVersion\n        });\n        this.bridgeConnectionStorage = new bridge_connection_storage_1.BridgeConnectionStorage(this.storage);\n    }\n    /**\n     * Shows if the wallet is connected right now.\n     */\n    get connected() {\n        return this._wallet !== null;\n    }\n    /**\n     * Current connected account or null if no account is connected.\n     */\n    get account() {\n        var _a;\n        return ((_a = this._wallet) === null || _a === void 0 ? void 0 : _a.account) || null;\n    }\n    /**\n     * Current connected wallet or null if no account is connected.\n     */\n    get wallet() {\n        return this._wallet;\n    }\n    set wallet(value) {\n        this._wallet = value;\n        this.statusChangeSubscriptions.forEach(callback => callback(this._wallet));\n    }\n    connect(request) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            (0, log_1.logDebug)('sdk调试打印--->> connect', request);\n            if (this.connected) {\n                throw new protocol_2.WalletAlreadyConnectedError();\n            }\n            (_a = this.provider) === null || _a === void 0 ? void 0 : _a.closeConnection();\n            this.provider = new bridge_provider_1.BridgeProvider(this.storage);\n            this.provider.listen(this.walletEventsListener.bind(this));\n            this.tracker.trackConnectionStarted();\n            return this.provider.connect(this.createConnectRequest(request), request === null || request === void 0 ? void 0 : request.redirect, request === null || request === void 0 ? void 0 : request.openUniversalUrl);\n        });\n    }\n    walletEventsListener(e) {\n        switch (e.event) {\n            case 'connect':\n                this.onWalletConnected(e.payload);\n                break;\n            case 'connect_error':\n                this.onWalletConnectError(e.payload);\n                break;\n            case 'disconnect':\n                this.onWalletDisconnected('wallet');\n        }\n    }\n    onWalletConnected(connectEvent) {\n        const tonAccountItem = connectEvent.items.find(item => item.name === 'ton_addr');\n        const tonProofItem = connectEvent.items.find(item => item.name === 'ton_proof');\n        if (!tonAccountItem) {\n            throw new okx_connect_error_1.OkxConnectError('ton_addr connection item was not found');\n        }\n        const wallet = {\n            device: connectEvent.device,\n            provider: this.provider.type,\n            account: {\n                address: tonAccountItem.address,\n                chain: tonAccountItem.network,\n                walletStateInit: tonAccountItem.walletStateInit,\n                publicKey: tonAccountItem.publicKey\n            }\n        };\n        if (tonProofItem) {\n            wallet.connectItems = {\n                tonProof: tonProofItem\n            };\n        }\n        this.wallet = wallet;\n        (0, log_1.logDebug)('Ton connect --->>onWalletConnected>>>:', wallet);\n        this.tracker.trackConnectionCompleted(wallet);\n    }\n    onWalletConnectError(connectEventError) {\n        var _a;\n        const error = connect_errors_parser_1.connectErrorsParser.parseError(connectEventError);\n        this.statusChangeErrorSubscriptions.forEach(errorsHandler => errorsHandler(error));\n        (0, log_1.logDebug)(error);\n        this.tracker.trackConnectionError((_a = connectEventError.message) !== null && _a !== void 0 ? _a : \"\", connectEventError.code);\n    }\n    onWalletDisconnected(scope) {\n        this.tracker.trackDisconnection(this.wallet, scope);\n        this.wallet = null;\n    }\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!this.connected) {\n                throw new protocol_2.WalletNotConnectedError();\n            }\n            this.onWalletDisconnected('dapp');\n            yield ((_a = this.provider) === null || _a === void 0 ? void 0 : _a.disconnect());\n        });\n    }\n    onStatusChange(callback, errorsHandler) {\n        this.statusChangeSubscriptions.push(callback);\n        if (errorsHandler) {\n            this.statusChangeErrorSubscriptions.push(errorsHandler);\n        }\n        return () => {\n            this.statusChangeSubscriptions = this.statusChangeSubscriptions.filter(item => item !== callback);\n            if (errorsHandler) {\n                this.statusChangeErrorSubscriptions = this.statusChangeErrorSubscriptions.filter(item => item !== errorsHandler);\n            }\n        };\n    }\n    restoreConnection() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            this.tracker.trackConnectionRestoringStarted();\n            let provider = null;\n            try {\n                provider = yield bridge_provider_1.BridgeProvider.fromStorage(this.storage);\n            }\n            catch (_b) {\n                this.tracker.trackConnectionRestoringError('Provider is not restored');\n                yield this.bridgeConnectionStorage.removeConnection();\n                provider === null || provider === void 0 ? void 0 : provider.closeConnection();\n                provider = null;\n                return;\n            }\n            if (!provider) {\n                (0, log_1.logError)('Provider is not restored');\n                this.tracker.trackConnectionRestoringError('Provider is not restored');\n                return;\n            }\n            (_a = this.provider) === null || _a === void 0 ? void 0 : _a.closeConnection();\n            this.provider = provider;\n            provider.listen(this.walletEventsListener.bind(this));\n            yield this.provider.restoreConnection();\n            if (this.connected) {\n                this.tracker.trackConnectionRestoringCompleted(this.wallet);\n            }\n            else {\n                this.tracker.trackConnectionRestoringError('Connection restoring failed');\n            }\n        });\n    }\n    sendTransaction(transaction, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.checkConnection();\n            (0, feature_support_1.checkSendTransactionSupport)(this.wallet.device.features, {\n                requiredMessagesNumber: transaction.messages.length\n            });\n            this.tracker.trackTransactionSentForSignature(this.wallet, transaction);\n            (0, log_1.logDebug)(\"sendTransaction  start\");\n            const { validUntil } = transaction, tx = __rest(transaction, [\"validUntil\"]);\n            const from = transaction.from || this.account.address;\n            const network = transaction.network || this.account.chain;\n            if (network == protocol_1.CHAIN.TESTNET) {\n                throw new okx_connect_error_1.OkxConnectError(`just support mainNet`);\n            }\n            (0, log_1.logDebug)(\"sendTransaction  before sendRequest\");\n            const response = yield this.provider.sendRequest(send_transaction_parser_1.sendTransactionParser.convertToRpcRequest(Object.assign(Object.assign({}, tx), { valid_until: validUntil, from,\n                network })), {\n                onRequestSent: () => {\n                    var _a, _b;\n                    (_a = options === null || options === void 0 ? void 0 : options.onRequestSent) === null || _a === void 0 ? void 0 : _a.call(options);\n                    (_b = this.provider) === null || _b === void 0 ? void 0 : _b.openOKXWallet();\n                }\n            });\n            if (send_transaction_parser_1.sendTransactionParser.isError(response)) {\n                this.tracker.trackTransactionSigningFailed(this.wallet, transaction, response.error.message, response.error.code);\n                return send_transaction_parser_1.sendTransactionParser.parseAndThrowError(response);\n            }\n            const result = send_transaction_parser_1.sendTransactionParser.convertFromRpcResponse(response);\n            this.tracker.trackTransactionSigned(this.wallet, transaction, result);\n            return result;\n        });\n    }\n    checkConnection() {\n        if (!this.connected) {\n            throw new protocol_2.WalletNotConnectedError();\n        }\n    }\n    createConnectRequest(request) {\n        const items = [\n            {\n                name: 'ton_addr'\n            }\n        ];\n        if (request === null || request === void 0 ? void 0 : request.tonProof) {\n            items.push({\n                name: 'ton_proof',\n                payload: request.tonProof\n            });\n        }\n        return {\n            dappInfo: this.dappSettings.metaData,\n            items: items\n        };\n    }\n}\nexports.OKXTonConnect = OKXTonConnect;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowserEventDispatcher = void 0;\n/**\n * A concrete implementation of EventDispatcher that dispatches events to the browser window.\n */\nclass BrowserEventDispatcher {\n    constructor() {\n        /**\n         * The window object, possibly undefined in a server environment.\n         * @private\n         */\n        this.window = window;\n    }\n    /**\n     * Dispatches an event with the given name and details to the browser window.\n     * @param eventName - The name of the event to dispatch.\n     * @param eventDetails - The details of the event to dispatch.\n     * @returns A promise that resolves when the event has been dispatched.\n     */\n    dispatchEvent(eventName, eventDetails) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const event = new CustomEvent(eventName, { detail: eventDetails });\n            (_a = this.window) === null || _a === void 0 ? void 0 : _a.dispatchEvent(event);\n        });\n    }\n    /**\n     * Adds an event listener to the browser window.\n     * @param eventName - The name of the event to listen for.\n     * @param listener - The listener to add.\n     * @param options - The options for the listener.\n     * @returns A function that removes the listener.\n     */\n    addEventListener(eventName, listener, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            (_a = this.window) === null || _a === void 0 ? void 0 : _a.addEventListener(eventName, listener, options);\n            return () => {\n                var _a;\n                return (_a = this.window) === null || _a === void 0 ? void 0 : _a.removeEventListener(eventName, listener);\n            };\n        });\n    }\n}\nexports.BrowserEventDispatcher = BrowserEventDispatcher;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TonConnectTracker = void 0;\nconst types_1 = require(\"./types\");\nconst browser_event_dispatcher_1 = require(\"./browser-event-dispatcher\");\n/**\n * Tracker for TonConnect user actions, such as transaction signing, connection, etc.\n *\n * List of events:\n *  * `connection-started`: when a user starts connecting a wallet.\n *  * `connection-completed`: when a user successfully connected a wallet.\n *  * `connection-error`: when a user cancels a connection or there is an error during the connection process.\n *  * `connection-restoring-started`: when the dApp starts restoring a connection.\n *  * `connection-restoring-completed`: when the dApp successfully restores a connection.\n *  * `connection-restoring-error`: when the dApp fails to restore a connection.\n *  * `disconnection`: when a user starts disconnecting a wallet.\n *  * `transaction-sent-for-signature`: when a user sends a transaction for signature.\n *  * `transaction-signed`: when a user successfully signs a transaction.\n *  * `transaction-signing-failed`: when a user cancels transaction signing or there is an error during the signing process.\n *\n * If you want to track user actions, you can subscribe to the window events with prefix `ton-connect-`:\n *\n * @example\n * window.addEventListener('ton-connect-transaction-sent-for-signature', (event) => {\n *    logDebug('Transaction init', event.detail);\n * });\n *\n * @internal\n */\nclass TonConnectTracker {\n    /**\n     * Version of the library.\n     */\n    get version() {\n        return (0, types_1.createVersionInfo)({\n            ton_connect_sdk_lib: this.tonConnectSdkVersion,\n        });\n    }\n    constructor(options) {\n        /**\n         * Event prefix for user actions.\n         * @private\n         */\n        this.eventPrefix = 'ton-connect-';\n        this.eventDispatcher = new browser_event_dispatcher_1.BrowserEventDispatcher();\n        this.tonConnectSdkVersion = options.tonConnectSdkVersion;\n        this.init().catch();\n    }\n    /**\n     * Called once when the tracker is created and request version other libraries.\n     */\n    init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.setRequestVersionHandler();\n            }\n            catch (e) { }\n        });\n    }\n    /**\n     * Set request version handler.\n     * @private\n     */\n    setRequestVersionHandler() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.eventDispatcher.addEventListener('ton-connect-request-version', () => __awaiter(this, void 0, void 0, function* () {\n                yield this.eventDispatcher.dispatchEvent('ton-connect-response-version', (0, types_1.createResponseVersionEvent)(this.tonConnectSdkVersion));\n            }));\n        });\n    }\n    /**\n     * Emit user action event to the window.\n     * @param eventDetails\n     * @private\n     */\n    dispatchUserActionEvent(eventDetails) {\n        try {\n            this.eventDispatcher\n                .dispatchEvent(`${this.eventPrefix}${eventDetails.type}`, eventDetails)\n                .catch();\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection init event.\n     * @param args\n     */\n    trackConnectionStarted(...args) {\n        try {\n            const event = (0, types_1.createConnectionStartedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection success event.\n     * @param args\n     */\n    trackConnectionCompleted(...args) {\n        try {\n            const event = (0, types_1.createConnectionCompletedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection error event.\n     * @param args\n     */\n    trackConnectionError(...args) {\n        try {\n            const event = (0, types_1.createConnectionErrorEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection restoring init event.\n     * @param args\n     */\n    trackConnectionRestoringStarted(...args) {\n        try {\n            const event = (0, types_1.createConnectionRestoringStartedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection restoring success event.\n     * @param args\n     */\n    trackConnectionRestoringCompleted(...args) {\n        try {\n            const event = (0, types_1.createConnectionRestoringCompletedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track connection restoring error event.\n     * @param args\n     */\n    trackConnectionRestoringError(...args) {\n        try {\n            const event = (0, types_1.createConnectionRestoringErrorEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track disconnect event.\n     * @param args\n     */\n    trackDisconnection(...args) {\n        try {\n            const event = (0, types_1.createDisconnectionEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track transaction init event.\n     * @param args\n     */\n    trackTransactionSentForSignature(...args) {\n        try {\n            const event = (0, types_1.createTransactionSentForSignatureEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track transaction signed event.\n     * @param args\n     */\n    trackTransactionSigned(...args) {\n        try {\n            const event = (0, types_1.createTransactionSignedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n    /**\n     * Track transaction error event.\n     * @param args\n     */\n    trackTransactionSigningFailed(...args) {\n        try {\n            const event = (0, types_1.createTransactionSigningFailedEvent)(this.version, ...args);\n            this.dispatchUserActionEvent(event);\n        }\n        catch (e) { }\n    }\n}\nexports.TonConnectTracker = TonConnectTracker;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.OKX_TON_TRANSACTION_SIGNING_FAILED = exports.OKX_TON_TRANSACTION_SIGNED = exports.OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE = exports.OKX_TON_DISCONNECTION = exports.OKX_TON_CONNECTION_RESTORING_ERROR = exports.OKX_TON_CONNECTION_RESTORING_COMPLETED = exports.OKX_TON_CONNECTION_RESTORING_STARTED = exports.OKX_TON_CONNECTION_ERROR = exports.OKX_TON_CONNECTION_COMPLETED = exports.OKX_TON_CONNECTION_STARTED = void 0;\nexports.OKX_TON_CONNECTION_STARTED = 'ton-connect-connection-started';\nexports.OKX_TON_CONNECTION_COMPLETED = 'ton-connect-connection-completed';\nexports.OKX_TON_CONNECTION_ERROR = 'ton-connect-connection-error';\nexports.OKX_TON_CONNECTION_RESTORING_STARTED = 'ton-connect-connection-restoring-started';\nexports.OKX_TON_CONNECTION_RESTORING_COMPLETED = 'ton-connect-connection-restoring-completed';\nexports.OKX_TON_CONNECTION_RESTORING_ERROR = 'ton-connect-connection-restoring-error';\nexports.OKX_TON_DISCONNECTION = 'ton-connect-disconnection';\nexports.OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE = 'ton-connect-transaction-sent-for-signature';\nexports.OKX_TON_TRANSACTION_SIGNED = 'ton-connect-transaction-signed';\nexports.OKX_TON_TRANSACTION_SIGNING_FAILED = 'ton-connect-transaction-signing-failed';\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createRequestVersionEvent = createRequestVersionEvent;\nexports.createResponseVersionEvent = createResponseVersionEvent;\nexports.createVersionInfo = createVersionInfo;\nexports.createConnectionStartedEvent = createConnectionStartedEvent;\nexports.createConnectionCompletedEvent = createConnectionCompletedEvent;\nexports.createConnectionErrorEvent = createConnectionErrorEvent;\nexports.createConnectionRestoringStartedEvent = createConnectionRestoringStartedEvent;\nexports.createConnectionRestoringCompletedEvent = createConnectionRestoringCompletedEvent;\nexports.createConnectionRestoringErrorEvent = createConnectionRestoringErrorEvent;\nexports.createTransactionSentForSignatureEvent = createTransactionSentForSignatureEvent;\nexports.createTransactionSignedEvent = createTransactionSignedEvent;\nexports.createTransactionSigningFailedEvent = createTransactionSigningFailedEvent;\nexports.createDisconnectionEvent = createDisconnectionEvent;\n/**\n * Create a request version event.\n */\nfunction createRequestVersionEvent() {\n    return {\n        type: 'request-version'\n    };\n}\n/**\n * Create a response version event.\n * @param version\n */\nfunction createResponseVersionEvent(version) {\n    return {\n        type: 'response-version',\n        version: version\n    };\n}\n/**\n * Create a version info.\n * @param version\n */\nfunction createVersionInfo(version) {\n    return {\n        ton_connect_sdk_lib: version.ton_connect_sdk_lib\n    };\n}\nfunction createConnectionInfo(version, wallet) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    const isTonProof = ((_a = wallet === null || wallet === void 0 ? void 0 : wallet.connectItems) === null || _a === void 0 ? void 0 : _a.tonProof) && 'proof' in wallet.connectItems.tonProof;\n    const authType = isTonProof ? 'ton_proof' : 'ton_addr';\n    return {\n        wallet_address: (_c = (_b = wallet === null || wallet === void 0 ? void 0 : wallet.account) === null || _b === void 0 ? void 0 : _b.address) !== null && _c !== void 0 ? _c : null,\n        wallet_type: (_d = wallet === null || wallet === void 0 ? void 0 : wallet.device.appName) !== null && _d !== void 0 ? _d : null,\n        wallet_version: (_e = wallet === null || wallet === void 0 ? void 0 : wallet.device.appVersion) !== null && _e !== void 0 ? _e : null,\n        auth_type: authType,\n        custom_data: Object.assign({ chain_id: (_g = (_f = wallet === null || wallet === void 0 ? void 0 : wallet.account) === null || _f === void 0 ? void 0 : _f.chain) !== null && _g !== void 0 ? _g : null, provider: (_h = wallet === null || wallet === void 0 ? void 0 : wallet.provider) !== null && _h !== void 0 ? _h : null }, createVersionInfo(version))\n    };\n}\n/**\n * Create a connection init event.\n */\nfunction createConnectionStartedEvent(version) {\n    return {\n        type: 'connection-started',\n        custom_data: createVersionInfo(version)\n    };\n}\n/**\n * Create a connection completed event.\n * @param version\n * @param wallet\n */\nfunction createConnectionCompletedEvent(version, wallet) {\n    return Object.assign({ type: 'connection-completed', is_success: true }, createConnectionInfo(version, wallet));\n}\n/**\n * Create a connection error event.\n * @param version\n * @param error_message\n * @param errorCode\n */\nfunction createConnectionErrorEvent(version, error_message, errorCode) {\n    return {\n        type: 'connection-error',\n        is_success: false,\n        error_message: error_message,\n        error_code: errorCode !== null && errorCode !== void 0 ? errorCode : null,\n        custom_data: createVersionInfo(version)\n    };\n}\n/**\n * Create a connection restoring started event.\n */\nfunction createConnectionRestoringStartedEvent(version) {\n    return {\n        type: 'connection-restoring-started',\n        custom_data: createVersionInfo(version)\n    };\n}\n/**\n * Create a connection restoring completed event.\n * @param version\n * @param wallet\n */\nfunction createConnectionRestoringCompletedEvent(version, wallet) {\n    return Object.assign({ type: 'connection-restoring-completed', is_success: true }, createConnectionInfo(version, wallet));\n}\n/**\n * Create a connection restoring error event.\n * @param version\n * @param errorMessage\n */\nfunction createConnectionRestoringErrorEvent(version, errorMessage) {\n    return {\n        type: 'connection-restoring-error',\n        is_success: false,\n        error_message: errorMessage,\n        custom_data: createVersionInfo(version)\n    };\n}\nfunction createTransactionInfo(wallet, transaction) {\n    var _a, _b, _c, _d;\n    return {\n        valid_until: (_a = String(transaction.validUntil)) !== null && _a !== void 0 ? _a : null,\n        from: (_d = (_b = transaction.from) !== null && _b !== void 0 ? _b : (_c = wallet === null || wallet === void 0 ? void 0 : wallet.account) === null || _c === void 0 ? void 0 : _c.address) !== null && _d !== void 0 ? _d : null,\n        messages: transaction.messages.map(message => {\n            var _a, _b;\n            return ({\n                address: (_a = message.address) !== null && _a !== void 0 ? _a : null,\n                amount: (_b = message.amount) !== null && _b !== void 0 ? _b : null\n            });\n        })\n    };\n}\n/**\n * Create a transaction init event.\n * @param version\n * @param wallet\n * @param transaction\n */\nfunction createTransactionSentForSignatureEvent(version, wallet, transaction) {\n    return Object.assign(Object.assign({ type: 'transaction-sent-for-signature' }, createConnectionInfo(version, wallet)), createTransactionInfo(wallet, transaction));\n}\n/**\n * Create a transaction signed event.\n * @param version\n * @param wallet\n * @param transaction\n * @param signedTransaction\n */\nfunction createTransactionSignedEvent(version, wallet, transaction, signedTransaction) {\n    return Object.assign(Object.assign({ type: 'transaction-signed', is_success: true, signed_transaction: signedTransaction.boc }, createConnectionInfo(version, wallet)), createTransactionInfo(wallet, transaction));\n}\n/**\n * Create a transaction error event.\n * @param version\n * @param wallet\n * @param transaction\n * @param errorMessage\n * @param errorCode\n */\nfunction createTransactionSigningFailedEvent(version, wallet, transaction, errorMessage, errorCode) {\n    return Object.assign(Object.assign({ type: 'transaction-signing-failed', is_success: false, error_message: errorMessage, error_code: errorCode !== null && errorCode !== void 0 ? errorCode : null }, createConnectionInfo(version, wallet)), createTransactionInfo(wallet, transaction));\n}\n/**\n * Create a disconnect event.\n * @param version\n * @param wallet\n * @param scope\n * @returns\n */\nfunction createDisconnectionEvent(version, wallet, scope) {\n    return Object.assign({ type: 'disconnection', scope: scope }, createConnectionInfo(version, wallet));\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.checkSendTransactionSupport = checkSendTransactionSupport;\nconst wallet_not_support_feature_error_1 = require(\"../../../core/protocol/error/wallet-not-support-feature.error\");\nconst log_1 = require(\"../../../core/utils/log\");\nfunction checkSendTransactionSupport(features, options) {\n    const supportsDeprecatedSendTransactionFeature = features.includes('ton_sendTransaction');\n    const sendTransactionFeature = features.find(feature => feature && typeof feature === 'object' && feature.name === 'ton_sendTransaction');\n    if (!supportsDeprecatedSendTransactionFeature && !sendTransactionFeature) {\n        throw new wallet_not_support_feature_error_1.WalletNotSupportFeatureError(\"Wallet doesn't support SendTransaction feature.\");\n    }\n    if (sendTransactionFeature && sendTransactionFeature.maxMessages !== undefined) {\n        if (sendTransactionFeature.maxMessages < options.requiredMessagesNumber) {\n            throw new wallet_not_support_feature_error_1.WalletNotSupportFeatureError(`Wallet is not able to handle such SendTransaction request. Max support messages number is ${sendTransactionFeature.maxMessages}, but ${options.requiredMessagesNumber} is required.`);\n        }\n        return;\n    }\n    (0, log_1.logWarning)(\"Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.\");\n}\n","\n<template>\n  <div id=\"app\">\n    <el-container>\n      <el-header>OKX Connect</el-header>\n      <el-main>\n        <!-- 钱包信息 -->\n        <el-card class=\"wallet-info\">\n          <template #header>\n            <div>钱包信息</div>\n          </template>\n          <el-row class=\"info-row\">\n            <el-col :span=\"24\">\n              <strong>Wallet Address:</strong> {{ getWalletAddress }}\n            </el-col>\n          </el-row>\n\n          <el-row class=\"info-row\">\n            <el-col :span=\"24\">\n              <strong>当前状态 :</strong> {{ currentStatus }}\n            </el-col>\n          </el-row>\n\n<!--          <el-row class=\"info-row\">-->\n<!--            <el-col :span=\"24\">-->\n<!--              <strong>Universal Link:</strong> {{ updateUniLink }}-->\n<!--            </el-col>-->\n<!--          </el-row>-->\n        </el-card>\n\n        <!-- 连接钱包 -->\n        <el-card class=\"wallet-actions\">\n          <template #header>\n            <div>钱包操作</div>\n          </template>\n          <el-row :gutter=\"12\">\n            <el-col :span=\"24\">\n              <el-input v-model=\"testProofPayload\" placeholder=\"proofPayload\"></el-input>\n            </el-col>\n          </el-row>\n          <el-row class=\"info-row\">\n            <el-col :span=\"24\">\n              <strong>Proof verify:</strong> {{ ProofPayloadVerify }}\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"12\" class=\"button-row\">\n            <el-col :span=\"24\">\n              <el-button type=\"primary\" @click=\"connectBtnClicked\" icon=\"el-icon-connection\">{{ connectStatusStr }}</el-button>\n            </el-col>\n          </el-row>\n\n          <teleport to=\"body\">\n            <div v-if=\"showModal\" class=\"modal-overlay\" @click=\"closeModal\">\n              <div class=\"modal-content\" @click.stop>\n                <button class=\"close-button\" @click=\"closeModal\">&times;</button>\n                <h2>扫描二维码</h2>\n                <qrcode-vue :value=\"qrValue\" :size=\"200\" level=\"H\" />\n              </div>\n            </div>\n          </teleport>\n\n          <el-row :gutter=\"12\" class=\"button-row\">\n            <el-col :span=\"24\">\n              <el-button type=\"warning\" @click=\"resotreConnectAction\" icon=\"el-icon-refresh-right\">尝试重连</el-button>\n            </el-col>\n          </el-row>\n          <el-row :gutter=\"12\"  class=\"button-row\">\n            <el-col :span=\"24\">\n              <el-button type=\"danger\" @click=\"disconnectAction\" icon=\"el-icon-switch-button\" :disabled=\"walletAddress.length == 0\">{{ disconnectStatusStr }}</el-button>\n            </el-col>\n          </el-row>\n        </el-card>\n\n        <!-- 发送交易 -->\n        <el-card class=\"transaction\">\n          <template #header>\n            <div>交易</div>\n          </template>\n\n          <el-col :xs=\"24\" :sm=\"12\">\n            <div class=\"input-label\">交易数据（可选，有默认） :</div>\n            <el-input v-model=\"testTransaction\" placeholder=\"sendTransactions\"></el-input>\n          </el-col>\n          <el-col :xs=\"24\" :sm=\"12\">\n            <div class=\"input-label\">签名结果 :</div>\n            <el-input v-model=\"testboc\" placeholder=\"boc\"></el-input>\n          </el-col>\n          <el-row :gutter=\"12\" class=\"button-row\">\n            <el-col :span=\"24\">\n              <el-button type=\"primary\" @click=\"sendTransaction()\">{{ testTransactionStr }}</el-button>\n            </el-col>\n          </el-row>\n        </el-card>\n\n        <!-- 本地加解密KeyPair -->\n        <el-card class=\"keypair-info\">\n          <template #header>\n            <div>本地加解密KeyPair</div>\n          </template>\n          <el-row :gutter=\"12\">\n            <el-col :xs=\"24\" :sm=\"12\">\n              <div class=\"input-label\">PubKey:</div>\n              <el-input v-model=\"localPubKey\" placeholder=\"PublicKey\" disabled></el-input>\n            </el-col>\n            <el-col :xs=\"24\" :sm=\"12\">\n              <div class=\"input-label\">SecKey:</div>\n              <el-input v-model=\"localSecKey\" placeholder=\"SecretKey\" disabled></el-input>\n            </el-col>\n          </el-row>\n        </el-card>\n\n        <!-- 清理缓存 -->\n        <el-card class=\"clear-cache\">\n          <el-row>\n            <el-col :span=\"24\">\n              <el-button type=\"danger\" @click=\"clearCacheKeyPair()\" icon=\"el-icon-delete\">清理本地缓存</el-button>\n            </el-col>\n          </el-row>\n        </el-card>\n      </el-main>\n    </el-container>\n  </div>\n</template>\n\n<style scoped>\n/* 重置全局边距和内边距 */\nbody, html {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n/* 确保 app 容器占满整个视口 */\n#app {\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin: 0 auto; /* 居中 */\n  max-width: 600px; /* 设置最大宽度 */\n  padding: 0 20px; /* 添加一些左右内边距 */\n}\n\n/* 调整 el-container 样式 */\n.el-container {\n  min-height: 100vh;\n  margin: 0;\n  padding: 0;\n  width: 100%;\n}\n\n/* 调整 el-header 样式 */\n.el-header {\n  background-color: #333333;\n  color: white;\n  height: 50px;\n  line-height: 50px;\n  font-size: 18px;\n  font-weight: bold;\n  width: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n}\n\n/* 调整 el-main 样式 */\n.el-main {\n  padding: 70px 0 20px; /* 增加顶部内边距以避免被固定header遮挡 */\n  flex-grow: 1;\n}\n\n.el-card {\n  margin-bottom: 20px;\n}\n\n.info-row {\n  margin-bottom: 10px;\n}\n\n.input-label {\n  margin-bottom: 5px;\n  text-align: left;\n}\n\n.el-input {\n  margin-bottom: 10px;\n}\n\n/* 通用按钮样式 */\n.wallet-actions .el-button,\n.transaction .el-button,\n.clear-cache .el-button {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 40px;\n}\n\n.wallet-actions .el-button span,\n.transaction .el-button span,\n.clear-cache .el-button span {\n  margin: 0 auto;\n}\n\n/* 按钮行间距 */\n.wallet-actions .button-row,\n.transaction .button-row {\n  margin-bottom: 8px;\n}\n\n.wallet-actions .button-row:last-child,\n.transaction .button-row:last-child {\n  margin-bottom: 0;\n}\n\n/* 调整图标和文字的对齐 */\n.wallet-actions .el-button [class^=\"el-icon-\"],\n.transaction .el-button [class^=\"el-icon-\"],\n.clear-cache .el-button [class^=\"el-icon-\"] {\n  margin-right: 5px;\n  vertical-align: middle;\n}\n\n/* 新增：调整发送交易按钮与输入框的间距 */\n.transaction .el-row:not(:last-child) {\n  margin-bottom: 10px;\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: white;\n  padding: 20px;\n  border-radius: 8px;\n  text-align: center;\n  position: relative;\n  max-width: 90%;\n  width: 300px;\n}\n\n.close-button {\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  font-size: 24px;\n  border: none;\n  background: none;\n  cursor: pointer;\n}\n\n/* 响应式调整 */\n@media (max-width: 600px) {\n  #app {\n    padding: 0 10px;\n  }\n\n  .el-main {\n    padding: 60px 0 10px;\n  }\n}\n</style>\n<script>\n// import * as sdk from \"../../src/index\"\nimport {OKXTonConnect, ConnectionManager, utils,UserRejectsError,\n  OKX_TON_CONNECTION_COMPLETED,\n  OKX_TON_CONNECTION_ERROR,\n  OKX_TON_CONNECTION_RESTORING_COMPLETED,\n  OKX_TON_CONNECTION_RESTORING_ERROR,\n  OKX_TON_CONNECTION_RESTORING_STARTED,\n  OKX_TON_CONNECTION_STARTED,\n  OKX_TON_DISCONNECTION,\n  OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE,\n  OKX_TON_TRANSACTION_SIGNED,\n  OKX_TON_TRANSACTION_SIGNING_FAILED} from \"../../src/index\"\nimport { Address } from \"ton\";\nimport { signVerify } from \"ton-crypto\";\n\nvar TON = new OKXTonConnect({metaData: {\n            name:\"测试dapp\",\n            icon:\"\",\n            url:\"okx.com\"\n        }})\nwindow.ton = TON\nvar testCM = new ConnectionManager()\n// async function testconnect() {\n//   await testCM.connect()\n// }\n\n\nasync function verifyTonProof(address, public_key, signature, domain) {\n  try {\n    // 解析地址\n    const parsedAddress = Address.parse(address);\n\n    // 构建需要验证的消息\n    const message = `${domain}\\n${parsedAddress.toString(true, true, true)}`;\n\n    // 从 proof 中提取公钥\n    const publicKey = Buffer.from(public_key,'hex');\n\n    // 将签名转换为 Buffer\n    // const signatureBuffer = utils.hexToByteArray(signature);\n    const signatureBuffer = Buffer.from(signature,'base64');\n\n    // 验证签名\n    return signVerify(Buffer.from(message), signatureBuffer, publicKey);\n  } catch (error) {\n    console.error(\"Error verifying TON proof:\", error);\n    return false;\n  }\n}\n\n// 使用示例\nconst address = \"EQArzP5prfRJtDM5WrMNWyr9yUTAi0c9o6PfR4hkWy9UQXHx\";\nconst proof = {\n  \"timestamp\": 1684856121,\n  \"domain\": {\n    \"lengthBytes\": 21,\n    \"value\": \"ton-proof.github.io\"\n  },\n  \"signature\": \"bGisgGHUoNrbVhAsXHTJv0BX9vTVkBxk3mDxlOWOiglNgMHcmwHI0CYa6VJo1fkz8cZpS0iuNS+gKPXJxdDZBw==\",\n  \"payload\": \"t0N0ZXN0...\", // 省略部分内容\n  \"state_init\": \"...\", // 省略内容\n  \"public_key\": \"NP1fpOSJcaRe6ILKZtixHssbKdJMvh8c2Mc02JRlpWw=\"\n};\nconst signature = proof.signature;\nconst domain = proof.domain.value;\n\nverifyTonProof(address, proof, signature, domain)\n    .then(isValid => {\n      console.log(\"Signature is valid:\", isValid);\n    })\n    .catch(error => {\n      console.error(\"Verification failed:\", error);\n    });\n\nimport QrcodeVue from 'qrcode.vue'\n\n\nexport default {\n  name: 'App',\n  components: {\n    QrcodeVue\n  },\n  data: ()=> {\n    return {\n      testTopic: '',\n      testPublicKey: '',\n      testProofPayload: '',\n      pendingDeepLink: '-',\n      logList: [],\n      connectReady: false,\n      connectStatusStr: '连接钱包',\n      disconnectStatusStr: '断开钱包',\n      localPubKey: '',\n      localSecKey: '',\n      testTransaction:'',\n      testTransactionStr:'发送交易',\n      walletAddress:'',\n      testboc:'',\n      ProofPayloadVerify:'',\n      showModal: false,\n      qrValue: 'https://www.okx.com/download',\n      currentStatus:\"\"\n    }\n  },\n  computed: {\n    updateUniLink:function(){\n      console.log(`update uni link: ${this.testTopic} ${this.testPublicKey}`)\n      let pendingDeepLink = utils.generateDeepLink(\n        {\n          protocolVer: \"1\",\n          channelId: this.testTopic,\n          clientId: this.testPublicKey,\n          dAppInfo: {\n            name: \"test\",\n            url: \"-\",\n            iconUrl: \"-\"\n          },\n          requestId:\"0\",\n          testPayload: this.testProofPayload\n        }\n      )\n      return pendingDeepLink\n    },\n    getWalletAddress:function (){\n      return this.walletAddress;\n    },\n\n\n  },\n  methods: {\n    async connectBtnClicked() {\n        this.testTonSdk();\n\n    },\n    async disconnectAction() {\n      console.log('get disconnect wallet btn clicked');\n      TON.disconnect();\n    },\n    async resotreConnectAction() {\n      console.log('get restore wallet btn clicked');\n      TON.restoreConnection();\n    },\n    clearCacheKeyPair: () => {\n      console.log(`generate local key pair`)\n      testCM.cleanCache()\n      // testTonSdk()\n\n    },\n    async sendTransaction(){\n      console.log('sendTransaction')\n      console.log('sendTransaction内容------',this.testTransaction)\n    if(this.testTransaction){\n      // eslint-disable-next-line no-undef\n      const sendData = JSON.parse(this.testTransaction)\n      console.log('sendTransaction--结束-----',sendData)\n      TON.sendTransaction(sendData)\n      return;\n    }\n      let transactionRequest =\n          {\"messages\":[{\"address\":\"EQARULUYsmJq1RiZ-YiH-IJLcAZUVkVff-KBPwEmmaQGH6aC\",\"amount\":\"205000000\",\"payload\":\"te6cckEBAgEAhwABbQ+KfqUAAADNgG7tIEATEtAIAO87mQKicbKgHIk4pSPP4k5xhHqutqYgAB7USnesDnCcECwbgQMBAJUlk4VhgBD3JEg1TUr75iTijBghOKm/sxNDXUBl7CD6WMut0Q85x4RafwA/Es89DBXoTxuqxVFxyBbzt9Rav2HBUKl7hmkvLuKHLBCW57aK\"}],\"validUntil\":1792481054071,\"network\":-239,\"from\":\"UQD8Szz0MFehPG6rFUXHIFvO31Fq_YcFQqXuGaS8u4ocsJdI\"}\n\n      try {\n        var result = await TON.sendTransaction(transactionRequest)\n        this.testboc = result.boc\n      }catch (e) {\n        if (e instanceof UserRejectsError){\n          this.testboc = \"用户拒绝交易\"\n        }else{\n          this.testboc = \"签名错误！\"\n        }\n      }\n    },\n\n    async testTonSdk(){\n      if (TON.connected){\n        console.log('you have connected wallet');\n      }else {\n        console.log('---connect Proof--->>>>----',this.testProofPayload);\n        let connectData = {\n          tonProof:this.testProofPayload,\n          redirect:\"tg://resolve\",\n          openUniversalUrl:true\n        };\n\n        if (this.isPC()) {\n          connectData.redirect = null;\n          connectData.openUniversalUrl = false;\n          console.log('Is PC, showing connectData',connectData);\n\n          let url = await TON.connect(connectData);\n          console.log('Is PC, showing modal ==>',url);\n          if (url){\n            this.qrValue = url;\n            this.showModal = true;\n          }\n\n        }else {\n          if(this.isSafariOrChrome()){\n            connectData.redirect = null;\n          }\n          console.log('Is Mobile ==>',connectData);\n          await  TON.connect(connectData);\n        }\n      }\n\n    },\n\n    closeModal() {\n      this.showModal = false;\n    },\n\n    isPC() {\n      const userAgentInfo = navigator.userAgent\n      console.log('current device ua is ===>',userAgentInfo)\n\n      const Agents = [\"Android\", \"iPhone\", \"SymbianOS\", \"Windows Phone\", \"iPad\", \"iPod\"]\n      let flag = true\n      for (let v = 0; v < Agents.length; v++) {\n        if (userAgentInfo.indexOf(Agents[v]) > 0) {\n          flag = false\n          break\n        }\n      }\n      return flag\n    },\n    isSafariOrChrome() {\n      const userAgentInfo = navigator.userAgent\n      const Agents = [\"Safari\", \"Chrome\"]\n      let flag = false\n      for (let v = 0; v < Agents.length; v++) {\n        if (userAgentInfo.indexOf(Agents[v]) > 0) {\n          flag = true\n          break\n        }\n      }\n      return flag\n    },\n  },\n  created() {\n    // testEncrypt('test msg')\n    console.log('test sdk here')\n    console.log(TON)\n\n    const events = [\n      OKX_TON_CONNECTION_STARTED,\n      OKX_TON_CONNECTION_COMPLETED,\n      OKX_TON_CONNECTION_ERROR,\n      OKX_TON_CONNECTION_RESTORING_STARTED,\n      OKX_TON_CONNECTION_RESTORING_COMPLETED,\n      OKX_TON_CONNECTION_RESTORING_ERROR,\n      OKX_TON_DISCONNECTION,\n      OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE,\n      OKX_TON_TRANSACTION_SIGNED,\n      OKX_TON_TRANSACTION_SIGNING_FAILED,\n    ]\n\n    events.forEach(eventName => {\n      window.addEventListener(eventName, (event) => {\n        console.log(eventName,event.detail)\n        this.currentStatus = eventName\n      });\n    });\n  },\n\n  mounted() {\n    this.connectReady = true\n    // console.log('test connect called')\n    // testconnect()\n    const keyPairInfo = testCM.getCryptoInfo()\n    console.log(keyPairInfo)\n    this.localPubKey = keyPairInfo.kp.publicKey\n    this.localSecKey = keyPairInfo.kp.secretKey\n    this.testPublicKey = this.localPubKey\n    this.testTopic = keyPairInfo.topic?.content\n\n    TON.onStatusChange((walletInfo) => {\n          console.log('--测试dapp 收到钱包数据---->>>>----', walletInfo);\n          if (walletInfo) {\n            this.walletAddress = walletInfo.account.address;\n            if (this.testProofPayload) {\n              const address = this.walletAddress;\n              const signature = walletInfo.connectItems?.tonProof?.proof.signature;\n              const domain = walletInfo.connectItems?.tonProof?.proof.domain;\n              const pubkey = walletInfo.account.publicKey\n              verifyTonProof(address, pubkey, `${signature}`, domain.value)\n                  .then(isValid => {\n                    this.ProofPayloadVerify = isValid;\n                    console.log(\"Signature is valid:\", isValid);\n                  })\n                  .catch(error => {\n                    this.ProofPayloadVerify = \"Fail\";\n\n                    console.error(\"Verification failed:\", error);\n                  });\n            } else {\n              this.ProofPayloadVerify = \"--\";\n            }\n            this.showModal = false;\n\n          } else {\n            this.walletAddress = \"已经断开了\";\n          }\n        }, (err) => {\n          if (err instanceof UserRejectsError){\n            this.walletAddress = `用户拒绝链接`;\n          }else{\n            this.walletAddress = `链接报错 ！ ${err.message}`;\n          }\n        }\n    )\n    //\n    // TON.onStatusChange(function (walletInfo) {\n    //\n    //\n    // }.bind(this));\n\n  }\n}\n</script>","import { render } from \"./App.vue?vue&type=template&id=3adf22c4&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=3adf22c4&scoped=true&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3adf22c4\"]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport ElementPlus from 'element-plus'\nimport 'element-plus/dist/index.css'\nimport App from './App.vue'\n\nconst app = createApp(App)\n\napp.use(ElementPlus)\napp.mount('#app')","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkokxconnect\"] = self[\"webpackChunkokxconnect\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(3488); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["require","__createBinding","this","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","apply","exports","OKXWalletConnector","constants_1","safejson_1","utils_1","events_1","log","WS","resolveWebSocketImplementation","constructor","url","events","EventEmitter","state","ConnectorState","InitState","checkWSUrl","Error","connected","socket","connecting","Connecting","onPayload","data","logDebug","rsp","Date","now","toString","emit","onClose","event","onError","id","payload","msg","onopen","onmessage","onclose","Connected","emitError","errorEvent","heartbeat","readyState","WebSocket","OPEN","send","setTimeout","bind","registOpen","maxListenerCount","getMaxListeners","listenerCount","setMaxListeners","once","error","EVENT_EMITTER_MAX_LISTENERS","URLSearchParams","opts","rejectUnauthorized","hasBuiltInWebSocket","onerror","on","onVisibleChanged","document","visibilityState","connect","removeEventListener","addEventListener","disconnect","Disconnected","close","currentStatus","addListener","decrypt","success","failed","_a","parsedEvent","safeJsonParse","params","rawMsg","message","addPackageParse","callback","param","listener","off","removeListener","doLogin","safeJsonStringify","getMsgPayloadFromHistory","tmpMsg","jsonstr","onOpen","ConnectionManager","connect_1","storage_1","crypto_1","jwt_1","connectStorage","Storage","OKXCONNECTOR_CACHE_KEY","crypto","SessionCrypto","jwtKeyPair","getCachedJWTKeyPair","saveJWTKeyPair","connector","OKXCONNECTOR_WS_URL","sendEnable","packageId","connectedWalletPK","currentTopic","saveCryptoKeyPair","keyPair","cacheInfo","saveContent","OKXCONNECTOR_CRYPTO_KEY","getCachedCryptoKeyPair","kp","getItem","content","keyPairInfo","clearCache","strkeyPair","publicKey","toHexString","secretKey","OKXCONNECTOR_JWT_KEY","strKeyPairInfo","hexToByteArray","generateKeyPair","isWalletPKReady","length","makeJWT","topic","signJWT","OKXCONNECTOR_JWT_SIDE","OKXCONNECTOR_JWT_TTL","parsePackage","input_1","arguments","input","ignoreACK","msgId","parseInt","sendACK","OKXCONNECTOR_TOKEN_CACHE","sendReceive","restoreConnect","getConnectInfo","generateTopic","info","channelId","clientId","stringifyKeypair","fromRestore","lastConnectId","cachedSenderPublicKey","OKXCONNECTOR_CRYPTO_SENDER_PK_CACHE","jwtToken","sendFetchAndConsumeMessages","jsonrpc","CONNECT_JSONRPC_VER","method","CONNECT_METHOD_SUB","CONNECT_METHOD_LOGIN","token","replace","parsedMessage","CONNECT_METHOD_RECEIVE","addListenerOnce","fail","msgObj","encrypt","CONNECT_METHOD_PUBLISH","messageId","ttl","OKXCONNECTOR_MESSAGE_TTL","msgId_1","success_1","reason","code","fetchedMessages","_b","_c","hasMore","receivedMsgs","i","msgTopic","CONNECT_METHOD_FETCHMSG","getCryptoInfo","jwt","cleanCache","CONNECT_METHOD_UNSUB","CONNECT_METHOD_PUSH","Engine","call_for_success_1","log_1","connectionManager","pendingRequests","Map","disconnectListener","jsonResponse","handleResponse","addDisconnectListener","disconnecter","push","clear","getRequestId","requestId","bindRequestForPromise","set","request","option","callForSuccess","JSON","stringify","assign","response","delete","forEach","__importDefault","MULTICODEC_ED25519_LENGTH","MULTICODEC_ED25519_HEADER","MULTICODEC_ED25519_BASE","MULTICODEC_ED25519_ENCODING","DID_METHOD","DID_PREFIX","DID_DELIMITER","KEY_PAIR_SEED_LENGTH","DATA_ENCODING","JSON_ENCODING","JWT_ENCODING","JWT_DELIMITER","JWT_IRIDIUM_TYP","JWT_IRIDIUM_ALG","JWTHeaderType","decodeJSON","encodeJSON","encodeIss","decodeIss","encodeSig","decodeSig","encodeData","decodeData","encodeJWT","decodeJWT","verifyJWT","ed25519","to_string_1","from_string_1","tweetnacl_1","default","sign","str","fromString","val","publicKeyStr","join","issuer","prefix","multicodec","split","bytes","encoded","header","signature","slice","sub_1","aud_1","ttl_1","keyPair_1","sub","aud","iat","Math","floor","alg","typ","iss","exp","act","detached","verify","subKey","localStorage","resolveLocalStorage","cacheStr","cacheKey","cache","cacheObj","key","item","timestamp","saveItem","localKey","totalCacheStr","setItem","nonceLength","sessionKeyPair","createKeypairFromString","createKeypair","box","createNonce","randomBytes","receiverPublicKey","encodedMessage","TextEncoder","encode","nonce","encrypted","hexResult","concatUint8Arrays","encodedResult","base64encode","senderPublicKey","base64Content","base64decode","messageByteArray","toUint8Array","internalMessage","splitToUint8Arrays","decrypted","open","TextDecoder","decode","WalletNotConnectedError","WalletNotSupportFeatureError","WalletAlreadyConnectedError","UserRejectsError","UnknownError","OkxConnectError","okx_connect_error_1","unknown_error_1","user_rejects_error_1","wallet_already_connected_error_1","wallet_not_support_feature_error_1","wallet_not_connected_error_1","super","name","setPrototypeOf","__exportStar","p","DefaultStorage","web_api_1","tryGetLocalStorage","removeItem","InMemoryStorage","getInstance","instance","storage","keys","index","fn","options","attempts","delayMs","lastError","err","delay","timeout","signal","aborted","timeoutId","clearTimeout","generateOKXLink","buffer_1","payloadStr","testPayload","redirect","base64Str","Buffer","from","args","console","debug","logError","logWarning","warn","JSONStringify","_","JSONParse","json","numbersBiggerThanMaxInt","serializedData","match","parse","isCustomFormatBigInt","BigInt","substring","removeUrlLastSlash","addPathToUrl","path","openOKXDeeplinkWithFallback","deeplinkUrl","window","RANDOM_LENGTH","isBrowser","hasLocalStorage","hashKey","generateRandomBytes32","generateDeepLink","tweetnacl_util_1","sha256_1","deeplink_1","BASE16","hexString","Uint8Array","byteArray","byte","buffer1","buffer2","mergedArray","array","subArray1","subArray2","encodeUint8Array","urlSafe","encodeBase64","encodeURIComponent","decodeToUint8Array","decodeURIComponent","decodeBase64","uint8Array","decodeUTF8","decodedUint8Array","encodeUTF8","toObject","RegExp","scheme","test","global","self","hash","randomBytes32","in_memory_storage_1","isLocalStorageAvailable","utils","OKXTonConnect","ton_connect_1","connectionManager_1","CHAIN","CHAIN_1","CONNECT_EVENT_ERROR_CODES","CONNECT_ITEM_ERROR_CODES","connect_event_1","DISCONNECT_ERROR_CODES","SIGN_DATA_ERROR_CODES","SEND_TRANSACTION_ERROR_CODES","send_transaction_rpc_response_1","sign_data_rpc_response_1","disconnect_rpc_response_1","standardDeeplink","standardUniversalLink","tonConnectSdkVersion","connectErrorsParser","protocol_1","protocol_2","connectEventErrorsCodes","UNKNOWN_ERROR","USER_REJECTS_ERROR","ConnectErrorsParser","parseError","ErrorConstructor","RpcParser","isError","sendTransactionParser","rpc_parser_1","sendTransactionErrors","SendTransactionParser","convertToRpcRequest","parseAndThrowError","convertFromRpcResponse","rpcResponse","boc","BridgeConnectionStorage","storeKey","storeConnection","connection","removeConnection","getConnection","stored","getHttpConnection","storeLastWalletEventId","lastWalletEventId","getLastWalletEventId","BridgeProvider","bridge_connection_1","bridge_connection_storage_1","url_1","version_1","engine_1","type","listeners","connectManager","walletConnectionSource","engine","openUniversalUrl","connectionStorage","fromStorage","bridgeConnectionStorage","isPendingConnectionHttp","provider","connectInfo","connectRequest","protocolVer","Number","dAppInfo","dappInfo","requests","items","connectRequestStr","base64Encoded","deeplinkEncodeUrl","universalLink","fullUrl","connectionSource","connectListener","listen","filter","disconnectMessage","closeConnection","walletMessage","lastId","tonAddrItem","responses","find","tonProfItem","walletInfo","wallet","tonDeviceInfo","platform","appName","appVersion","maxProtocolVersion","features","ton","itemArr","oldStorage","tonConnectInfo","connectEvent","device","successMessage","errorMessage","restoreConnection","storedConnection","openOKXWallet","called","onRequestSent","sendRequest","__rest","s","t","indexOf","getOwnPropertySymbols","propertyIsEnumerable","bridge_provider_1","default_storage_1","feature_support_1","ton_connect_tracker_1","send_transaction_parser_1","connect_errors_parser_1","_wallet","statusChangeSubscriptions","statusChangeErrorSubscriptions","metaData","dappSettings","tracker","TonConnectTracker","account","walletEventsListener","trackConnectionStarted","createConnectRequest","onWalletConnected","onWalletConnectError","onWalletDisconnected","tonAccountItem","tonProofItem","address","chain","network","walletStateInit","connectItems","tonProof","trackConnectionCompleted","connectEventError","errorsHandler","trackConnectionError","scope","trackDisconnection","onStatusChange","trackConnectionRestoringStarted","trackConnectionRestoringError","trackConnectionRestoringCompleted","sendTransaction","transaction","checkConnection","checkSendTransactionSupport","requiredMessagesNumber","messages","trackTransactionSentForSignature","validUntil","tx","TESTNET","valid_until","trackTransactionSigningFailed","trackTransactionSigned","BrowserEventDispatcher","dispatchEvent","eventName","eventDetails","CustomEvent","detail","types_1","browser_event_dispatcher_1","version","createVersionInfo","ton_connect_sdk_lib","eventPrefix","eventDispatcher","init","catch","setRequestVersionHandler","createResponseVersionEvent","dispatchUserActionEvent","createConnectionStartedEvent","createConnectionCompletedEvent","createConnectionErrorEvent","createConnectionRestoringStartedEvent","createConnectionRestoringCompletedEvent","createConnectionRestoringErrorEvent","createDisconnectionEvent","createTransactionSentForSignatureEvent","createTransactionSignedEvent","createTransactionSigningFailedEvent","OKX_TON_TRANSACTION_SIGNING_FAILED","OKX_TON_TRANSACTION_SIGNED","OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE","OKX_TON_DISCONNECTION","OKX_TON_CONNECTION_RESTORING_ERROR","OKX_TON_CONNECTION_RESTORING_COMPLETED","OKX_TON_CONNECTION_RESTORING_STARTED","OKX_TON_CONNECTION_ERROR","OKX_TON_CONNECTION_COMPLETED","OKX_TON_CONNECTION_STARTED","createRequestVersionEvent","createConnectionInfo","_d","_e","_f","_g","_h","isTonProof","authType","wallet_address","wallet_type","wallet_version","auth_type","custom_data","chain_id","is_success","error_message","errorCode","error_code","createTransactionInfo","String","map","amount","signedTransaction","signed_transaction","supportsDeprecatedSendTransactionFeature","includes","sendTransactionFeature","feature","maxMessages","_createElementVNode","class","_createElementBlock","_hoisted_1","_createVNode","_component_el_container","_withCtx","_component_el_header","_createTextVNode","_component_el_main","_component_el_card","_hoisted_2","_component_el_row","_component_el_col","span","_hoisted_3","_toDisplayString","$options","getWalletAddress","_hoisted_4","_ctx","_hoisted_5","gutter","_component_el_input","modelValue","testProofPayload","_cache","$event","placeholder","_hoisted_6","ProofPayloadVerify","_component_el_button","onClick","connectBtnClicked","icon","connectStatusStr","_createBlock","_Teleport","to","showModal","closeModal","_withModifiers","_hoisted_7","_component_qrcode_vue","qrValue","size","level","_createCommentVNode","resotreConnectAction","disconnectAction","disabled","walletAddress","disconnectStatusStr","_hoisted_8","xs","sm","_hoisted_9","testTransaction","_hoisted_10","testboc","testTransactionStr","_hoisted_11","_hoisted_12","localPubKey","_hoisted_13","localSecKey","clearCacheKeyPair","TON","testCM","async","verifyTonProof","public_key","domain","parsedAddress","Address","signatureBuffer","signVerify","proof","isValid","components","QrcodeVue","testTopic","testPublicKey","pendingDeepLink","logList","connectReady","computed","updateUniLink","iconUrl","methods","testTonSdk","sendData","transactionRequest","connectData","isPC","isSafariOrChrome","userAgentInfo","navigator","userAgent","Agents","flag","created","mounted","pubkey","__exports__","render","app","createApp","App","use","ElementPlus","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","deferred","O","chunkIds","priority","notFulfilled","Infinity","j","every","splice","r","n","getter","d","a","definition","g","globalThis","Function","obj","prop","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}